<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>inside-observability-with-.net-10 – Dario's Learning Journey</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-3a5c9839406ebf6b9042eb0df0f87657.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Learning Hub</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-events" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Events</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-events">    
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/Readme.html">
 <span class="dropdown-text">Build 2025: Conference Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK101 Dotnet app modernization/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK101 - .NET App Modernization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK103 Microsoft Developers Use AI/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK103 - Microsoft Developers Use AI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK104 Building the Next Generation of Apps with AI and .NET/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK104 - Next Gen Apps with AI &amp; .NET</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK106 Elevating Development with .NET Aspire AI/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK106 - .NET Aspire AI &amp; Cloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK114 C# 14 Language Features and Beyond/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK114 - What’s New in C# 14</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK119 Debug Like a Pro - Improve Your Efficiency/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK119 - Debug Like a Pro with Visual Studio &amp; Copilot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK122 Supercharge Your Git workflow with VS Code/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK122 - ASP.NET Core &amp; Blazor Future</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK123 Build AI Apps with Microsoft Graph Data/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK123 - Build AI Apps with Microsoft Graph</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK127 Unleash developer potential with AI and Dev Box/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK127 - Unleash Developer Potential with AI and Dev Box</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK141 RAG for enterprise agents with Azure AI Search/SUMMARY.html">
 <span class="dropdown-text">Build 2025: BRK141 - RAG for Enterprise Agents with Azure AI Search</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK155 Azure AI Foundry - app and Agent Factory/SUMMARY.html">
 <span class="dropdown-text">Build 2025: BRK155 - Azure AI Foundry: The AI App and Agent Factory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK163 Create agents for 365 Copilot with 365 Agents SDK/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK163 - Create Agents with M365 Agents SDK</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK165 Building agents for Microsoft 365 Copilot/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK165 - Building Agents for Microsoft 365 Copilot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK176 agent solutions with Copilot Studio and M365 Agents SDK/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK176 - Multi-Agent Solutions with Copilot Studio and SDK</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK195 Inside Azure innovations with Mark Russinovich/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK195 - Inside Azure Innovations with Mark Russinovich</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK199 Accelerate Modernization/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK199 - Accelerate Modernization at Scale</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK204 Whats new in Microsoft Databases/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK204 - What’s New in Microsoft Databases</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK223 An overview of Windows AI Foundry/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK223 - Windows AI Foundry Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK224 Integrate AI using Windows AI APIs/SUMMARY.html">
 <span class="dropdown-text">Build 2025: BRK224 - Integrate AI using Windows AI APIs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK225 Bring your own model to Windows using Windows ML/SUMMARY.html">
 <span class="dropdown-text">Build 2025: BRK225 - Bring Your Own Model to Windows using Windows ML</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK226 Boost Development Productivity/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK226 - Windows Developer Tools</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK229 Unlock agents for your apps using MCP on Windows/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: BRK229 - Unlock Agentic Interactions with MCP on Windows</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/BRK229 Introducing Copilot Solutions/SUMMARY.html">
 <span class="dropdown-text">Build 2025: BRK229 - Introducing Copilot Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM508 Streamlining Application Testing with .NET Aspire and Playwright/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: DEM508 - .NET Aspire and Playwright Testing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM509 Essential AI Prompts for Developers/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: DEM509 - Essential AI Prompts for Developers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM515 Write better C# code/README.GPT5.html">
 <span class="dropdown-text">Build 2025: DEM515 - Write Better C# Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM517 Build, Deploy, &amp; Use Your First MCP Server/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: DEM517 - Model Context Protocol</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM518 dotnet run app/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: DEM518 - Direct C# File Execution</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM519 Agent mode for serious developers/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: DEM519 - Agent Mode for Serious Developers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM520 Local AI Development with Foundry Local and .NET Aspire/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: DEM520 - Local AI Development</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM524 Running Large Language Models on your local machine/SUMMARY.html">
 <span class="dropdown-text">Build 2025: DEM524 - Running Large Language Models Locally</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM571 Extending your application with powertoys/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: DEM571 - PowerToys Command Palette Extensions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/DEM581 Transforming Microsoft Learn with AI/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: DEM581 - Transforming Microsoft Learn with AI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/ODFP957 Sentry and Copilot Integration for AI Debugging/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: ODFP957 - Sentry &amp; Copilot AI Debugging</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../202506 Build 2025/STUDIO14 Agents AI and Azure AI Foundry/README.Sonnet4.html">
 <span class="dropdown-text">Build 2025: STUDIO14 - Agents &amp; Azure AI Foundry</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-culture--travel" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Culture &amp; Travel</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-culture--travel">    
        <li>
    <a class="dropdown-item" href="../../Travel/Paris 2025/README.html">
 <span class="dropdown-text">Paris Cultural Journey 2025</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/darioairoldi/Learn"> <i class="bi bi-github" role="img" aria-label="GitHub Repository">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-house-fill" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true"><i class="bi bi-calendar-event" role="img">
</i> 
 <span class="menu-text">Events</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../202506 Build 2025/Readme.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Build Conference 2025</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/Readme.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conference Overview</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK101: AI-Powered .NET Modernization</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK101 Dotnet app modernization/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK101 Dotnet app modernization/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK103: Microsoft Developers Use AI</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK103 Microsoft Developers Use AI/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK103 Microsoft Developers Use AI/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK104: Building Next Gen Apps with AI &amp; .NET</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK104 Building the Next Generation of Apps with AI and .NET/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK104 Building the Next Generation of Apps with AI and .NET/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK106: .NET Aspire AI &amp; Cloud</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK106 Elevating Development with .NET Aspire AI/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK114: What’s New in C# 14</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK114 C# 14 Language Features and Beyond/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK114 C# 14 Language Features and Beyond/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK119: Debug Like a Pro</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK119 Debug Like a Pro - Improve Your Efficiency/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK119 Debug Like a Pro - Improve Your Efficiency/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK122: ASP.NET Core &amp; Blazor Future</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK122 Supercharge Your Git workflow with VS Code/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK123: Build AI Apps with Microsoft Graph</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK123 Build AI Apps with Microsoft Graph Data/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK123 Build AI Apps with Microsoft Graph Data/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK127: AI and Dev Box Developer Potential</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK127 Unleash developer potential with AI and Dev Box/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK127 Unleash developer potential with AI and Dev Box/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK141: RAG for Enterprise Agents</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK141 RAG for enterprise agents with Azure AI Search/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK155: Azure AI Foundry - App &amp; Agent Factory</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK155 Azure AI Foundry - app and Agent Factory/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK163: M365 Agents SDK Custom Engine Development</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK163 Create agents for 365 Copilot with 365 Agents SDK/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK163 Create agents for 365 Copilot with 365 Agents SDK/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK165: Building Agents for Microsoft 365 Copilot</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK165 Building agents for Microsoft 365 Copilot/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK165 Building agents for Microsoft 365 Copilot/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK176: Multi-Agent Solutions with Copilot Studio</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK176 agent solutions with Copilot Studio and M365 Agents SDK/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK176 agent solutions with Copilot Studio and M365 Agents SDK/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK195: Inside Azure Innovations</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK195 Inside Azure innovations with Mark Russinovich/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK195 Inside Azure innovations with Mark Russinovich/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK199: Accelerate Modernization</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK199 Accelerate Modernization/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK199 Accelerate Modernization/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK204: Microsoft Databases</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK204 Whats new in Microsoft Databases/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK204 Whats new in Microsoft Databases/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK223: Windows AI Foundry</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK223 An overview of Windows AI Foundry/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK223 An overview of Windows AI Foundry/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK224: Integrate AI using Windows AI APIs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-21" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK224 Integrate AI using Windows AI APIs/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK225: Windows ML - Bring Your Own Model</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-22" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK225 Bring your own model to Windows using Windows ML/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK226: Windows Developer Tools</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-23" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK226 Boost Development Productivity/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK226 Boost Development Productivity/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK229: MCP on Windows for Agentic Apps</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-24" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK229 Unlock agents for your apps using MCP on Windows/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK229 Unlock agents for your apps using MCP on Windows/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false">
 <span class="menu-text">BRK229: Introducing Copilot Solutions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-25" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/BRK229 Introducing Copilot Solutions/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM508: .NET Aspire Testing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-26" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM508 Streamlining Application Testing with .NET Aspire and Playwright/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM509: Essential AI Prompts</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-27" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM509 Essential AI Prompts for Developers/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM509 Essential AI Prompts for Developers/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-28" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM515: Write Better C#</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-28" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-28" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM515 Write better C# code/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM515 Write better C# code/README.GPT5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-29" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM517: MCP Server</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-29" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-29" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM517 Build, Deploy, &amp; Use Your First MCP Server/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-30" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM518: Direct C# File Execution</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-30" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-30" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM518 dotnet run app/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM518 dotnet run app/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-31" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM519: Agent Mode for Serious Developers</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-31" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-31" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM519 Agent mode for serious developers/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM519 Agent mode for serious developers/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-32" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM520: Local AI Development</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-32" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-32" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM520 Local AI Development with Foundry Local and .NET Aspire/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-33" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM524: Running LLMs Locally</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-33" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-33" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM524 Running Large Language Models on your local machine/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-34" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM571: PowerToys Extensions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-34" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-34" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM571 Extending your application with powertoys/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM571 Extending your application with powertoys/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-35" role="navigation" aria-expanded="false">
 <span class="menu-text">DEM581: Transforming Microsoft Learn with AI</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-35" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-35" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM581 Transforming Microsoft Learn with AI/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/DEM581 Transforming Microsoft Learn with AI/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-36" role="navigation" aria-expanded="false">
 <span class="menu-text">ODFP957: Sentry &amp; Copilot AI Debugging</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-36" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-36" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/ODFP957 Sentry and Copilot Integration for AI Debugging/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/ODFP957 Sentry and Copilot Integration for AI Debugging/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-37" role="navigation" aria-expanded="false">
 <span class="menu-text">STUDIO14: Agents &amp; Azure AI Foundry</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-37" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-37" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/STUDIO14 Agents AI and Azure AI Foundry/SUMMARY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../202506 Build 2025/STUDIO14 Agents AI and Azure AI Foundry/README.Sonnet4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session Details</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-38" role="navigation" aria-expanded="true"><i class="bi bi-tools" role="img">
</i> 
 <span class="menu-text">Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-38" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-38" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../20250709 Manage GitRepo from commandline/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Development Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-39" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-39" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250709 Manage GitRepo from commandline/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git Command Line</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250711 Use http files for easy and repeatable test/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTTP Files Testing</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../20250712 Use QUARTO doc for Github repos doc/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto Documentation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-40" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-40" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250712 Use QUARTO doc for Github repos doc/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250712 Use QUARTO doc for Github repos doc/001.01. Quarto.yml document structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto.yml document structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250712 Use QUARTO doc for Github repos doc/003.01. Quarto specific markdown features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto specific markdown features</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250712 Use QUARTO doc for Github repos doc/002.03. Quarto Theming and Styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto Theming and Styling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250712 Use QUARTO doc for Github repos doc/009.00 How does sidebar works.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How does sidebar works</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250713 Use http files for easy and repeatable test/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTTP Files (Extended)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-41" role="navigation" aria-expanded="true"><i class="bi bi-wrench-adjustable" role="img">
</i> 
 <span class="menu-text">Issues &amp; Solutions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-41" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-41" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../_ISSUES/20250709 fatal error cloning a repo with Visual Studio/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Development Issues</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-42" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-42" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../_ISSUES/20250709 fatal error cloning a repo with Visual Studio/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">VS Clone Error Fix (solved)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-43" role="navigation" aria-expanded="true"><i class="bi bi-lightning-charge" role="img">
</i> 
 <span class="menu-text">Other Technologies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-43" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-43" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../20250815 DIY Battery Pack/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DIY Li-Ion Battery Packs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-44" role="navigation" aria-expanded="true"><i class="bi bi-geo-alt" role="img">
</i> 
 <span class="menu-text">Culture &amp; Travel</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-44" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-44" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Travel/Paris 2025/README.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Paris Cultural Journey 2025</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On This Page</h2>
   
  <ul>
  <li><a href="#inside-observability-with-.net-10" id="toc-inside-observability-with-.net-10" class="nav-link active" data-scroll-target="#inside-observability-with-.net-10">Inside Observability with .NET 10</a>
  <ul class="collapse">
  <li><a href="#table-of-contents" id="toc-table-of-contents" class="nav-link" data-scroll-target="#table-of-contents">Table of Contents</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#observability-fundamentals" id="toc-observability-fundamentals" class="nav-link" data-scroll-target="#observability-fundamentals">Observability Fundamentals</a>
  <ul class="collapse">
  <li><a href="#the-three-pillars-of-observability" id="toc-the-three-pillars-of-observability" class="nav-link" data-scroll-target="#the-three-pillars-of-observability">The Three Pillars of Observability</a></li>
  <li><a href="#modern-observability-requirements" id="toc-modern-observability-requirements" class="nav-link" data-scroll-target="#modern-observability-requirements">Modern Observability Requirements</a></li>
  </ul></li>
  <li><a href="#net-10-runtime-observability-enhancements" id="toc-net-10-runtime-observability-enhancements" class="nav-link" data-scroll-target="#net-10-runtime-observability-enhancements">.NET 10 Runtime Observability Enhancements</a>
  <ul class="collapse">
  <li><a href="#native-instrumentation" id="toc-native-instrumentation" class="nav-link" data-scroll-target="#native-instrumentation">Native Instrumentation</a></li>
  <li><a href="#enhanced-metrics-collection" id="toc-enhanced-metrics-collection" class="nav-link" data-scroll-target="#enhanced-metrics-collection">Enhanced Metrics Collection</a></li>
  <li><a href="#blazor-specific-observability" id="toc-blazor-specific-observability" class="nav-link" data-scroll-target="#blazor-specific-observability">Blazor-Specific Observability</a></li>
  </ul></li>
  <li><a href="#built-in-metrics-and-telemetry" id="toc-built-in-metrics-and-telemetry" class="nav-link" data-scroll-target="#built-in-metrics-and-telemetry">Built-in Metrics and Telemetry</a>
  <ul class="collapse">
  <li><a href="#http-request-metrics" id="toc-http-request-metrics" class="nav-link" data-scroll-target="#http-request-metrics">HTTP Request Metrics</a></li>
  <li><a href="#database-operation-metrics" id="toc-database-operation-metrics" class="nav-link" data-scroll-target="#database-operation-metrics">Database Operation Metrics</a></li>
  <li><a href="#memory-and-gc-metrics" id="toc-memory-and-gc-metrics" class="nav-link" data-scroll-target="#memory-and-gc-metrics">Memory and GC Metrics</a></li>
  </ul></li>
  <li><a href="#opentelemetry-integration" id="toc-opentelemetry-integration" class="nav-link" data-scroll-target="#opentelemetry-integration">OpenTelemetry Integration</a>
  <ul class="collapse">
  <li><a href="#native-integration-benefits" id="toc-native-integration-benefits" class="nav-link" data-scroll-target="#native-integration-benefits">Native Integration Benefits</a></li>
  <li><a href="#identity-model-logging" id="toc-identity-model-logging" class="nav-link" data-scroll-target="#identity-model-logging">Identity Model Logging</a></li>
  <li><a href="#custom-instrumentation" id="toc-custom-instrumentation" class="nav-link" data-scroll-target="#custom-instrumentation">Custom Instrumentation</a></li>
  </ul></li>
  <li><a href="#net-aspire-observability-stack" id="toc-net-aspire-observability-stack" class="nav-link" data-scroll-target="#net-aspire-observability-stack">.NET Aspire Observability Stack</a>
  <ul class="collapse">
  <li><a href="#integrated-dashboard" id="toc-integrated-dashboard" class="nav-link" data-scroll-target="#integrated-dashboard">Integrated Dashboard</a></li>
  <li><a href="#service-discovery-and-health-checks" id="toc-service-discovery-and-health-checks" class="nav-link" data-scroll-target="#service-discovery-and-health-checks">Service Discovery and Health Checks</a></li>
  <li><a href="#resource-monitoring" id="toc-resource-monitoring" class="nav-link" data-scroll-target="#resource-monitoring">Resource Monitoring</a></li>
  <li><a href="#service-to-service-communication" id="toc-service-to-service-communication" class="nav-link" data-scroll-target="#service-to-service-communication">Service-to-Service Communication</a></li>
  </ul></li>
  <li><a href="#monitoring-and-diagnostic-tools" id="toc-monitoring-and-diagnostic-tools" class="nav-link" data-scroll-target="#monitoring-and-diagnostic-tools">Monitoring and Diagnostic Tools</a>
  <ul class="collapse">
  <li><a href="#visual-studio-integration" id="toc-visual-studio-integration" class="nav-link" data-scroll-target="#visual-studio-integration">Visual Studio Integration</a></li>
  <li><a href="#browser-devtools-integration" id="toc-browser-devtools-integration" class="nav-link" data-scroll-target="#browser-devtools-integration">Browser DevTools Integration</a></li>
  <li><a href="#production-monitoring" id="toc-production-monitoring" class="nav-link" data-scroll-target="#production-monitoring">Production Monitoring</a></li>
  </ul></li>
  <li><a href="#performance-profiling-and-analysis" id="toc-performance-profiling-and-analysis" class="nav-link" data-scroll-target="#performance-profiling-and-analysis">Performance Profiling and Analysis</a>
  <ul class="collapse">
  <li><a href="#cpu-profiling" id="toc-cpu-profiling" class="nav-link" data-scroll-target="#cpu-profiling">CPU Profiling</a></li>
  <li><a href="#memory-analysis" id="toc-memory-analysis" class="nav-link" data-scroll-target="#memory-analysis">Memory Analysis</a></li>
  <li><a href="#performance-benchmarking" id="toc-performance-benchmarking" class="nav-link" data-scroll-target="#performance-benchmarking">Performance Benchmarking</a></li>
  </ul></li>
  <li><a href="#distributed-tracing" id="toc-distributed-tracing" class="nav-link" data-scroll-target="#distributed-tracing">Distributed Tracing</a>
  <ul class="collapse">
  <li><a href="#cross-service-tracing" id="toc-cross-service-tracing" class="nav-link" data-scroll-target="#cross-service-tracing">Cross-Service Tracing</a></li>
  <li><a href="#trace-sampling" id="toc-trace-sampling" class="nav-link" data-scroll-target="#trace-sampling">Trace Sampling</a></li>
  <li><a href="#trace-analysis" id="toc-trace-analysis" class="nav-link" data-scroll-target="#trace-analysis">Trace Analysis</a></li>
  </ul></li>
  <li><a href="#best-practices-and-implementation-patterns" id="toc-best-practices-and-implementation-patterns" class="nav-link" data-scroll-target="#best-practices-and-implementation-patterns">Best Practices and Implementation Patterns</a>
  <ul class="collapse">
  <li><a href="#observability-first-development" id="toc-observability-first-development" class="nav-link" data-scroll-target="#observability-first-development">Observability-First Development</a></li>
  <li><a href="#metric-design-patterns" id="toc-metric-design-patterns" class="nav-link" data-scroll-target="#metric-design-patterns">Metric Design Patterns</a></li>
  <li><a href="#alerting-and-slosli-definition" id="toc-alerting-and-slosli-definition" class="nav-link" data-scroll-target="#alerting-and-slosli-definition">Alerting and SLO/SLI Definition</a></li>
  </ul></li>
  <li><a href="#real-world-scenarios" id="toc-real-world-scenarios" class="nav-link" data-scroll-target="#real-world-scenarios">Real-World Scenarios</a>
  <ul class="collapse">
  <li><a href="#e-commerce-application-observability" id="toc-e-commerce-application-observability" class="nav-link" data-scroll-target="#e-commerce-application-observability">E-Commerce Application Observability</a></li>
  <li><a href="#microservices-communication-monitoring" id="toc-microservices-communication-monitoring" class="nav-link" data-scroll-target="#microservices-communication-monitoring">Microservices Communication Monitoring</a></li>
  </ul></li>
  <li><a href="#troubleshooting-and-debugging" id="toc-troubleshooting-and-debugging" class="nav-link" data-scroll-target="#troubleshooting-and-debugging">Troubleshooting and Debugging</a>
  <ul class="collapse">
  <li><a href="#common-observability-issues" id="toc-common-observability-issues" class="nav-link" data-scroll-target="#common-observability-issues">Common Observability Issues</a></li>
  <li><a href="#performance-optimization" id="toc-performance-optimization" class="nav-link" data-scroll-target="#performance-optimization">Performance Optimization</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/darioairoldi/Learn/edit/main/202506 Build 2025/BRK122 Supercharge Your Git workflow with VS Code/02. Inside Observability with .net 10.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/darioairoldi/Learn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><h1 class="title display-7"></h1></header><div class="quarto-title-block"><div class="quarto-title-tools-only"><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>




<section id="inside-observability-with-.net-10" class="level1">
<h1>Inside Observability with .NET 10</h1>
<section id="table-of-contents" class="level2">
<h2 class="anchored" data-anchor-id="table-of-contents">Table of Contents</h2>
<ol type="1">
<li><a href="#overview">Overview</a></li>
<li><a href="#observability-fundamentals">Observability Fundamentals</a></li>
<li><a href="#net-10-runtime-observability-enhancements">.NET 10 Runtime Observability Enhancements</a></li>
<li><a href="#built-in-metrics-and-telemetry">Built-in Metrics and Telemetry</a></li>
<li><a href="#opentelemetry-integration">OpenTelemetry Integration</a></li>
<li><a href="#net-aspire-observability-stack">.NET Aspire Observability Stack</a></li>
<li><a href="#monitoring-and-diagnostic-tools">Monitoring and Diagnostic Tools</a></li>
<li><a href="#performance-profiling-and-analysis">Performance Profiling and Analysis</a></li>
<li><a href="#distributed-tracing">Distributed Tracing</a></li>
<li><a href="#best-practices-and-implementation-patterns">Best Practices and Implementation Patterns</a></li>
<li><a href="#real-world-scenarios">Real-World Scenarios</a></li>
<li><a href="#troubleshooting-and-debugging">Troubleshooting and Debugging</a></li>
</ol>
</section>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>Observability in .NET 10 represents a fundamental shift toward comprehensive application monitoring, diagnostics, and performance analysis. The new runtime introduces native instrumentation capabilities, enhanced metrics collection, and seamless integration with modern observability platforms.</p>
<p>This document provides an in-depth exploration of observability features in .NET 10, covering both runtime-level enhancements and the powerful observability stack provided by .NET Aspire.</p>
</section>
<section id="observability-fundamentals" class="level2">
<h2 class="anchored" data-anchor-id="observability-fundamentals">Observability Fundamentals</h2>
<section id="the-three-pillars-of-observability" class="level3">
<h3 class="anchored" data-anchor-id="the-three-pillars-of-observability">The Three Pillars of Observability</h3>
<section id="metrics" class="level4">
<h4 class="anchored" data-anchor-id="metrics">1. Metrics</h4>
<p><strong>Quantitative measurements</strong> that provide insights into system performance and behavior: - <strong>Counter metrics</strong>: Request counts, error counts, operation counts - <strong>Gauge metrics</strong>: Memory usage, CPU utilization, active connections - <strong>Histogram metrics</strong>: Request duration, response size distribution - <strong>Summary metrics</strong>: Percentile calculations, aggregated statistics</p>
</section>
<section id="logs" class="level4">
<h4 class="anchored" data-anchor-id="logs">2. Logs</h4>
<p><strong>Structured events</strong> that capture detailed information about application execution: - <strong>Structured logging</strong>: JSON-formatted logs with consistent schemas - <strong>Contextual information</strong>: Request IDs, user IDs, operation context - <strong>Log levels</strong>: Debug, Information, Warning, Error, Critical - <strong>Correlation</strong>: Cross-service log correlation and tracing</p>
</section>
<section id="traces" class="level4">
<h4 class="anchored" data-anchor-id="traces">3. Traces</h4>
<p><strong>Distributed execution paths</strong> that show request flow across services: - <strong>Spans</strong>: Individual operations within a trace - <strong>Trace context</strong>: Propagation across service boundaries - <strong>Baggage</strong>: Key-value pairs carried across spans - <strong>Sampling</strong>: Intelligent trace collection strategies</p>
</section>
</section>
<section id="modern-observability-requirements" class="level3">
<h3 class="anchored" data-anchor-id="modern-observability-requirements">Modern Observability Requirements</h3>
<section id="cloud-native-applications" class="level4">
<h4 class="anchored" data-anchor-id="cloud-native-applications">Cloud-Native Applications</h4>
<ul>
<li><strong>Microservices architecture</strong>: Multiple services requiring coordinated monitoring</li>
<li><strong>Container orchestration</strong>: Kubernetes and container-specific metrics</li>
<li><strong>Auto-scaling</strong>: Dynamic resource allocation monitoring</li>
<li><strong>Service mesh</strong>: Network-level observability and security metrics</li>
</ul>
</section>
<section id="performance-engineering" class="level4">
<h4 class="anchored" data-anchor-id="performance-engineering">Performance Engineering</h4>
<ul>
<li><strong>Real-time monitoring</strong>: Live performance dashboards and alerting</li>
<li><strong>Capacity planning</strong>: Resource utilization trends and forecasting</li>
<li><strong>Bottleneck identification</strong>: Performance hotspot detection</li>
<li><strong>User experience</strong>: End-user performance monitoring</li>
</ul>
</section>
</section>
</section>
<section id="net-10-runtime-observability-enhancements" class="level2">
<h2 class="anchored" data-anchor-id="net-10-runtime-observability-enhancements">.NET 10 Runtime Observability Enhancements</h2>
<section id="native-instrumentation" class="level3">
<h3 class="anchored" data-anchor-id="native-instrumentation">Native Instrumentation</h3>
<section id="built-in-semantic-conventions" class="level4">
<h4 class="anchored" data-anchor-id="built-in-semantic-conventions">Built-in Semantic Conventions</h4>
<p>.NET 10 introduces <strong>native OpenTelemetry semantic conventions</strong> without requiring additional packages:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatic instrumentation for HTTP requests</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ApiController <span class="op">:</span> ControllerBase</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="fu">HttpGet</span><span class="op">(</span><span class="st">"/api/products"</span><span class="op">)]</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>IActionResult<span class="op">&gt;</span> <span class="fu">GetProducts</span><span class="op">()</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Automatically generates:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// - http.method = "GET"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// - http.url = "/api/products"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// - http.status_code = 200</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// - http.response_time_ms = execution_duration</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="fu">Ok</span><span class="op">(</span>await productService<span class="op">.</span><span class="fu">GetProductsAsync</span><span class="op">());</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="activity-and-span-enhancement" class="level4">
<h4 class="anchored" data-anchor-id="activity-and-span-enhancement">Activity and Span Enhancement</h4>
<p><strong>Improved Activity API</strong> with richer context and better performance:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> System<span class="op">.</span><span class="fu">Diagnostics</span><span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> OrderProcessingService</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"OrderProcessing"</span><span class="op">,</span> <span class="st">"1.0.0"</span><span class="op">);</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>Order<span class="op">&gt;</span> <span class="fu">ProcessOrderAsync</span><span class="op">(</span>CreateOrderRequest request<span class="op">)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessOrder"</span><span class="op">);</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Automatic context propagation</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.customer_id"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">CustomerId</span><span class="op">);</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.item_count"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">Items</span><span class="op">.</span><span class="fu">Count</span><span class="op">);</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> order <span class="op">=</span> await <span class="fu">CreateOrderAsync</span><span class="op">(</span>request<span class="op">);</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.id"</span><span class="op">,</span> order<span class="op">.</span><span class="fu">Id</span><span class="op">);</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Ok</span><span class="op">);</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> order<span class="op">;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="enhanced-metrics-collection" class="level3">
<h3 class="anchored" data-anchor-id="enhanced-metrics-collection">Enhanced Metrics Collection</h3>
<section id="kestrel-memory-pool-metrics" class="level4">
<h4 class="anchored" data-anchor-id="kestrel-memory-pool-metrics">Kestrel Memory Pool Metrics</h4>
<p><strong>Real-time memory tracking</strong> for web server optimization:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatic metrics collection</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MemoryPoolMetrics</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Collected automatically by .NET 10 runtime</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> MemoryPoolAllocations <span class="op">=</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"kestrel.memory_pool.allocations"</span><span class="op">);</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;</span> MemoryPoolUsage <span class="op">=</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="st">"kestrel.memory_pool.bytes_used"</span><span class="op">);</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> MemoryPoolReleaseLatency <span class="op">=</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"kestrel.memory_pool.release_latency_ms"</span><span class="op">);</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="authentication-and-authorization-metrics" class="level4">
<h4 class="anchored" data-anchor-id="authentication-and-authorization-metrics">Authentication and Authorization Metrics</h4>
<p><strong>Security operation monitoring</strong> with detailed insights:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> AuthMetrics</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Login attempt tracking</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> LoginAttempts <span class="op">=</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"auth.login.attempts"</span><span class="op">);</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Authentication success/failure rates</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> AuthenticationResults <span class="op">=</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"auth.authentication.results"</span><span class="op">);</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Token validation performance</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> TokenValidationDuration <span class="op">=</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"auth.token.validation_duration_ms"</span><span class="op">);</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Passkey authentication metrics</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> PasskeyOperations <span class="op">=</span> </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"auth.passkey.operations"</span><span class="op">);</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="blazor-specific-observability" class="level3">
<h3 class="anchored" data-anchor-id="blazor-specific-observability">Blazor-Specific Observability</h3>
<section id="circuit-monitoring" class="level4">
<h4 class="anchored" data-anchor-id="circuit-monitoring">Circuit Monitoring</h4>
<p><strong>Real-time Blazor Server circuit tracking</strong>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> BlazorMetrics</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Active circuit count</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ActiveCircuits <span class="op">=</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"blazor.circuits.active"</span><span class="op">);</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Circuit connection state</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> CircuitStateChanges <span class="op">=</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"blazor.circuits.state_changes"</span><span class="op">);</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Interactive rendering performance</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> RenderingDuration <span class="op">=</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"blazor.rendering.duration_ms"</span><span class="op">);</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SignalR connection metrics</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> SignalRConnections <span class="op">=</span> </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"blazor.signalr.connections"</span><span class="op">);</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="webassembly-diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="webassembly-diagnostics">WebAssembly Diagnostics</h4>
<p><strong>Browser-based performance profiling</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Browser DevTools integration</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> BlazorWasmDiagnostics</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">EnableBrowserProfiling</span><span class="op">()</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Automatic CPU sampling</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        DiagnosticSource<span class="op">.</span><span class="fu">StartCpuSampling</span><span class="op">();</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Memory allocation tracking</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        GC<span class="op">.</span><span class="fu">StartConcurrentGCTracking</span><span class="op">();</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Performance counter collection</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        PerformanceCounters<span class="op">.</span><span class="fu">EnableCollection</span><span class="op">();</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> async Task<span class="op">&lt;</span>DiagnosticData<span class="op">&gt;</span> <span class="fu">ExtractDiagnosticsAsync</span><span class="op">()</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> DiagnosticData</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>            CpuProfile <span class="op">=</span> await DiagnosticSource<span class="op">.</span><span class="fu">GetCpuProfileAsync</span><span class="op">(),</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>            MemoryDump <span class="op">=</span> await GC<span class="op">.</span><span class="fu">GetMemoryDumpAsync</span><span class="op">(),</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>            PerformanceCounters <span class="op">=</span> PerformanceCounters<span class="op">.</span><span class="fu">GetSnapshot</span><span class="op">()</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="built-in-metrics-and-telemetry" class="level2">
<h2 class="anchored" data-anchor-id="built-in-metrics-and-telemetry">Built-in Metrics and Telemetry</h2>
<section id="http-request-metrics" class="level3">
<h3 class="anchored" data-anchor-id="http-request-metrics">HTTP Request Metrics</h3>
<section id="automatic-collection" class="level4">
<h4 class="anchored" data-anchor-id="automatic-collection">Automatic Collection</h4>
<p>.NET 10 automatically collects comprehensive HTTP metrics:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatically generated metrics for each HTTP request</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> HttpMetrics</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Request count by method and status code</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.requests{method="GET", status_code="200"}</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Request duration histogram</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.request.duration{method="GET", route="/api/products"}</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Request body size</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.request.body.size{method="POST", route="/api/orders"}</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Response body size</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.response.body.size{method="GET", route="/api/products"}</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Active requests gauge</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.active_requests{method="GET"}</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="custom-http-metrics" class="level4">
<h4 class="anchored" data-anchor-id="custom-http-metrics">Custom HTTP Metrics</h4>
<p><strong>Extending built-in metrics</strong> with application-specific data:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> CustomHttpMetrics</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ApiCallsByClient <span class="op">=</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"api.calls.by_client"</span><span class="op">);</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> BusinessOperationDuration <span class="op">=</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"business.operation.duration_ms"</span><span class="op">);</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">RecordApiCall</span><span class="op">(</span><span class="dt">string</span> clientId<span class="op">,</span> <span class="dt">string</span> operation<span class="op">,</span> <span class="dt">double</span> duration<span class="op">)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        ApiCallsByClient<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"client_id"</span><span class="op">,</span> clientId<span class="op">));</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        BusinessOperationDuration<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>duration<span class="op">,</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"operation"</span><span class="op">,</span> operation<span class="op">));</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="database-operation-metrics" class="level3">
<h3 class="anchored" data-anchor-id="database-operation-metrics">Database Operation Metrics</h3>
<section id="entity-framework-core-integration" class="level4">
<h4 class="anchored" data-anchor-id="entity-framework-core-integration">Entity Framework Core Integration</h4>
<p><strong>Automatic database performance monitoring</strong>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> DatabaseMetrics</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Query execution time</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> QueryDuration <span class="op">=</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"ef.query.duration_ms"</span><span class="op">);</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Connection pool metrics</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ConnectionPoolSize <span class="op">=</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"ef.connection_pool.size"</span><span class="op">);</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Failed query attempts</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> QueryErrors <span class="op">=</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"ef.query.errors"</span><span class="op">);</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Usage in DbContext</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ApplicationDbContext <span class="op">:</span> DbContext</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="kw">override</span> <span class="dt">void</span> <span class="fu">OnConfiguring</span><span class="op">(</span>DbContextOptionsBuilder optionsBuilder<span class="op">)</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        optionsBuilder<span class="op">.</span><span class="fu">EnableDetailedErrors</span><span class="op">()</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>                     <span class="op">.</span><span class="fu">EnableSensitiveDataLogging</span><span class="op">(</span>isDevelopment<span class="op">)</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                     <span class="op">.</span><span class="fu">AddInterceptors</span><span class="op">(</span><span class="kw">new</span> <span class="fu">MetricsInterceptor</span><span class="op">());</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="memory-and-gc-metrics" class="level3">
<h3 class="anchored" data-anchor-id="memory-and-gc-metrics">Memory and GC Metrics</h3>
<section id="garbage-collection-monitoring" class="level4">
<h4 class="anchored" data-anchor-id="garbage-collection-monitoring">Garbage Collection Monitoring</h4>
<p><strong>Real-time memory management insights</strong>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MemoryMetrics</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// GC collection count by generation</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> GCCollections <span class="op">=</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"gc.collections"</span><span class="op">);</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Memory allocated per generation</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;</span> GenerationSize <span class="op">=</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="st">"gc.generation.size_bytes"</span><span class="op">);</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Time spent in GC</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> GCTime <span class="op">=</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"gc.time_ms"</span><span class="op">);</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Large object heap size</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;</span> LohSize <span class="op">=</span> </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="st">"gc.loh.size_bytes"</span><span class="op">);</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="opentelemetry-integration" class="level2">
<h2 class="anchored" data-anchor-id="opentelemetry-integration">OpenTelemetry Integration</h2>
<section id="native-integration-benefits" class="level3">
<h3 class="anchored" data-anchor-id="native-integration-benefits">Native Integration Benefits</h3>
<section id="zero-configuration-setup" class="level4">
<h4 class="anchored" data-anchor-id="zero-configuration-setup">Zero-Configuration Setup</h4>
<p>.NET 10 provides <strong>built-in OpenTelemetry integration</strong> without external packages:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Program</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">Main</span><span class="op">(</span><span class="dt">string</span><span class="op">[]</span> args<span class="op">)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> builder <span class="op">=</span> WebApplication<span class="op">.</span><span class="fu">CreateBuilder</span><span class="op">(</span>args<span class="op">);</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Native OpenTelemetry - no additional packages needed</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        builder<span class="op">.</span><span class="fu">Services</span><span class="op">.</span><span class="fu">AddOpenTelemetry</span><span class="op">()</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">WithMetrics</span><span class="op">(</span>metrics <span class="op">=&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                metrics<span class="op">.</span><span class="fu">AddAspNetCoreInstrumentation</span><span class="op">()</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                       <span class="op">.</span><span class="fu">AddHttpClientInstrumentation</span><span class="op">()</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                       <span class="op">.</span><span class="fu">AddEntityFrameworkCoreInstrumentation</span><span class="op">();</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">})</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">WithTracing</span><span class="op">(</span>tracing <span class="op">=&gt;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                tracing<span class="op">.</span><span class="fu">AddAspNetCoreInstrumentation</span><span class="op">()</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                       <span class="op">.</span><span class="fu">AddHttpClientInstrumentation</span><span class="op">()</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                       <span class="op">.</span><span class="fu">AddEntityFrameworkCoreInstrumentation</span><span class="op">();</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>            <span class="op">});</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> app <span class="op">=</span> builder<span class="op">.</span><span class="fu">Build</span><span class="op">();</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        app<span class="op">.</span><span class="fu">Run</span><span class="op">();</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="semantic-conventions" class="level4">
<h4 class="anchored" data-anchor-id="semantic-conventions">Semantic Conventions</h4>
<p><strong>Standardized telemetry attributes</strong> following OpenTelemetry specifications:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatic semantic conventions for HTTP operations</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> SemanticConventions</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// HTTP attributes</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> HttpMethod <span class="op">=</span> <span class="st">"http.method"</span><span class="op">;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> HttpStatusCode <span class="op">=</span> <span class="st">"http.status_code"</span><span class="op">;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> HttpUrl <span class="op">=</span> <span class="st">"http.url"</span><span class="op">;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> HttpUserAgent <span class="op">=</span> <span class="st">"http.user_agent"</span><span class="op">;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Database attributes</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> DbSystem <span class="op">=</span> <span class="st">"db.system"</span><span class="op">;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> DbStatement <span class="op">=</span> <span class="st">"db.statement"</span><span class="op">;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> DbOperation <span class="op">=</span> <span class="st">"db.operation.name"</span><span class="op">;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Service attributes</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> ServiceName <span class="op">=</span> <span class="st">"service.name"</span><span class="op">;</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> ServiceVersion <span class="op">=</span> <span class="st">"service.version"</span><span class="op">;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> ServiceNamespace <span class="op">=</span> <span class="st">"service.namespace"</span><span class="op">;</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="identity-model-logging" class="level3">
<h3 class="anchored" data-anchor-id="identity-model-logging">Identity Model Logging</h3>
<section id="jwt-token-validation-visibility" class="level4">
<h4 class="anchored" data-anchor-id="jwt-token-validation-visibility">JWT Token Validation Visibility</h4>
<p><strong>Enhanced authentication flow monitoring</strong>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> IdentityObservability</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"Microsoft.AspNetCore.Authentication"</span><span class="op">);</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>AuthenticateResult<span class="op">&gt;</span> <span class="fu">ValidateTokenAsync</span><span class="op">(</span><span class="dt">string</span> token<span class="op">)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ValidateJwtToken"</span><span class="op">);</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.token.type"</span><span class="op">,</span> <span class="st">"JWT"</span><span class="op">);</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.scheme"</span><span class="op">,</span> <span class="st">"Bearer"</span><span class="op">);</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> result <span class="op">=</span> await <span class="fu">ValidateTokenInternalAsync</span><span class="op">(</span>token<span class="op">);</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.result"</span><span class="op">,</span> result<span class="op">.</span><span class="fu">Succeeded</span> <span class="op">?</span> <span class="st">"success"</span> <span class="op">:</span> <span class="st">"failure"</span><span class="op">);</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.principal.name"</span><span class="op">,</span> result<span class="op">.</span><span class="fu">Principal</span><span class="op">?.</span><span class="fu">Identity</span><span class="op">?.</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="op">(!</span>result<span class="op">.</span><span class="fu">Succeeded</span><span class="op">)</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.failure.reason"</span><span class="op">,</span> result<span class="op">.</span><span class="fu">Failure</span><span class="op">?.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> result<span class="op">;</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="custom-instrumentation" class="level3">
<h3 class="anchored" data-anchor-id="custom-instrumentation">Custom Instrumentation</h3>
<section id="business-logic-tracing" class="level4">
<h4 class="anchored" data-anchor-id="business-logic-tracing">Business Logic Tracing</h4>
<p><strong>Application-specific observability</strong>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> OrderService</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"ECommerce.OrderService"</span><span class="op">,</span> <span class="st">"1.0.0"</span><span class="op">);</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> OrdersProcessed <span class="op">=</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"orders.processed"</span><span class="op">);</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> OrderProcessingTime <span class="op">=</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"orders.processing.duration_ms"</span><span class="op">);</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>ProcessOrderResult<span class="op">&gt;</span> <span class="fu">ProcessOrderAsync</span><span class="op">(</span>Order order<span class="op">)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessOrder"</span><span class="op">);</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> stopwatch <span class="op">=</span> Stopwatch<span class="op">.</span><span class="fu">StartNew</span><span class="op">();</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.id"</span><span class="op">,</span> order<span class="op">.</span><span class="fu">Id</span><span class="op">);</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.customer_id"</span><span class="op">,</span> order<span class="op">.</span><span class="fu">CustomerId</span><span class="op">);</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.total_amount"</span><span class="op">,</span> order<span class="op">.</span><span class="fu">TotalAmount</span><span class="op">);</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Validate inventory</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> inventoryActivity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ValidateInventory"</span><span class="op">);</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">ValidateInventoryAsync</span><span class="op">(</span>order<span class="op">.</span><span class="fu">Items</span><span class="op">);</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Process payment</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> paymentActivity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessPayment"</span><span class="op">);</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> paymentResult <span class="op">=</span> await <span class="fu">ProcessPaymentAsync</span><span class="op">(</span>order<span class="op">);</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Update inventory</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> updateActivity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"UpdateInventory"</span><span class="op">);</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">UpdateInventoryAsync</span><span class="op">(</span>order<span class="op">.</span><span class="fu">Items</span><span class="op">);</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>            OrdersProcessed<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"success"</span><span class="op">));</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>            OrderProcessingTime<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Ok</span><span class="op">);</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> ProcessOrderResult<span class="op">.</span><span class="fu">Success</span><span class="op">(</span>order<span class="op">.</span><span class="fu">Id</span><span class="op">);</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>            OrdersProcessed<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"error"</span><span class="op">));</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>            OrderProcessingTime<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"error.type"</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">GetType</span><span class="op">().</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="net-aspire-observability-stack" class="level2">
<h2 class="anchored" data-anchor-id="net-aspire-observability-stack">.NET Aspire Observability Stack</h2>
<section id="integrated-dashboard" class="level3">
<h3 class="anchored" data-anchor-id="integrated-dashboard">Integrated Dashboard</h3>
<section id="comprehensive-application-view" class="level4">
<h4 class="anchored" data-anchor-id="comprehensive-application-view">Comprehensive Application View</h4>
<p><strong>.NET Aspire provides a unified observability dashboard</strong> that combines:</p>
<ul>
<li><strong>Service topology</strong>: Visual representation of service dependencies</li>
<li><strong>Real-time metrics</strong>: Live performance indicators and health status</li>
<li><strong>Distributed traces</strong>: End-to-end request flow visualization</li>
<li><strong>Log aggregation</strong>: Centralized log viewing with correlation</li>
<li><strong>Resource monitoring</strong>: Container, database, and external service health</li>
</ul>
</section>
<section id="dashboard-configuration" class="level4">
<h4 class="anchored" data-anchor-id="dashboard-configuration">Dashboard Configuration</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Program</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">Main</span><span class="op">(</span><span class="dt">string</span><span class="op">[]</span> args<span class="op">)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> builder <span class="op">=</span> DistributedApplication<span class="op">.</span><span class="fu">CreateBuilder</span><span class="op">(</span>args<span class="op">);</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Add services with automatic observability</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> apiService <span class="op">=</span> builder<span class="op">.</span><span class="fu">AddProject</span><span class="op">&lt;</span>Projects<span class="op">.</span><span class="fu">ApiService</span><span class="op">&gt;(</span><span class="st">"apiservice"</span><span class="op">)</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                               <span class="op">.</span><span class="fu">WithHttpEndpoint</span><span class="op">(</span>port<span class="op">:</span> <span class="dv">5001</span><span class="op">);</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> webApp <span class="op">=</span> builder<span class="op">.</span><span class="fu">AddProject</span><span class="op">&lt;</span>Projects<span class="op">.</span><span class="fu">WebApp</span><span class="op">&gt;(</span><span class="st">"webapp"</span><span class="op">)</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                           <span class="op">.</span><span class="fu">WithHttpEndpoint</span><span class="op">(</span>port<span class="op">:</span> <span class="dv">5000</span><span class="op">)</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                           <span class="op">.</span><span class="fu">WithReference</span><span class="op">(</span>apiService<span class="op">);</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Add databases with monitoring</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> postgres <span class="op">=</span> builder<span class="op">.</span><span class="fu">AddPostgreSQL</span><span class="op">(</span><span class="st">"postgres"</span><span class="op">)</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                             <span class="op">.</span><span class="fu">WithDataVolume</span><span class="op">()</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                             <span class="op">.</span><span class="fu">AddDatabase</span><span class="op">(</span><span class="st">"ecommerce"</span><span class="op">);</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> redis <span class="op">=</span> builder<span class="op">.</span><span class="fu">AddRedis</span><span class="op">(</span><span class="st">"redis"</span><span class="op">)</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                          <span class="op">.</span><span class="fu">WithDataVolume</span><span class="op">();</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Services automatically get observability</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        apiService<span class="op">.</span><span class="fu">WithReference</span><span class="op">(</span>postgres<span class="op">)</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                  <span class="op">.</span><span class="fu">WithReference</span><span class="op">(</span>redis<span class="op">);</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        builder<span class="op">.</span><span class="fu">Build</span><span class="op">().</span><span class="fu">Run</span><span class="op">();</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="service-discovery-and-health-checks" class="level3">
<h3 class="anchored" data-anchor-id="service-discovery-and-health-checks">Service Discovery and Health Checks</h3>
<section id="automatic-health-monitoring" class="level4">
<h4 class="anchored" data-anchor-id="automatic-health-monitoring">Automatic Health Monitoring</h4>
<p><strong>Built-in health checks</strong> for all Aspire-managed services:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> HealthCheckConfiguration</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ConfigureHealthChecks</span><span class="op">(</span>IServiceCollection services<span class="op">,</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                           IConfiguration configuration<span class="op">)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        services<span class="op">.</span><span class="fu">AddHealthChecks</span><span class="op">()</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                <span class="co">// Automatic database health checks</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddNpgSql</span><span class="op">(</span>configuration<span class="op">.</span><span class="fu">GetConnectionString</span><span class="op">(</span><span class="st">"postgres"</span><span class="op">))</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddRedis</span><span class="op">(</span>configuration<span class="op">.</span><span class="fu">GetConnectionString</span><span class="op">(</span><span class="st">"redis"</span><span class="op">))</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                <span class="co">// HTTP endpoint health checks</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddUrlGroup</span><span class="op">(</span><span class="kw">new</span> <span class="fu">Uri</span><span class="op">(</span><span class="st">"https://api.example.com/health"</span><span class="op">),</span> <span class="st">"external-api"</span><span class="op">)</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                <span class="co">// Custom business logic health checks</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddCheck</span><span class="op">&lt;</span>OrderProcessingHealthCheck<span class="op">&gt;(</span><span class="st">"order-processing"</span><span class="op">)</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddCheck</span><span class="op">&lt;</span>PaymentServiceHealthCheck<span class="op">&gt;(</span><span class="st">"payment-service"</span><span class="op">);</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> OrderProcessingHealthCheck <span class="op">:</span> IHealthCheck</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>HealthCheckResult<span class="op">&gt;</span> <span class="fu">CheckHealthAsync</span><span class="op">(</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        HealthCheckContext context<span class="op">,</span> </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        CancellationToken cancellationToken <span class="op">=</span> <span class="kw">default</span><span class="op">)</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Check order processing queue</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> queueDepth <span class="op">=</span> await <span class="fu">GetOrderQueueDepthAsync</span><span class="op">();</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="op">(</span>queueDepth <span class="op">&gt;</span> <span class="dv">1000</span><span class="op">)</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>                <span class="kw">return</span> HealthCheckResult<span class="op">.</span><span class="fu">Degraded</span><span class="op">(</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>                    $<span class="st">"Order queue depth is high: {queueDepth}"</span><span class="op">);</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> HealthCheckResult<span class="op">.</span><span class="fu">Healthy</span><span class="op">(</span>$<span class="st">"Queue depth: {queueDepth}"</span><span class="op">);</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> HealthCheckResult<span class="op">.</span><span class="fu">Unhealthy</span><span class="op">(</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Order processing health check failed"</span><span class="op">,</span> ex<span class="op">);</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="resource-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="resource-monitoring">Resource Monitoring</h3>
<section id="container-and-infrastructure-metrics" class="level4">
<h4 class="anchored" data-anchor-id="container-and-infrastructure-metrics">Container and Infrastructure Metrics</h4>
<p><strong>Automatic infrastructure monitoring</strong> for Aspire-managed resources:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> AspireResourceMetrics</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Container metrics</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> ContainerCpuUsage <span class="op">=</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"container.cpu.usage_percent"</span><span class="op">);</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;</span> ContainerMemoryUsage <span class="op">=</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="st">"container.memory.usage_bytes"</span><span class="op">);</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Database connection metrics</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> DatabaseConnections <span class="op">=</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"database.connections.active"</span><span class="op">);</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Redis cache metrics</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> CacheOperations <span class="op">=</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"cache.operations"</span><span class="op">);</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> CacheLatency <span class="op">=</span> </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"cache.operation.duration_ms"</span><span class="op">);</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="service-to-service-communication" class="level3">
<h3 class="anchored" data-anchor-id="service-to-service-communication">Service-to-Service Communication</h3>
<section id="automatic-trace-propagation" class="level4">
<h4 class="anchored" data-anchor-id="automatic-trace-propagation">Automatic Trace Propagation</h4>
<p><strong>Seamless distributed tracing</strong> across Aspire services:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ApiService</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">readonly</span> HttpClient httpClient<span class="op">;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">readonly</span> ILogger<span class="op">&lt;</span>ApiService<span class="op">&gt;</span> logger<span class="op">;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="fu">ApiService</span><span class="op">(</span>HttpClient httpClient<span class="op">,</span> ILogger<span class="op">&lt;</span>ApiService<span class="op">&gt;</span> logger<span class="op">)</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">httpClient</span> <span class="op">=</span> httpClient<span class="op">;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">logger</span> <span class="op">=</span> logger<span class="op">;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>ProductData<span class="op">&gt;</span> <span class="fu">GetProductAsync</span><span class="op">(</span><span class="dt">int</span> productId<span class="op">)</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Trace context automatically propagated</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"GetProduct"</span><span class="op">);</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"product.id"</span><span class="op">,</span> productId<span class="op">);</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// HTTP calls automatically traced</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> response <span class="op">=</span> await httpClient<span class="op">.</span><span class="fu">GetAsync</span><span class="op">(</span>$<span class="st">"/products/{productId}"</span><span class="op">);</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>response<span class="op">.</span><span class="fu">IsSuccessStatusCode</span><span class="op">)</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> product <span class="op">=</span> await response<span class="op">.</span><span class="fu">Content</span><span class="op">.</span><span class="fu">ReadFromJsonAsync</span><span class="op">&lt;</span>ProductData<span class="op">&gt;();</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Log with automatic correlation</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogInformation</span><span class="op">(</span><span class="st">"Retrieved product {ProductId}: {ProductName}"</span><span class="op">,</span> </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                                productId<span class="op">,</span> product<span class="op">.</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> product<span class="op">;</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">ProductNotFoundException</span><span class="op">(</span>productId<span class="op">);</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="monitoring-and-diagnostic-tools" class="level2">
<h2 class="anchored" data-anchor-id="monitoring-and-diagnostic-tools">Monitoring and Diagnostic Tools</h2>
<section id="visual-studio-integration" class="level3">
<h3 class="anchored" data-anchor-id="visual-studio-integration">Visual Studio Integration</h3>
<section id="live-diagnostic-tools" class="level4">
<h4 class="anchored" data-anchor-id="live-diagnostic-tools">Live Diagnostic Tools</h4>
<p><strong>Real-time performance monitoring</strong> during development:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> DiagnosticToolsIntegration</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// CPU usage profiling</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="fu">Conditional</span><span class="op">(</span><span class="st">"DEBUG"</span><span class="op">)]</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">StartCpuProfiling</span><span class="op">()</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>Debugger<span class="op">.</span><span class="fu">IsAttached</span><span class="op">)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            DiagnosticTools<span class="op">.</span><span class="fu">StartCpuSampling</span><span class="op">();</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Memory allocation tracking</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="fu">Conditional</span><span class="op">(</span><span class="st">"DEBUG"</span><span class="op">)]</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">TrackMemoryAllocations</span><span class="op">()</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>Debugger<span class="op">.</span><span class="fu">IsAttached</span><span class="op">)</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>            DiagnosticTools<span class="op">.</span><span class="fu">EnableMemoryTracking</span><span class="op">();</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Custom event logging</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">LogPerformanceEvent</span><span class="op">(</span><span class="dt">string</span> eventName<span class="op">,</span> </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>                                         Dictionary<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;</span> properties<span class="op">)</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> DiagnosticSource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span>eventName<span class="op">,</span> properties<span class="op">);</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Event automatically appears in diagnostic tools</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        DiagnosticTools<span class="op">.</span><span class="fu">WriteEvent</span><span class="op">(</span>eventName<span class="op">,</span> properties<span class="op">);</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="browser-devtools-integration" class="level3">
<h3 class="anchored" data-anchor-id="browser-devtools-integration">Browser DevTools Integration</h3>
<section id="blazor-webassembly-profiling" class="level4">
<h4 class="anchored" data-anchor-id="blazor-webassembly-profiling">Blazor WebAssembly Profiling</h4>
<p><strong>Native browser debugging</strong> capabilities:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatic browser integration</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">blazorDiagnostics</span> <span class="op">=</span> {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Start performance profiling</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">startProfiling</span><span class="op">:</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">console</span><span class="op">.</span><span class="fu">profile</span>(<span class="st">'Blazor App Performance'</span>)<span class="op">;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">performance</span><span class="op">.</span><span class="fu">mark</span>(<span class="st">'profiling-start'</span>)<span class="op">;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Stop profiling and extract data</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stopProfiling</span><span class="op">:</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">performance</span><span class="op">.</span><span class="fu">mark</span>(<span class="st">'profiling-end'</span>)<span class="op">;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">performance</span><span class="op">.</span><span class="fu">measure</span>(<span class="st">'total-execution'</span><span class="op">,</span> <span class="st">'profiling-start'</span><span class="op">,</span> <span class="st">'profiling-end'</span>)<span class="op">;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">console</span><span class="op">.</span><span class="fu">profileEnd</span>(<span class="st">'Blazor App Performance'</span>)<span class="op">;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>            <span class="dt">performanceEntries</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="fu">getEntriesByType</span>(<span class="st">'measure'</span>)<span class="op">,</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>            <span class="dt">memoryUsage</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="at">memory</span><span class="op">,</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>            <span class="dt">navigationTiming</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="fu">getEntriesByType</span>(<span class="st">'navigation'</span>)[<span class="dv">0</span>]</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract memory dump</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">extractMemoryDump</span><span class="op">:</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="st">'memory'</span> <span class="kw">in</span> <span class="bu">performance</span>) {</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>                <span class="dt">usedJSMemory</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="at">memory</span><span class="op">.</span><span class="at">usedJSMemory</span><span class="op">,</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>                <span class="dt">totalJSMemory</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="at">memory</span><span class="op">.</span><span class="at">totalJSMemory</span><span class="op">,</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                <span class="dt">jsMemoryLimit</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="at">memory</span><span class="op">.</span><span class="at">jsMemoryLimit</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>            }<span class="op">;</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="production-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="production-monitoring">Production Monitoring</h3>
<section id="application-performance-monitoring-apm" class="level4">
<h4 class="anchored" data-anchor-id="application-performance-monitoring-apm">Application Performance Monitoring (APM)</h4>
<p><strong>Integration with popular APM solutions</strong>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ApmIntegration</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ConfigureApm</span><span class="op">(</span>IServiceCollection services<span class="op">,</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                   IConfiguration configuration<span class="op">)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Application Insights integration</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        services<span class="op">.</span><span class="fu">AddApplicationInsightsTelemetry</span><span class="op">(</span>configuration<span class="op">);</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Datadog integration</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        services<span class="op">.</span><span class="fu">AddDatadogTracing</span><span class="op">(</span>configuration<span class="op">);</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Custom APM provider</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        services<span class="op">.</span><span class="fu">AddOpenTelemetry</span><span class="op">()</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">WithTracing</span><span class="op">(</span>tracing <span class="op">=&gt;</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                    tracing<span class="op">.</span><span class="fu">AddOtlpExporter</span><span class="op">(</span>options <span class="op">=&gt;</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>                    <span class="op">{</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                        options<span class="op">.</span><span class="fu">Endpoint</span> <span class="op">=</span> configuration<span class="op">[</span><span class="st">"Apm:Endpoint"</span><span class="op">];</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>                        options<span class="op">.</span><span class="fu">Headers</span> <span class="op">=</span> $<span class="st">"api-key={configuration["</span>Apm<span class="op">:</span>ApiKey<span class="st">"]}"</span><span class="op">;</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                    <span class="op">});</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>                <span class="op">});</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="performance-profiling-and-analysis" class="level2">
<h2 class="anchored" data-anchor-id="performance-profiling-and-analysis">Performance Profiling and Analysis</h2>
<section id="cpu-profiling" class="level3">
<h3 class="anchored" data-anchor-id="cpu-profiling">CPU Profiling</h3>
<section id="automatic-sampling" class="level4">
<h4 class="anchored" data-anchor-id="automatic-sampling">Automatic Sampling</h4>
<p><strong>.NET 10 provides built-in CPU profiling</strong> capabilities:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> CpuProfiler</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"Performance.Profiling"</span><span class="op">);</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> async Task<span class="op">&lt;</span>T<span class="op">&gt;</span> ProfileAsync<span class="op">&lt;</span>T<span class="op">&gt;(</span><span class="dt">string</span> operationName<span class="op">,</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                                               Func<span class="op">&lt;</span>Task<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> operation<span class="op">)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span>$<span class="st">"Profile.{operationName}"</span><span class="op">);</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> stopwatch <span class="op">=</span> Stopwatch<span class="op">.</span><span class="fu">StartNew</span><span class="op">();</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Start CPU sampling</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> cpuSampler <span class="op">=</span> CpuSampler<span class="op">.</span><span class="fu">Start</span><span class="op">();</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> result <span class="op">=</span> await <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> cpuData <span class="op">=</span> cpuSampler<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"duration_ms"</span><span class="op">,</span> stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"cpu_time_ms"</span><span class="op">,</span> cpuData<span class="op">.</span><span class="fu">CpuTimeMilliseconds</span><span class="op">);</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"samples_collected"</span><span class="op">,</span> cpuData<span class="op">.</span><span class="fu">SampleCount</span><span class="op">);</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> result<span class="op">;</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="memory-analysis" class="level3">
<h3 class="anchored" data-anchor-id="memory-analysis">Memory Analysis</h3>
<section id="allocation-tracking" class="level4">
<h4 class="anchored" data-anchor-id="allocation-tracking">Allocation Tracking</h4>
<p><strong>Detailed memory allocation monitoring</strong>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MemoryProfiler</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> MemoryAnalysisResult <span class="fu">AnalyzeMemoryUsage</span><span class="op">(</span>Action operation<span class="op">)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Record initial state</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> initialMemory <span class="op">=</span> GC<span class="op">.</span><span class="fu">GetTotalMemory</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> initialGen0 <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> initialGen1 <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> initialGen2 <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Enable allocation tracking</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> tracker <span class="op">=</span> AllocationTracker<span class="op">.</span><span class="fu">Start</span><span class="op">();</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Execute operation</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Force garbage collection</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        GC<span class="op">.</span><span class="fu">Collect</span><span class="op">();</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        GC<span class="op">.</span><span class="fu">WaitForPendingFinalizers</span><span class="op">();</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        GC<span class="op">.</span><span class="fu">Collect</span><span class="op">();</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Calculate metrics</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> finalMemory <span class="op">=</span> GC<span class="op">.</span><span class="fu">GetTotalMemory</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> allocations <span class="op">=</span> tracker<span class="op">.</span><span class="fu">GetAllocations</span><span class="op">();</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> MemoryAnalysisResult</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>            TotalAllocatedBytes <span class="op">=</span> allocations<span class="op">.</span><span class="fu">TotalBytes</span><span class="op">,</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>            AllocationCount <span class="op">=</span> allocations<span class="op">.</span><span class="fu">Count</span><span class="op">,</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>            MemoryDelta <span class="op">=</span> finalMemory <span class="op">-</span> initialMemory<span class="op">,</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>            Gen0Collections <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">-</span> initialGen0<span class="op">,</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>            Gen1Collections <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">-</span> initialGen1<span class="op">,</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>            Gen2Collections <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">2</span><span class="op">)</span> <span class="op">-</span> initialGen2<span class="op">,</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            AllocationsBy Type <span class="op">=</span> allocations<span class="op">.</span><span class="fu">GroupBy</span><span class="op">(</span>a <span class="op">=&gt;</span> a<span class="op">.</span><span class="fu">Type</span><span class="op">)</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>                                           <span class="op">.</span><span class="fu">ToDictionary</span><span class="op">(</span>g <span class="op">=&gt;</span> g<span class="op">.</span><span class="fu">Key</span><span class="op">,</span> g <span class="op">=&gt;</span> g<span class="op">.</span><span class="fu">Sum</span><span class="op">(</span>a <span class="op">=&gt;</span> a<span class="op">.</span><span class="fu">Size</span><span class="op">))</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="performance-benchmarking" class="level3">
<h3 class="anchored" data-anchor-id="performance-benchmarking">Performance Benchmarking</h3>
<section id="built-in-benchmarking-tools" class="level4">
<h4 class="anchored" data-anchor-id="built-in-benchmarking-tools">Built-in Benchmarking Tools</h4>
<p><strong>Integrated performance measurement</strong>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> PerformanceBenchmark</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> OperationDuration <span class="op">=</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"benchmark.operation.duration_ms"</span><span class="op">);</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> async Task<span class="op">&lt;</span>BenchmarkResult<span class="op">&gt;</span> BenchmarkAsync<span class="op">&lt;</span>T<span class="op">&gt;(</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">string</span> operationName<span class="op">,</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        Func<span class="op">&lt;</span>Task<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> operation<span class="op">,</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> iterations <span class="op">=</span> <span class="dv">100</span><span class="op">)</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> results <span class="op">=</span> <span class="kw">new</span> List<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;();</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> stopwatch <span class="op">=</span> <span class="kw">new</span> <span class="fu">Stopwatch</span><span class="op">();</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Warmup</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Actual benchmark</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> iterations<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Restart</span><span class="op">();</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> duration <span class="op">=</span> stopwatch<span class="op">.</span><span class="fu">Elapsed</span><span class="op">.</span><span class="fu">TotalMilliseconds</span><span class="op">;</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>            results<span class="op">.</span><span class="fu">Add</span><span class="op">(</span>duration<span class="op">);</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>            OperationDuration<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>duration<span class="op">,</span> </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">));</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> BenchmarkResult</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>            OperationName <span class="op">=</span> operationName<span class="op">,</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>            Iterations <span class="op">=</span> iterations<span class="op">,</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>            MinDuration <span class="op">=</span> results<span class="op">.</span><span class="fu">Min</span><span class="op">(),</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>            MaxDuration <span class="op">=</span> results<span class="op">.</span><span class="fu">Max</span><span class="op">(),</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>            AverageDuration <span class="op">=</span> results<span class="op">.</span><span class="fu">Average</span><span class="op">(),</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>            MedianDuration <span class="op">=</span> results<span class="op">.</span><span class="fu">OrderBy</span><span class="op">(</span>x <span class="op">=&gt;</span> x<span class="op">).</span><span class="fu">Skip</span><span class="op">(</span>results<span class="op">.</span><span class="fu">Count</span> <span class="op">/</span> <span class="dv">2</span><span class="op">).</span><span class="fu">First</span><span class="op">(),</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>            P95Duration <span class="op">=</span> results<span class="op">.</span><span class="fu">OrderBy</span><span class="op">(</span>x <span class="op">=&gt;</span> x<span class="op">).</span><span class="fu">Skip</span><span class="op">((</span><span class="dt">int</span><span class="op">)(</span>results<span class="op">.</span><span class="fu">Count</span> <span class="op">*</span> <span class="fl">0.95</span><span class="op">)).</span><span class="fu">First</span><span class="op">(),</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>            P99Duration <span class="op">=</span> results<span class="op">.</span><span class="fu">OrderBy</span><span class="op">(</span>x <span class="op">=&gt;</span> x<span class="op">).</span><span class="fu">Skip</span><span class="op">((</span><span class="dt">int</span><span class="op">)(</span>results<span class="op">.</span><span class="fu">Count</span> <span class="op">*</span> <span class="fl">0.99</span><span class="op">)).</span><span class="fu">First</span><span class="op">()</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="distributed-tracing" class="level2">
<h2 class="anchored" data-anchor-id="distributed-tracing">Distributed Tracing</h2>
<section id="cross-service-tracing" class="level3">
<h3 class="anchored" data-anchor-id="cross-service-tracing">Cross-Service Tracing</h3>
<section id="automatic-context-propagation" class="level4">
<h4 class="anchored" data-anchor-id="automatic-context-propagation">Automatic Context Propagation</h4>
<p><strong>Seamless trace context flow</strong> across service boundaries:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> DistributedTracingExample</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Service A - Initiates the request</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">class</span> OrderController <span class="op">:</span> ControllerBase</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span> <span class="kw">readonly</span> IOrderService orderService<span class="op">;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="fu">HttpPost</span><span class="op">(</span><span class="st">"/orders"</span><span class="op">)]</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> async Task<span class="op">&lt;</span>IActionResult<span class="op">&gt;</span> <span class="fu">CreateOrder</span><span class="op">([</span>FromBody<span class="op">]</span> CreateOrderRequest request<span class="op">)</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"CreateOrder"</span><span class="op">);</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.customer_id"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">CustomerId</span><span class="op">);</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> order <span class="op">=</span> await orderService<span class="op">.</span><span class="fu">ProcessOrderAsync</span><span class="op">(</span>request<span class="op">);</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="fu">Ok</span><span class="op">(</span>order<span class="op">);</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Service B - Processes inventory</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">class</span> InventoryService</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span> <span class="kw">readonly</span> HttpClient httpClient<span class="op">;</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> async Task<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;</span> <span class="fu">CheckInventoryAsync</span><span class="op">(</span>List<span class="op">&lt;</span>OrderItem<span class="op">&gt;</span> items<span class="op">)</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"CheckInventory"</span><span class="op">);</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"inventory.item_count"</span><span class="op">,</span> items<span class="op">.</span><span class="fu">Count</span><span class="op">);</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">foreach</span> <span class="op">(</span><span class="dt">var</span> item <span class="kw">in</span> items<span class="op">)</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>                <span class="kw">using</span> <span class="dt">var</span> itemActivity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"CheckItem"</span><span class="op">);</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>                itemActivity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.sku"</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Sku</span><span class="op">);</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>                itemActivity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.quantity"</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">);</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>                <span class="co">// HTTP call automatically propagates trace context</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> response <span class="op">=</span> await httpClient<span class="op">.</span><span class="fu">GetAsync</span><span class="op">(</span>$<span class="st">"/inventory/{item.Sku}"</span><span class="op">);</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> availability <span class="op">=</span> await response<span class="op">.</span><span class="fu">Content</span><span class="op">.</span><span class="fu">ReadFromJsonAsync</span><span class="op">&lt;</span>ItemAvailability<span class="op">&gt;();</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> <span class="op">(</span>availability<span class="op">.</span><span class="fu">Available</span> <span class="op">&lt;</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">)</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>                    itemActivity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"inventory.sufficient"</span><span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>                itemActivity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"inventory.sufficient"</span><span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="trace-sampling" class="level3">
<h3 class="anchored" data-anchor-id="trace-sampling">Trace Sampling</h3>
<section id="intelligent-sampling-strategies" class="level4">
<h4 class="anchored" data-anchor-id="intelligent-sampling-strategies">Intelligent Sampling Strategies</h4>
<p><strong>Optimized trace collection</strong> for production environments:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> TraceSamplingConfiguration</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ConfigureSampling</span><span class="op">(</span>TracerProviderBuilder builder<span class="op">)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        builder<span class="op">.</span><span class="fu">SetSampler</span><span class="op">(</span><span class="kw">new</span> <span class="fu">CompositeSampler</span><span class="op">(</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Always sample errors</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> <span class="fu">ErrorSampler</span><span class="op">(),</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Sample high-value operations</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> <span class="fu">OperationBasedSampler</span><span class="op">(</span><span class="kw">new</span> Dictionary<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">double</span><span class="op">&gt;</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span> <span class="st">"ProcessPayment"</span><span class="op">,</span> <span class="fl">1.0</span> <span class="op">},</span>      <span class="co">// 100% sampling</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span> <span class="st">"ProcessOrder"</span><span class="op">,</span> <span class="fl">0.1</span> <span class="op">},</span>        <span class="co">// 10% sampling</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span> <span class="st">"GetProduct"</span><span class="op">,</span> <span class="fl">0.01</span> <span class="op">}</span>          <span class="co">// 1% sampling</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">}),</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Rate-based sampling for remaining operations</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> <span class="fu">RateLimitingSampler</span><span class="op">(</span>maxTracesPerSecond<span class="op">:</span> <span class="dv">100</span><span class="op">)</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">));</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ErrorSampler <span class="op">:</span> Sampler</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">override</span> SamplingResult <span class="fu">ShouldSample</span><span class="op">(</span><span class="kw">in</span> SamplingParameters samplingParameters<span class="op">)</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Always sample traces that contain errors</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>samplingParameters<span class="op">.</span><span class="fu">Tags</span><span class="op">.</span><span class="fu">Any</span><span class="op">(</span>tag <span class="op">=&gt;</span> </span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>            tag<span class="op">.</span><span class="fu">Key</span> <span class="op">==</span> <span class="st">"error"</span> <span class="op">||</span> tag<span class="op">.</span><span class="fu">Key</span> <span class="op">==</span> <span class="st">"exception"</span><span class="op">))</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> SamplingResult<span class="op">.</span><span class="fu">Create</span><span class="op">(</span>SamplingDecision<span class="op">.</span><span class="fu">RecordAndSample</span><span class="op">);</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> SamplingResult<span class="op">.</span><span class="fu">Create</span><span class="op">(</span>SamplingDecision<span class="op">.</span><span class="fu">Drop</span><span class="op">);</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="trace-analysis" class="level3">
<h3 class="anchored" data-anchor-id="trace-analysis">Trace Analysis</h3>
<section id="correlation-and-root-cause-analysis" class="level4">
<h4 class="anchored" data-anchor-id="correlation-and-root-cause-analysis">Correlation and Root Cause Analysis</h4>
<p><strong>Advanced trace analysis</strong> capabilities:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> TraceAnalyzer</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> TraceAnalysisResult <span class="fu">AnalyzeTrace</span><span class="op">(</span>TraceData trace<span class="op">)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> spans <span class="op">=</span> trace<span class="op">.</span><span class="fu">Spans</span><span class="op">.</span><span class="fu">OrderBy</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">StartTime</span><span class="op">).</span><span class="fu">ToList</span><span class="op">();</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> rootSpan <span class="op">=</span> spans<span class="op">.</span><span class="fu">First</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">ParentSpanId</span> <span class="op">==</span> <span class="kw">null</span><span class="op">);</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> TraceAnalysisResult</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>            TraceId <span class="op">=</span> trace<span class="op">.</span><span class="fu">TraceId</span><span class="op">,</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>            TotalDuration <span class="op">=</span> rootSpan<span class="op">.</span><span class="fu">Duration</span><span class="op">,</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>            SpanCount <span class="op">=</span> spans<span class="op">.</span><span class="fu">Count</span><span class="op">,</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>            ServiceCount <span class="op">=</span> spans<span class="op">.</span><span class="fu">Select</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">ServiceName</span><span class="op">).</span><span class="fu">Distinct</span><span class="op">().</span><span class="fu">Count</span><span class="op">(),</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>            ErrorCount <span class="op">=</span> spans<span class="op">.</span><span class="fu">Count</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">Status</span> <span class="op">==</span> SpanStatus<span class="op">.</span><span class="fu">Error</span><span class="op">),</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Critical path analysis</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>            CriticalPath <span class="op">=</span> <span class="fu">CalculateCriticalPath</span><span class="op">(</span>spans<span class="op">),</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Service dependencies</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>            ServiceDependencies <span class="op">=</span> <span class="fu">BuildDependencyGraph</span><span class="op">(</span>spans<span class="op">),</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Performance bottlenecks</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>            Bottlenecks <span class="op">=</span> <span class="fu">IdentifyBottlenecks</span><span class="op">(</span>spans<span class="op">),</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Error propagation</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>            ErrorPropagation <span class="op">=</span> <span class="fu">TraceErrorPropagation</span><span class="op">(</span>spans<span class="op">)</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> List<span class="op">&lt;</span>SpanSummary<span class="op">&gt;</span> <span class="fu">CalculateCriticalPath</span><span class="op">(</span>List<span class="op">&lt;</span>Span<span class="op">&gt;</span> spans<span class="op">)</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Identify the longest path through the trace</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> pathAnalysis <span class="op">=</span> <span class="kw">new</span> Dictionary<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> TimeSpan<span class="op">&gt;();</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> <span class="op">(</span><span class="dt">var</span> span <span class="kw">in</span> spans<span class="op">)</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> pathDuration <span class="op">=</span> span<span class="op">.</span><span class="fu">Duration</span><span class="op">;</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="op">(</span>span<span class="op">.</span><span class="fu">ParentSpanId</span> <span class="op">!=</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> parent <span class="op">=</span> spans<span class="op">.</span><span class="fu">First</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">SpanId</span> <span class="op">==</span> span<span class="op">.</span><span class="fu">ParentSpanId</span><span class="op">);</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>                pathDuration <span class="op">+=</span> pathAnalysis<span class="op">.</span><span class="fu">GetValueOrDefault</span><span class="op">(</span>parent<span class="op">.</span><span class="fu">SpanId</span><span class="op">,</span> TimeSpan<span class="op">.</span><span class="fu">Zero</span><span class="op">);</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>            pathAnalysis<span class="op">[</span>span<span class="op">.</span><span class="fu">SpanId</span><span class="op">]</span> <span class="op">=</span> pathDuration<span class="op">;</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> spans<span class="op">.</span><span class="fu">Where</span><span class="op">(</span>s <span class="op">=&gt;</span> pathAnalysis<span class="op">[</span>s<span class="op">.</span><span class="fu">SpanId</span><span class="op">]</span> <span class="op">==</span> pathAnalysis<span class="op">.</span><span class="fu">Values</span><span class="op">.</span><span class="fu">Max</span><span class="op">())</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>                   <span class="op">.</span><span class="fu">Select</span><span class="op">(</span>s <span class="op">=&gt;</span> <span class="kw">new</span> <span class="fu">SpanSummary</span><span class="op">(</span>s<span class="op">))</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>                   <span class="op">.</span><span class="fu">ToList</span><span class="op">();</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="best-practices-and-implementation-patterns" class="level2">
<h2 class="anchored" data-anchor-id="best-practices-and-implementation-patterns">Best Practices and Implementation Patterns</h2>
<section id="observability-first-development" class="level3">
<h3 class="anchored" data-anchor-id="observability-first-development">Observability-First Development</h3>
<section id="design-principles" class="level4">
<h4 class="anchored" data-anchor-id="design-principles">Design Principles</h4>
<p><strong>Building observability into the development process</strong>:</p>
<ol type="1">
<li><strong>Instrument Early</strong>: Add observability from the beginning of development</li>
<li><strong>Semantic Consistency</strong>: Use standardized naming conventions for metrics and traces</li>
<li><strong>Context Propagation</strong>: Ensure trace context flows through all operations</li>
<li><strong>Error Visibility</strong>: Make failures immediately observable and actionable</li>
<li><strong>Performance Awareness</strong>: Monitor performance characteristics continuously</li>
</ol>
</section>
<section id="implementation-pattern" class="level4">
<h4 class="anchored" data-anchor-id="implementation-pattern">Implementation Pattern</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ObservableService</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"MyApp.Services"</span><span class="op">,</span> <span class="st">"1.0.0"</span><span class="op">);</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> OperationCounter <span class="op">=</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"service.operations"</span><span class="op">);</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> OperationDuration <span class="op">=</span> </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"service.operation.duration_ms"</span><span class="op">);</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">readonly</span> ILogger<span class="op">&lt;</span>ObservableService<span class="op">&gt;</span> logger<span class="op">;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>Result<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> ExecuteAsync<span class="op">&lt;</span>T<span class="op">&gt;(</span><span class="dt">string</span> operationName<span class="op">,</span> </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                                                Func<span class="op">&lt;</span>Task<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> operation<span class="op">)</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span>operationName<span class="op">);</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> stopwatch <span class="op">=</span> Stopwatch<span class="op">.</span><span class="fu">StartNew</span><span class="op">();</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogInformation</span><span class="op">(</span><span class="st">"Starting operation {OperationName}"</span><span class="op">,</span> operationName<span class="op">);</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> result <span class="op">=</span> await <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>            OperationCounter<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span><span class="op">(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">),</span> <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"success"</span><span class="op">));</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>            OperationDuration<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">,</span> <span class="kw">new</span><span class="op">(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">));</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Ok</span><span class="op">);</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogInformation</span><span class="op">(</span><span class="st">"Completed operation {OperationName} in {Duration}ms"</span><span class="op">,</span> </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>                                operationName<span class="op">,</span> stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Result<span class="op">&lt;</span>T<span class="op">&gt;.</span><span class="fu">Success</span><span class="op">(</span>result<span class="op">);</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>            OperationCounter<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span><span class="op">(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">),</span> <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"error"</span><span class="op">));</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>            OperationDuration<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">,</span> <span class="kw">new</span><span class="op">(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">));</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"error.type"</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">GetType</span><span class="op">().</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogError</span><span class="op">(</span>ex<span class="op">,</span> <span class="st">"Operation {OperationName} failed after {Duration}ms"</span><span class="op">,</span> </span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>                          operationName<span class="op">,</span> stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Result<span class="op">&lt;</span>T<span class="op">&gt;.</span><span class="fu">Failure</span><span class="op">(</span>ex<span class="op">);</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="metric-design-patterns" class="level3">
<h3 class="anchored" data-anchor-id="metric-design-patterns">Metric Design Patterns</h3>
<section id="choosing-the-right-metric-type" class="level4">
<h4 class="anchored" data-anchor-id="choosing-the-right-metric-type">Choosing the Right Metric Type</h4>
<p><strong>Guidelines for metric selection</strong>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MetricDesignPatterns</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use COUNTERS for events that only increase</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> RequestsReceived <span class="op">=</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"http.requests.received"</span><span class="op">);</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use GAUGES for values that go up and down</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> ObservableGauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ActiveConnections <span class="op">=</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateObservableGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"http.connections.active"</span><span class="op">,</span> GetActiveConnections<span class="op">);</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use HISTOGRAMS for distributions (latency, size, etc.)</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> RequestDuration <span class="op">=</span> </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"http.request.duration_ms"</span><span class="op">);</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use UP/DOWN COUNTERS for values that can increase or decrease</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> UpDownCounter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> QueueDepth <span class="op">=</span> </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateUpDownCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"processing.queue.depth"</span><span class="op">);</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="dt">int</span> <span class="fu">GetActiveConnections</span><span class="op">()</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Return current active connection count</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> ConnectionManager<span class="op">.</span><span class="fu">GetActiveConnectionCount</span><span class="op">();</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="alerting-and-slosli-definition" class="level3">
<h3 class="anchored" data-anchor-id="alerting-and-slosli-definition">Alerting and SLO/SLI Definition</h3>
<section id="service-level-objectives" class="level4">
<h4 class="anchored" data-anchor-id="service-level-objectives">Service Level Objectives</h4>
<p><strong>Defining measurable reliability targets</strong>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ServiceLevelObjectives</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SLI: Request success rate</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> SuccessfulRequests <span class="op">=</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"sli.requests.successful"</span><span class="op">);</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> FailedRequests <span class="op">=</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"sli.requests.failed"</span><span class="op">);</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SLI: Request latency</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> RequestLatency <span class="op">=</span> </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"sli.request.latency_ms"</span><span class="op">);</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SLO: 99.9% of requests succeed</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">double</span> SuccessRate <span class="op">=&gt;</span> </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        SuccessfulRequests<span class="op">.</span><span class="fu">Value</span> <span class="op">/</span> <span class="op">(</span><span class="dt">double</span><span class="op">)(</span>SuccessfulRequests<span class="op">.</span><span class="fu">Value</span> <span class="op">+</span> FailedRequests<span class="op">.</span><span class="fu">Value</span><span class="op">);</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SLO: 95% of requests complete within 200ms</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">bool</span> LatencySloMet <span class="op">=&gt;</span> </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>        RequestLatency<span class="op">.</span><span class="fu">GetPercentile</span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span> <span class="op">&lt;</span> <span class="dv">200</span><span class="op">;</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Error budget calculation</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">double</span> ErrorBudget <span class="op">=&gt;</span> <span class="fl">1.0</span> <span class="op">-</span> SuccessRate<span class="op">;</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">bool</span> ErrorBudgetExhausted <span class="op">=&gt;</span> ErrorBudget <span class="op">&gt;</span> <span class="fl">0.001</span><span class="op">;</span> <span class="co">// 0.1% error budget</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="real-world-scenarios" class="level2">
<h2 class="anchored" data-anchor-id="real-world-scenarios">Real-World Scenarios</h2>
<section id="e-commerce-application-observability" class="level3">
<h3 class="anchored" data-anchor-id="e-commerce-application-observability">E-Commerce Application Observability</h3>
<section id="complete-observability-implementation" class="level4">
<h4 class="anchored" data-anchor-id="complete-observability-implementation">Complete Observability Implementation</h4>
<p><strong>End-to-end monitoring</strong> for a production e-commerce system:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ECommerceObservability</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Business metrics</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> OrdersPlaced <span class="op">=</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"business.orders.placed"</span><span class="op">);</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">decimal</span><span class="op">&gt;</span> OrderValue <span class="op">=</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">decimal</span><span class="op">&gt;(</span><span class="st">"business.order.value"</span><span class="op">);</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> PaymentAttempts <span class="op">=</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"business.payment.attempts"</span><span class="op">);</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Infrastructure metrics</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> InventoryLevels <span class="op">=</span> </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"inventory.levels"</span><span class="op">);</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> DatabaseQueryTime <span class="op">=</span> </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"database.query.duration_ms"</span><span class="op">);</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// User experience metrics</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> PageLoadTime <span class="op">=</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"frontend.page.load_time_ms"</span><span class="op">);</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> UserSessions <span class="op">=</span> </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"user.sessions.started"</span><span class="op">);</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> OrderProcessingObservability</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"ECommerce.OrderProcessing"</span><span class="op">);</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>OrderResult<span class="op">&gt;</span> <span class="fu">ProcessOrderAsync</span><span class="op">(</span>CreateOrderRequest request<span class="op">)</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessOrder"</span><span class="op">);</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.customer_id"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">CustomerId</span><span class="op">);</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.item_count"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">Items</span><span class="op">.</span><span class="fu">Count</span><span class="op">);</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.total_value"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">TotalAmount</span><span class="op">);</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Validate inventory with detailed tracing</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> inventorySpan <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ValidateInventory"</span><span class="op">);</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>            <span class="kw">foreach</span> <span class="op">(</span><span class="dt">var</span> item <span class="kw">in</span> request<span class="op">.</span><span class="fu">Items</span><span class="op">)</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>                <span class="kw">using</span> <span class="dt">var</span> itemSpan <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ValidateItem"</span><span class="op">);</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>                itemSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.sku"</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Sku</span><span class="op">);</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>                itemSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.requested_quantity"</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">);</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> availability <span class="op">=</span> await <span class="fu">CheckItemAvailabilityAsync</span><span class="op">(</span>item<span class="op">.</span><span class="fu">Sku</span><span class="op">);</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>                itemSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.available_quantity"</span><span class="op">,</span> availability<span class="op">.</span><span class="fu">Quantity</span><span class="op">);</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> <span class="op">(</span>availability<span class="op">.</span><span class="fu">Quantity</span> <span class="op">&lt;</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">)</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">InsufficientInventoryException</span><span class="op">(</span>item<span class="op">.</span><span class="fu">Sku</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">,</span> availability<span class="op">.</span><span class="fu">Quantity</span><span class="op">);</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Process payment with error handling</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> paymentSpan <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessPayment"</span><span class="op">);</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>            paymentSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"payment.amount"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">TotalAmount</span><span class="op">);</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>            paymentSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"payment.method"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">PaymentMethod</span><span class="op">);</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> paymentResult <span class="op">=</span> await <span class="fu">ProcessPaymentAsync</span><span class="op">(</span>request<span class="op">.</span><span class="fu">Payment</span><span class="op">);</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>            paymentSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"payment.transaction_id"</span><span class="op">,</span> paymentResult<span class="op">.</span><span class="fu">TransactionId</span><span class="op">);</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>            paymentSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"payment.status"</span><span class="op">,</span> paymentResult<span class="op">.</span><span class="fu">Status</span><span class="op">);</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Update inventory</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> updateSpan <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"UpdateInventory"</span><span class="op">);</span></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">UpdateInventoryAsync</span><span class="op">(</span>request<span class="op">.</span><span class="fu">Items</span><span class="op">);</span></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>            ECommerceObservability<span class="op">.</span><span class="fu">OrdersPlaced</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> </span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span><span class="op">(</span><span class="st">"customer_segment"</span><span class="op">,</span> <span class="fu">GetCustomerSegment</span><span class="op">(</span>request<span class="op">.</span><span class="fu">CustomerId</span><span class="op">)));</span></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>            ECommerceObservability<span class="op">.</span><span class="fu">OrderValue</span><span class="op">.</span><span class="fu">Record</span><span class="op">((</span><span class="dt">double</span><span class="op">)</span>request<span class="op">.</span><span class="fu">TotalAmount</span><span class="op">);</span></span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Ok</span><span class="op">);</span></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> OrderResult<span class="op">.</span><span class="fu">Success</span><span class="op">(</span>paymentResult<span class="op">.</span><span class="fu">TransactionId</span><span class="op">);</span></span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"error.type"</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">GetType</span><span class="op">().</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Increment error metrics</span></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>            ECommerceObservability<span class="op">.</span><span class="fu">OrdersPlaced</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> </span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"failed"</span><span class="op">),</span> </span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span><span class="op">(</span><span class="st">"error_type"</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">GetType</span><span class="op">().</span><span class="fu">Name</span><span class="op">));</span></span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="microservices-communication-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="microservices-communication-monitoring">Microservices Communication Monitoring</h3>
<section id="service-mesh-observability" class="level4">
<h4 class="anchored" data-anchor-id="service-mesh-observability">Service Mesh Observability</h4>
<p><strong>Complete inter-service monitoring</strong>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MicroservicesCommunication</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">class</span> ServiceMeshMetrics</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Service-to-service communication</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ServiceRequests <span class="op">=</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>            Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"service.requests"</span><span class="op">);</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> ServiceLatency <span class="op">=</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>            Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"service.request.duration_ms"</span><span class="op">);</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Circuit breaker metrics</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> CircuitBreakerState <span class="op">=</span> </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>            Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"circuit_breaker.state"</span><span class="op">);</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Retry metrics</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> RetryAttempts <span class="op">=</span> </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>            Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"service.retry.attempts"</span><span class="op">);</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">class</span> ResilientHttpClient</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span> <span class="kw">readonly</span> HttpClient httpClient<span class="op">;</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span> <span class="kw">readonly</span> CircuitBreakerService circuitBreaker<span class="op">;</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> async Task<span class="op">&lt;</span>T<span class="op">&gt;</span> CallServiceAsync<span class="op">&lt;</span>T<span class="op">&gt;(</span><span class="dt">string</span> serviceName<span class="op">,</span> <span class="dt">string</span> endpoint<span class="op">)</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ServiceCall"</span><span class="op">);</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"service.name"</span><span class="op">,</span> serviceName<span class="op">);</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"service.endpoint"</span><span class="op">,</span> endpoint<span class="op">);</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> stopwatch <span class="op">=</span> Stopwatch<span class="op">.</span><span class="fu">StartNew</span><span class="op">();</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">try</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> response <span class="op">=</span> await circuitBreaker<span class="op">.</span><span class="fu">ExecuteAsync</span><span class="op">(</span><span class="fu">async</span> <span class="op">()</span> <span class="op">=&gt;</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">return</span> await httpClient<span class="op">.</span><span class="fu">GetAsync</span><span class="op">(</span>$<span class="st">"{serviceName}{endpoint}"</span><span class="op">);</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>                <span class="op">});</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>                stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>                ServiceMeshMetrics<span class="op">.</span><span class="fu">ServiceRequests</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> </span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"source_service"</span><span class="op">,</span> <span class="st">"current"</span><span class="op">),</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"target_service"</span><span class="op">,</span> serviceName<span class="op">),</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"success"</span><span class="op">));</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>                ServiceMeshMetrics<span class="op">.</span><span class="fu">ServiceLatency</span><span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">,</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"source_service"</span><span class="op">,</span> <span class="st">"current"</span><span class="op">),</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"target_service"</span><span class="op">,</span> serviceName<span class="op">));</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>                <span class="kw">return</span> await response<span class="op">.</span><span class="fu">Content</span><span class="op">.</span><span class="fu">ReadFromJsonAsync</span><span class="op">&lt;</span>T<span class="op">&gt;();</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>            <span class="kw">catch</span> <span class="op">(</span>CircuitBreakerOpenException<span class="op">)</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>                ServiceMeshMetrics<span class="op">.</span><span class="fu">ServiceRequests</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"source_service"</span><span class="op">,</span> <span class="st">"current"</span><span class="op">),</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"target_service"</span><span class="op">,</span> serviceName<span class="op">),</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"circuit_breaker_open"</span><span class="op">));</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>                <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>            <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>                stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>                ServiceMeshMetrics<span class="op">.</span><span class="fu">ServiceRequests</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"source_service"</span><span class="op">,</span> <span class="st">"current"</span><span class="op">),</span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"target_service"</span><span class="op">,</span> serviceName<span class="op">),</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"error"</span><span class="op">));</span></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>                activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>                <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="troubleshooting-and-debugging" class="level2">
<h2 class="anchored" data-anchor-id="troubleshooting-and-debugging">Troubleshooting and Debugging</h2>
<section id="common-observability-issues" class="level3">
<h3 class="anchored" data-anchor-id="common-observability-issues">Common Observability Issues</h3>
<section id="missing-traces" class="level4">
<h4 class="anchored" data-anchor-id="missing-traces">Missing Traces</h4>
<p><strong>Debugging trace propagation problems</strong>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> TracePropagationDebugging</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ValidateTraceContext</span><span class="op">(</span>HttpContext context<span class="op">)</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> traceParent <span class="op">=</span> context<span class="op">.</span><span class="fu">Request</span><span class="op">.</span><span class="fu">Headers</span><span class="op">[</span><span class="st">"traceparent"</span><span class="op">].</span><span class="fu">FirstOrDefault</span><span class="op">();</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> traceState <span class="op">=</span> context<span class="op">.</span><span class="fu">Request</span><span class="op">.</span><span class="fu">Headers</span><span class="op">[</span><span class="st">"tracestate"</span><span class="op">].</span><span class="fu">FirstOrDefault</span><span class="op">();</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span><span class="dt">string</span><span class="op">.</span><span class="fu">IsNullOrEmpty</span><span class="op">(</span>traceParent<span class="op">))</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogWarning</span><span class="op">(</span><span class="st">"No trace context found in request headers"</span><span class="op">);</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">else</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogDebug</span><span class="op">(</span><span class="st">"Trace context: {TraceParent}, State: {TraceState}"</span><span class="op">,</span> </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                          traceParent<span class="op">,</span> traceState<span class="op">);</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate current activity</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> currentActivity <span class="op">=</span> Activity<span class="op">.</span><span class="fu">Current</span><span class="op">;</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>currentActivity <span class="op">==</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogError</span><span class="op">(</span><span class="st">"No current activity found - trace propagation may be broken"</span><span class="op">);</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">else</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogDebug</span><span class="op">(</span><span class="st">"Current activity: {ActivityId}, Parent: {ParentId}"</span><span class="op">,</span> </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                          currentActivity<span class="op">.</span><span class="fu">Id</span><span class="op">,</span> currentActivity<span class="op">.</span><span class="fu">ParentId</span><span class="op">);</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="metric-collection-issues" class="level4">
<h4 class="anchored" data-anchor-id="metric-collection-issues">Metric Collection Issues</h4>
<p><strong>Diagnosing missing or incorrect metrics</strong>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MetricsDiagnostics</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ValidateMetricsCollection</span><span class="op">()</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> meterProvider <span class="op">=</span> services<span class="op">.</span><span class="fu">GetService</span><span class="op">&lt;</span>MeterProvider<span class="op">&gt;();</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>meterProvider <span class="op">==</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogError</span><span class="op">(</span><span class="st">"MeterProvider not registered - metrics will not be collected"</span><span class="op">);</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span><span class="op">;</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate meter registration</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> meter <span class="op">=</span> meterProvider<span class="op">.</span><span class="fu">GetMeter</span><span class="op">(</span><span class="st">"MyApp"</span><span class="op">);</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>meter <span class="op">==</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogWarning</span><span class="op">(</span><span class="st">"Application meter not found - verify meter name"</span><span class="op">);</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Test metric recording</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> testCounter <span class="op">=</span> meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"test.counter"</span><span class="op">);</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        testCounter<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>        logger<span class="op">.</span><span class="fu">LogInformation</span><span class="op">(</span><span class="st">"Metrics validation completed"</span><span class="op">);</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="performance-optimization" class="level3">
<h3 class="anchored" data-anchor-id="performance-optimization">Performance Optimization</h3>
<section id="reducing-observability-overhead" class="level4">
<h4 class="anchored" data-anchor-id="reducing-observability-overhead">Reducing Observability Overhead</h4>
<p><strong>Optimizing observability impact</strong> on application performance:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ObservabilityOptimization</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use sampling for high-frequency operations</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> SampledMetric<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> HighFrequencyMetric <span class="op">=</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> SampledMetric<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"high_frequency.operation"</span><span class="op">,</span> sampleRate<span class="op">:</span> <span class="fl">0.1</span><span class="op">);</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Batch metric updates</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> BatchedCounter BatchedCounter <span class="op">=</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> <span class="fu">BatchedCounter</span><span class="op">(</span><span class="st">"batched.operations"</span><span class="op">,</span> flushInterval<span class="op">:</span> TimeSpan<span class="op">.</span><span class="fu">FromSeconds</span><span class="op">(</span><span class="dv">5</span><span class="op">));</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Conditional instrumentation</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="fu">MethodImpl</span><span class="op">(</span>MethodImplOptions<span class="op">.</span><span class="fu">AggressiveInlining</span><span class="op">)]</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">RecordMetricIfEnabled</span><span class="op">(</span><span class="dt">string</span> metricName<span class="op">,</span> <span class="dt">double</span> value<span class="op">)</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>observabilityConfig<span class="op">.</span><span class="fu">IsMetricEnabled</span><span class="op">(</span>metricName<span class="op">))</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">GetMeter</span><span class="op">().</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>metricName<span class="op">).</span><span class="fu">Record</span><span class="op">(</span>value<span class="op">);</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Async metric recording</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> Task <span class="fu">RecordMetricAsync</span><span class="op">(</span><span class="dt">string</span> metricName<span class="op">,</span> <span class="dt">double</span> value<span class="op">)</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> Task<span class="op">.</span><span class="fu">Run</span><span class="op">(()</span> <span class="op">=&gt;</span> </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">GetMeter</span><span class="op">().</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>metricName<span class="op">).</span><span class="fu">Record</span><span class="op">(</span>value<span class="op">);</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This comprehensive document covers the extensive observability capabilities in .NET 10, from runtime-level enhancements to the powerful .NET Aspire observability stack. The integration of native OpenTelemetry support, enhanced metrics collection, and sophisticated diagnostic tools positions .NET 10 as a leader in application observability and monitoring.</p>


<!-- -->

</section>
</section>
</section>
</section>

</main> <!-- /main -->
<!-- Bootstrap Icons CDN - ensures icons are loaded -->

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">



<!-- Navbar and general icon fixes -->

<style>

/* Ensure icons display properly in navbar */

.navbar .bi {

    font-size: 1.2em;

    margin-right: 0.5rem;

}



/* Fix for missing icons in navigation */

.navbar-nav .nav-link {

    display: flex;

    align-items: center;

    gap: 0.5rem;

}



/* GitHub icon - ensure it shows properly */

.navbar-nav a[aria-label="GitHub Repository"] {

    display: flex;

    align-items: center;

}



.navbar-nav a[aria-label="GitHub Repository"]:before {

    content: "\F3ED";

    font-family: "bootstrap-icons" !important;

    font-size: 1.2em;

    display: inline-block;

}



/* Home icon for navbar */

.navbar-nav a[href="index.qmd"], 

.navbar-nav a[href="./index.qmd"] {

    display: flex;

    align-items: center;

}



.navbar-nav a[href="index.qmd"]:before, 

.navbar-nav a[href="./index.qmd"]:before {

    content: "\F425";

    font-family: "bootstrap-icons" !important;

    font-size: 1.1em;

    margin-right: 0.5rem;

    display: inline-block;

}



/* Enhanced typography for better readability */

.navbar-brand {

    font-weight: 600;

    letter-spacing: 0.02em;

}



/* Improve navigation appearance */

.navbar-nav .dropdown-menu {

    border-radius: 0.5rem;

    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);

}



/* Force icon font loading */

@font-face {

    font-family: 'bootstrap-icons';

    src: url('https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/fonts/bootstrap-icons.woff2') format('woff2'),

         url('https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/fonts/bootstrap-icons.woff') format('woff');

}

</style>



<script>

document.addEventListener('DOMContentLoaded', function() {

    console.log('Navbar fixes script loaded');

    

    // Wait for fonts to load

    setTimeout(function() {

        // Force add Bootstrap Icons CSS if not already loaded

        if (!document.querySelector('link[href*="bootstrap-icons"]')) {

            const link = document.createElement('link');

            link.rel = 'stylesheet';

            link.href = 'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css';

            document.head.appendChild(link);

        }

        

        // Fix navbar icons

        const homeLink = document.querySelector('.navbar-nav a[href*="index"]');

        if (homeLink && !homeLink.querySelector('.bi')) {

            console.log('Adding home icon to navbar');

            const icon = document.createElement('i');

            icon.className = 'bi bi-house-fill';

            icon.style.marginRight = '0.5rem';

            homeLink.prepend(icon);

        }

        

        const githubLink = document.querySelector('.navbar-nav a[aria-label*="GitHub"]');

        if (githubLink && !githubLink.querySelector('.bi')) {

            console.log('Adding github icon to navbar');

            const icon = document.createElement('i');

            icon.className = 'bi bi-github';

            githubLink.prepend(icon);

        }

        

        // Fix any other icon elements that might need the .bi class

        const iconElements = document.querySelectorAll('[class*="bi-"]:not(.bi)');

        iconElements.forEach(el => {

            if (!el.classList.contains('bi')) {

                el.classList.add('bi');

            }

        });

        

    }, 1000);

});

</script>
<!-- Sidebar styling and fixes -->

<style>

/* Home link special styling - make it white and prominent */

.sidebar .nav-link[href="index.qmd"],

.sidebar .sidebar-item-text[href="index.qmd"],

.sidebar a[href="index.qmd"],

.sidebar-navigation .sidebar-item-text[href="index.qmd"],

#quarto-sidebar .sidebar-item-text[href="index.qmd"] {

  font-weight: 600 !important;

  font-size: 1.1rem !important;

  color: white !important;

  background: linear-gradient(135deg, #2780e3 0%, #1967d2 100%) !important;

  border: 2px solid #2780e3 !important;

  margin-bottom: 1rem !important;

  padding: 0.8rem 1rem !important;

  border-radius: 12px !important;

  box-shadow: 0 3px 8px rgba(39, 128, 227, 0.3) !important;

  transition: all 0.3s ease !important;

  display: block !important;

}



.sidebar .nav-link[href="index.qmd"]:hover,

.sidebar .sidebar-item-text[href="index.qmd"]:hover,

.sidebar a[href="index.qmd"]:hover,

.sidebar-navigation .sidebar-item-text[href="index.qmd"]:hover,

#quarto-sidebar .sidebar-item-text[href="index.qmd"]:hover {

  background: linear-gradient(135deg, #1967d2 0%, #1557b0 100%) !important;

  transform: translateX(3px) translateY(-1px) !important;

  box-shadow: 0 6px 16px rgba(39, 128, 227, 0.4) !important;

  border-color: #1967d2 !important;

  color: white !important;

}



/* Ensure sidebar icons work with emoji fallback */

.sidebar-navigation .sidebar-item-text {

    display: inline-flex;

    align-items: center;

}



/* Bootstrap Icons spacing fix - add margin between icon and text */

.sidebar .nav-link .bi,

.sidebar .sidebar-item-text .bi,

#quarto-sidebar .sidebar-item-text .bi {

  margin-right: 0.75rem !important;

  font-size: 1.1em !important;

}



/* General sidebar icon spacing */

.sidebar .nav-link i,

.sidebar .sidebar-item-text i,

#quarto-sidebar .sidebar-item-text i {

  margin-right: 0.75rem !important;

  font-size: 1.1em !important;

}



/* Force Bootstrap Icons to display with proper spacing in sidebar */

.sidebar .sidebar-item-text .bi::before,

#quarto-sidebar .sidebar-item-text .bi::before {

  margin-right: 0.75rem !important;

}



/* Section icons spacing */

.sidebar .sidebar-section > .nav-link .bi,

#quarto-sidebar .sidebar-section > .sidebar-item-text .bi {

  margin-right: 0.75rem !important;

}



/* Also target the Home icon specifically */

.sidebar .sidebar-item-text[href="index.qmd"] .bi-house-fill,

#quarto-sidebar .sidebar-item-text[href="index.qmd"] .bi-house-fill {

  color: white !important;

  margin-right: 0.75rem !important;

}

</style>



<script>

document.addEventListener('DOMContentLoaded', function() {

    console.log('Sidebar fixes script loaded');

    

    setTimeout(function() {

        // Fix sidebar Home link styling

        const sidebarHomeLinks = document.querySelectorAll(

            '.sidebar a[href*="index"], #quarto-sidebar a[href*="index"], .sidebar-item-text[href*="index"]'

        );

        sidebarHomeLinks.forEach(link => {

            if (link.textContent.trim().toLowerCase().includes('home')) {

                console.log('Applying white styling to Home link in sidebar');

                link.style.setProperty('color', 'white', 'important');

                link.style.setProperty('background', 'linear-gradient(135deg, #2780e3 0%, #1967d2 100%)', 'important');

                link.style.setProperty('border', '2px solid #2780e3', 'important');

                link.style.setProperty('border-radius', '12px', 'important');

                link.style.setProperty('padding', '0.8rem 1rem', 'important');

                link.style.setProperty('font-weight', '600', 'important');

                link.style.setProperty('box-shadow', '0 3px 8px rgba(39, 128, 227, 0.3)', 'important');

                link.style.setProperty('margin-bottom', '1rem', 'important');

                link.classList.add('home-link-styled');

                

                // Add home icon if missing

                if (!link.querySelector('.bi-house-fill')) {

                    const homeIcon = document.createElement('i');

                    homeIcon.className = 'bi bi-house-fill';

                    homeIcon.style.marginRight = '0.75rem';

                    homeIcon.style.color = 'white';

                    link.prepend(homeIcon);

                }

            }

        });

    }, 1000);

});

</script>
<div id="custom-right-nav" style="display: none;">

  <div class="toc-title">Related Pages</div>

  <nav class="toc" role="doc-toc">

    <ul>

      <li><em>Loading...</em></li>

    </ul>

  </nav>

</div>



<style>

/* Professional Related Pages navigation styling - RIGHT SIDEBAR ONLY */

#custom-right-nav {

  width: 100%;

  background: #f8f9fa;

  border: 1px solid #e9ecef;

  border-radius: 6px;

  padding: 12px;

  margin-top: 2rem; /* Add spacing from native TOC */

  font-size: 0.9rem;

  max-height: 60vh; /* Reduced from 70vh to leave space for native TOC */

  overflow-y: auto;

  scroll-behavior: smooth;

}



/* Ensure our custom nav doesn't interfere with native TOC styling */

#custom-right-nav.custom-navigation {

  background: #f0f8ff; /* Slightly different background to distinguish from native TOC */

  border-color: #2780e3;

}



#custom-right-nav .toc-title {

  font-weight: 600;

  font-size: 1rem;

  color: #2780e3;

  margin-bottom: 12px;

  padding-bottom: 6px;

  border-bottom: 2px solid #2780e3;

}



/* Ensure native TOC is not affected by our styles */

#TOC, 

.table-of-contents:not(#custom-right-nav .table-of-contents),

nav[role="doc-toc"]:not(#custom-right-nav nav) {

  margin-bottom: 1rem !important;

}

</style>



<script>

document.addEventListener('DOMContentLoaded', function() {

  console.log('📋 Related Pages navigation loading...');

  

  // Handle responsive layout function

  function handleResponsiveLayout() {

    const customNav = document.querySelector('#custom-right-nav');

    if (!customNav) {

      console.log('🔍 handleResponsiveLayout: customNav not found');

      return;

    }

    

    // FIXED: Also ensure native TOC is preserved during responsive changes

    const nativeToc = document.querySelector('#TOC, .table-of-contents, nav[role="doc-toc"]:not(#custom-right-nav nav)');

    if (nativeToc) {

      console.log('🔍 handleResponsiveLayout: preserving native TOC visibility');

      // Don't hide native TOC on mobile - let Quarto handle that

    }

    

    const isMobile = window.innerWidth <= 800;

    console.log(`📱 handleResponsiveLayout: width=${window.innerWidth}, isMobile=${isMobile}, hasContent=${customNav.classList.contains('has-content')}`);

    

    if (isMobile) {

      customNav.style.display = 'none';

      console.log('📱 Hidden custom nav on mobile');

    } else if (customNav.classList.contains('has-content')) {

      customNav.style.display = 'block';

      console.log('💻 Showing custom nav on desktop with content');

    } else {

      console.log('💻 Desktop but no content class found');

      // Force show for debugging

      customNav.style.display = 'block';

    }

  }

  

  // Multiple initialization strategies to ensure it works across all page types

  function initializeRightNav() {

    console.log('🚀 Initializing right navigation...');

    

    // FIXED: Wait a bit longer to ensure Quarto's native TOC is fully initialized

    setTimeout(() => {

      createCustomRightNav();

      handleResponsiveLayout();

      

      // Additional attempt after a short delay for any page type

      setTimeout(() => {

        renderRightNav();

      }, 200);

    }, 300);

  }

  

  // Try immediately for any page

  initializeRightNav();

  

  // FIXED: Wait longer for Quarto to finish loading to avoid TOC conflicts

  setTimeout(initializeRightNav, 1000);

  

  // Also try when the page is fully loaded (universal)

  window.addEventListener('load', function() {

    console.log('📄 Page fully loaded, attempting right nav render...');

    setTimeout(function() {

      if (!document.querySelector('#custom-right-nav.has-content')) {

        console.log('🔄 Right nav not yet rendered, trying again...');

        createCustomRightNav();

      }

      renderRightNav();

    }, 500);

  });

  

  // Universal fallback after page load for any menu structure

  setTimeout(() => {

    console.log('⏰ Final fallback attempt for right nav...');

    renderRightNav();

  }, 2000);

  

  // Handle window resize (universal)

  window.addEventListener('resize', handleResponsiveLayout);

  

  // Dynamic navigation structure - reads from Quarto's rendered sidebar

  function extractNavigationFromSidebar() {

    const sidebar = document.querySelector('#quarto-sidebar');

    if (!sidebar) {

      console.log('❌ Sidebar not found');

      return null;

    }

    

    // Look for the main sidebar content structure - IMPROVED selectors

    const sidebarContent = sidebar.querySelector('.sidebar-menu-container, .sidebar-content, .sidebar-navigation, .sidebar-menu');

    if (!sidebarContent) {

      console.log('❌ Sidebar content not found, available classes:', sidebar.className);

      console.log('❌ Sidebar children:', Array.from(sidebar.children).map(c => c.className).join(', '));

      // Fallback: try to use the sidebar itself

      return extractItemsDirectly(sidebar);

    }

    

    console.log('✅ Found sidebar content:', sidebarContent.className);

    return extractItemsDirectly(sidebarContent);

  }



  // Extract navigation items directly from container

  function extractItemsDirectly(container) {

    const items = [];

    

    // Find all navigation items recursively with proper level tracking

    function extractItems(element, level = 0) {

      const childItems = [];

      const directChildren = Array.from(element.children);

      

      directChildren.forEach(child => {

        // Look for sidebar items at any level

        if (child.classList.contains('sidebar-item') || 

            child.classList.contains('sidebar-item-container') ||

            child.classList.contains('sidebar-section')) {

          const item = extractSidebarItem(child, level);

          if (item) {

            childItems.push(item);

          }

        } else if (child.tagName === 'UL' || child.tagName === 'OL') {

          // Handle list structures

          const listItems = extractItems(child, level);

          childItems.push(...listItems);

        } else if (child.children.length > 0) {

          // Recurse into other containers

          const nestedItems = extractItems(child, level);

          childItems.push(...nestedItems);

        }

      });

      

      return childItems;

    }

    

    function extractSidebarItem(itemElement, level) {

      const textElement = itemElement.querySelector('.sidebar-item-text');

      if (!textElement) return null;

      

      const item = {

        text: textElement.textContent.trim(),

        level: level,

        href: textElement.getAttribute('href'),

        isSection: !textElement.hasAttribute('href') || textElement.getAttribute('href') === '#',

        children: []

      };

      

      // FIXED: More comprehensive child container detection

      const childContainers = itemElement.querySelectorAll(':scope > .sidebar-item-container, :scope > .sidebar-section, :scope > ul, :scope > .sidebar-items, :scope > div[class*="sidebar"]');

      

      childContainers.forEach(childContainer => {

        // Extract children at the next level

        const childItems = extractItems(childContainer, level + 1);

        item.children.push(...childItems);

      });

      

      // Also check for nested sidebar items directly under this item (alternative structure)

      const directNestedItems = itemElement.querySelectorAll(':scope .sidebar-item');

      directNestedItems.forEach(nestedItem => {

        if (nestedItem !== itemElement) { // Avoid self-reference

          const nestedItemData = extractSidebarItem(nestedItem, level + 1);

          if (nestedItemData && !item.children.some(child => child.text === nestedItemData.text)) {

            item.children.push(nestedItemData);

          }

        }

      });

      

      console.log(`📝 Extracted item: "${item.text}" (level ${level}, ${item.children.length} children, isSection: ${item.isSection}, href: ${item.href})`);

      

      // Additional debug info for items with children

      if (item.children.length > 0) {

        console.log(`   📂 Children of "${item.text}":`, item.children.map(c => `"${c.text}"`).join(', '));

      }

      

      return item;

    }

    

    const allItems = extractItems(container, 0);

    console.log('📊 Total extracted navigation items:', allItems.length);

    

    return allItems;

  }



  // Find current page in navigation structure

  function findCurrentPageInNav(items, currentPath) {

    if (!items || items.length === 0) return null;

    

    const normalizedCurrentPath = currentPath.toLowerCase().replace(/\\/g, '/');

    

    console.log('🔍 Searching for path:', normalizedCurrentPath);

    

    function searchItems(itemList, parentChain = []) {

      for (const item of itemList) {

        if (item.href) {

          const itemHref = item.href.toLowerCase().replace(/\\/g, '/').replace('.md', '');

          

          // Generic matching strategies - no filename assumptions

          const isExactMatch = normalizedCurrentPath === itemHref;

          const isContainedMatch = normalizedCurrentPath.includes(itemHref) || itemHref.includes(normalizedCurrentPath);

          const isFilenameMatch = normalizedCurrentPath.endsWith(itemHref.split('/').pop());

          

          // Generic path-based matching - works for any file in same directory

          const isSameDirectoryMatch = (

            normalizedCurrentPath.split('/').slice(0, -1).join('/') === 

            itemHref.split('/').slice(0, -1).join('/')

          ) && (

            // Only match if the filenames are related (same base name or common patterns)

            normalizedCurrentPath.split('/').pop().replace(/\.(html|md)$/, '') === 

            itemHref.split('/').pop().replace(/\.(html|md)$/, '') ||

            // Or if one contains the other (like "summary" in "project-summary")

            normalizedCurrentPath.split('/').pop().includes(itemHref.split('/').pop()) ||

            itemHref.split('/').pop().includes(normalizedCurrentPath.split('/').pop())

          );

          

          const isMatch = isExactMatch || isContainedMatch || isFilenameMatch || isSameDirectoryMatch;

          

          if (isMatch) {

            console.log('🎯 Found current page: "' + item.text + '"');

            console.log('   📄 Current path: ' + normalizedCurrentPath);

            console.log('   🔗 Item href: ' + itemHref);

            console.log('   ✅ Match type: ' + (isExactMatch ? 'exact' : isContainedMatch ? 'contained' : isFilenameMatch ? 'filename' : 'same-directory'));

            

            // FIXED: For leaf nodes, determine siblings correctly

            // If this item has no children, its siblings are other items at the same level

            let siblings = [];

            let children = item.children || [];

            

            if (children.length === 0) {

              // This is a leaf node - find its siblings

              // Siblings are other items in the same itemList (at the same hierarchical level)

              siblings = itemList.filter(sibling => 

                sibling !== item && // Not the current item

                sibling.href && // Has a valid link

                sibling.href !== '#' // Not just a placeholder

              );

              

              console.log(`📄 Leaf node "${item.text}" has ${siblings.length} siblings at level ${item.level || 0}`);

              console.log('📄 Siblings:', siblings.map(s => `"${s.text}"`).join(', '));

            } else {

              // This is a section node - children are already available

              // Filter children to only include those with valid links

              const validChildren = children.filter(child => 

                child.href && child.href !== '#'

              );

              

              console.log(`📂 Section node "${item.text}" has ${validChildren.length} valid children`);

              console.log('📂 Children:', validChildren.map(c => `"${c.text}"`).join(', '));

              

              // For consistency, we'll use siblings array to store what should be shown

              // Even though they're technically children, this simplifies the downstream logic

              siblings = validChildren;

            }

            

            return {

              currentItem: item,

              parentChain: parentChain,

              siblings: siblings, // This contains either siblings or children depending on node type

              children: children,  // Always contains the original children for reference

              isLeafNode: children.length === 0

            };

          }

        }

        

        // Search in children

        if (item.children && item.children.length > 0) {

          const result = searchItems(item.children, [...parentChain, item]);

          if (result) return result;

        }

      }

      

      return null;

    }



    return searchItems(items);

  }

  

  function createCustomRightNav() {

    console.log('🏗️ Creating custom right nav...');

    console.log('🏗️ Current URL:', window.location.href);

    console.log('🏗️ Page width:', window.innerWidth);

    

    // Try multiple container strategies for right sidebar with more debugging

    const containerSelectors = [

      '#quarto-margin-sidebar',

      '.margin-sidebar', 

      '#quarto-sidebar-toc',

      '.toc-right',

      '.page-columns .margin-sidebar',

      '[class*="margin"]',

      '.page-layout-article .margin-sidebar'

    ];

    

    console.log('🔍 Searching for right sidebar containers...');

    

    let targetContainer = null;

    for (const selector of containerSelectors) {

      const found = document.querySelector(selector);

      console.log(`   Testing selector "${selector}":`, !!found);

      if (found) {

        targetContainer = found;

        console.log('✅ Found right sidebar container:', selector);

        console.log('✅ Container classes:', found.className);

        console.log('✅ Container ID:', found.id);

        break;

      }

    }



    if (!targetContainer) {

      console.log('❌ Right sidebar container not found. Available page structure:');

      console.log('   Body classes:', document.body.className);

      console.log('   HTML classes:', document.documentElement.className);

      

      // Try to find any element that might be the right sidebar

      const allSidebarCandidates = document.querySelectorAll('[class*="sidebar"], [class*="margin"], [class*="toc"], [id*="sidebar"], [id*="margin"], [id*="toc"]');

      console.log('   Found potential containers:', Array.from(allSidebarCandidates).map(el => `${el.tagName}.${el.className}#${el.id}`));

      

      // As a last resort, try to append to body

      console.log('⚠️ Attempting to create right sidebar container...');

      const rightSidebarContainer = document.createElement('div');

      rightSidebarContainer.id = 'custom-margin-sidebar';

      rightSidebarContainer.style.cssText = `

        position: fixed;

        right: 20px;

        top: 100px;

        width: 250px;

        max-height: 60vh;

        overflow-y: auto;

        z-index: 1000;

        background: white;

        border: 1px solid #ddd;

        border-radius: 6px;

        padding: 10px;

        box-shadow: 0 2px 10px rgba(0,0,0,0.1);

      `;

      document.body.appendChild(rightSidebarContainer);

      targetContainer = rightSidebarContainer;

      console.log('✅ Created fallback right sidebar container');

    }



    // Check if custom nav already exists

    const existing = document.querySelector('#custom-right-nav');

    if (existing) {

      console.log('🔄 Removing existing custom nav');

      existing.remove();

    }



    // FIXED: Check if there's already a native Quarto TOC and preserve it

    const existingToc = targetContainer.querySelector('#TOC, .table-of-contents, nav[role="doc-toc"]:not(#custom-right-nav nav), .toc:not(#custom-right-nav .toc)');

    console.log('🔍 Found existing TOC:', !!existingToc);

    if (existingToc) {

      console.log('✅ Preserving existing Quarto TOC:', existingToc.className, existingToc.id);

      

      // Make sure the existing TOC is visible and properly styled

      existingToc.style.display = '';

      existingToc.style.visibility = '';

    }



    // Create the custom nav element with proper styling

    const customNav = document.createElement('div');

    customNav.id = 'custom-right-nav';

    customNav.className = 'toc-right custom-navigation'; // Added custom class for distinction

    customNav.innerHTML = `

      <div class="toc-title">Related Pages</div>

      <nav class="toc" role="doc-toc">

        <ul>

          <li><em>Loading...</em></li>

        </ul>

      </nav>

    `;



    // FIXED: Insert AFTER the existing TOC, not before or instead of it

    if (existingToc) {

      // Add some spacing between TOCs

      customNav.style.marginTop = '2rem';

      existingToc.parentNode.insertBefore(customNav, existingToc.nextSibling);

      console.log('✅ Inserted custom nav AFTER existing TOC to preserve native functionality');

    } else {

      targetContainer.appendChild(customNav);

      console.log('✅ Appended custom nav to container (no existing TOC found)');

    }



    console.log('✅ Custom nav created and added to DOM');

    

    // FIXED: Don't force show immediately - let the responsive handler decide

    // customNav.style.display = 'block';

    // customNav.style.visibility = 'visible';



    // Now render the navigation

    setTimeout(() => {

      console.log('⏰ About to render right nav content...');

      renderRightNav();

    }, 100);

  }



  // Get current page path, accounting for different environments

  function getCurrentPagePath() {

    let path = window.location.pathname;

    

    // Handle different URL structures

    if (path === '/' || path === '') {

      return 'index';

    }

    

    // Remove leading slash and decode URI components

    path = path.replace(/^\//, '');

    try {

      path = decodeURIComponent(path);

    } catch (e) {

      // If decoding fails, use original path

      console.log('⚠️ URI decoding failed, using original path');

    }

    

    // Convert .html back to source file extensions for matching

    path = path.replace('.html', '');

    

    console.log('📍 Current path detected:', path);

    return path;

  }

  

  // Find the relevant section for the current page

  function findCurrentSection(currentPath) {

    console.log('🔍 Looking for section for path:', currentPath);

    

    // Handle home page special case

    if (!currentPath || currentPath === '/' || currentPath === '' || currentPath === 'index') {

      return {

        sectionName: 'Home',

        subsectionName: 'Quick Navigation',

        subsectionData: {

          pages: []

        }

      };

    }

    

    // Normalize current path for matching

    const normalizedPath = currentPath.toLowerCase().replace(/\\/g, '/');

    

    const navData = extractNavigationFromSidebar();

    if (!navData) {

      console.log('❌ No navigation data available');

      return null;

    }

    

    // Try to find the current section by analyzing the navigation data

    for (const item of navData) {

      // Check if this item matches the current path

      if (item.href && normalizedPath === item.href.toLowerCase().replace(/\\/g, '/').replace('.md', '')) {

        console.log('✅ Current section found in navigation:', item.text);

        

        return {

          sectionName: item.text,

          subsectionName: null,

          subsectionData: null

        };

      }

      

      // Check in children recursively

      const result = findSectionInChildren(item.children, normalizedPath);

      if (result) {

        return result;

      }

    }

    

    console.log('❌ Current section not found in navigation');

    return null;

  }



  // Recursive helper to find section in children

  function findSectionInChildren(children, path) {

    for (const child of children) {

      // Check if this child matches the path

      if (child.href && path === child.href.toLowerCase().replace(/\\/g, '/').replace('.md', '')) {

        console.log('✅ Current subsection found in navigation:', child.text);

        

        return {

          sectionName: child.text,

          subsectionName: null,

          subsectionData: null

        };

      }

      

      // Recurse into deeper children

      const result = findSectionInChildren(child.children, path);

      if (result) {

        return result;

      }

    }

    

    return null;

  }

  

  // Render the right navigation based on the extracted items

  function renderRightNav() {

    const navItems = extractNavigationFromSidebar();

    if (!navItems) return;

    

    const customNav = document.querySelector('#custom-right-nav');

    if (!customNav) return;

    

    const currentPath = getCurrentPagePath();

    const currentNavItem = findCurrentPageInNav(navItems, currentPath);

    

    // Mark the current item and its parents as active

    function markActiveItems(item, isActive = false) {

      if (!item) return isActive;

      

      const itemElement = document.querySelector(`#custom-right-nav [href="${item.href}"]`);

      if (itemElement) {

        itemElement.classList.add('active');

        isActive = true;

      }

      

      // Also mark parents as active (for nested items)

      if (item.parent) {

        markActiveItems(item.parent, isActive);

      }

      

      return isActive;

    }

    

    // Clear existing content and render the new navigation

    function renderItemsList(container, items, level = 0) {

      container.innerHTML = '';

      

      if (!items || items.length === 0) {

        container.innerHTML = '<li><em>No related pages found</em></li>';

        return;

      }

      

      const list = document.createElement('ul');

      list.className = 'nav-list';

      

      items.forEach(item => {

        const listItem = document.createElement('li');

        listItem.className = 'nav-item';

        

        // Link element

        const link = document.createElement('a');

        link.href = item.href || '#';

        link.textContent = item.text;

        link.className = 'nav-link';

        

        // Active class for current item

        if (currentNavItem && currentNavItem.currentItem && currentNavItem.currentItem.text === item.text) {

          link.classList.add('active');

        }

        

        link.addEventListener('click', function(e) {

          // Prevent default if it's just a placeholder

          if (item.href === '#' || !item.href) {

            e.preventDefault();

          }

        });

        

        listItem.appendChild(link);

        

        // Recursively render children if they exist

        if (item.children && item.children.length > 0) {

          const childContainer = document.createElement('div');

          childContainer.className = 'child-nav-container';

          renderItemsList(childContainer, item.children, level + 1);

          listItem.appendChild(childContainer);

        }

        

        list.appendChild(listItem);

      });

      

      container.appendChild(list);

    }

    

    const navContainer = customNav.querySelector('.toc > ul');

    if (navContainer) {

      // Clear existing content

      navContainer.innerHTML = '';

      

      if (currentNavItem) {

        // Show current item and its siblings/children

        const { currentItem, siblings, children } = currentNavItem;

        

        renderItemsList(navContainer, siblings || children);

        

        // Mark the current item as active

        markActiveItems(currentItem);

      } else {

        // Just render the top-level items

        renderItemsList(navContainer, navItems);

      }

    }

    

    customNav.classList.add('has-content');

    handleResponsiveLayout();

    

    // Debugging output

    console.log('📜 Navigation rendered:', navItems);

  }

  

  // Initial right navigation setup

  setTimeout(() => {

    createCustomRightNav();

  }, 1000);

});

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/darioairoldi\.github\.io\/Learn");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb36" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Inside Observability with .NET 10</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Table of Contents</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="co">[</span><span class="ot">Overview</span><span class="co">](#overview)</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="co">[</span><span class="ot">Observability Fundamentals</span><span class="co">](#observability-fundamentals)</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="co">[</span><span class="ot">.NET 10 Runtime Observability Enhancements</span><span class="co">](#net-10-runtime-observability-enhancements)</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span><span class="co">[</span><span class="ot">Built-in Metrics and Telemetry</span><span class="co">](#built-in-metrics-and-telemetry)</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span><span class="co">[</span><span class="ot">OpenTelemetry Integration</span><span class="co">](#opentelemetry-integration)</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span><span class="co">[</span><span class="ot">.NET Aspire Observability Stack</span><span class="co">](#net-aspire-observability-stack)</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span><span class="co">[</span><span class="ot">Monitoring and Diagnostic Tools</span><span class="co">](#monitoring-and-diagnostic-tools)</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span><span class="co">[</span><span class="ot">Performance Profiling and Analysis</span><span class="co">](#performance-profiling-and-analysis)</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span><span class="co">[</span><span class="ot">Distributed Tracing</span><span class="co">](#distributed-tracing)</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span><span class="co">[</span><span class="ot">Best Practices and Implementation Patterns</span><span class="co">](#best-practices-and-implementation-patterns)</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="ss">11. </span><span class="co">[</span><span class="ot">Real-World Scenarios</span><span class="co">](#real-world-scenarios)</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="ss">12. </span><span class="co">[</span><span class="ot">Troubleshooting and Debugging</span><span class="co">](#troubleshooting-and-debugging)</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>Observability in .NET 10 represents a fundamental shift toward comprehensive application monitoring, diagnostics, and performance analysis. The new runtime introduces native instrumentation capabilities, enhanced metrics collection, and seamless integration with modern observability platforms.</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>This document provides an in-depth exploration of observability features in .NET 10, covering both runtime-level enhancements and the powerful observability stack provided by .NET Aspire.</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Observability Fundamentals</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Three Pillars of Observability</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 1. Metrics</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>**Quantitative measurements** that provide insights into system performance and behavior:</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Counter metrics**: Request counts, error counts, operation counts</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Gauge metrics**: Memory usage, CPU utilization, active connections</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Histogram metrics**: Request duration, response size distribution</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Summary metrics**: Percentile calculations, aggregated statistics</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2. Logs</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>**Structured events** that capture detailed information about application execution:</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Structured logging**: JSON-formatted logs with consistent schemas</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Contextual information**: Request IDs, user IDs, operation context</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Log levels**: Debug, Information, Warning, Error, Critical</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Correlation**: Cross-service log correlation and tracing</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3. Traces</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>**Distributed execution paths** that show request flow across services:</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Spans**: Individual operations within a trace</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Trace context**: Propagation across service boundaries</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Baggage**: Key-value pairs carried across spans</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sampling**: Intelligent trace collection strategies</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modern Observability Requirements</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cloud-Native Applications</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Microservices architecture**: Multiple services requiring coordinated monitoring</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Container orchestration**: Kubernetes and container-specific metrics</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Auto-scaling**: Dynamic resource allocation monitoring</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Service mesh**: Network-level observability and security metrics</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Performance Engineering</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Real-time monitoring**: Live performance dashboards and alerting</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Capacity planning**: Resource utilization trends and forecasting</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Bottleneck identification**: Performance hotspot detection</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**User experience**: End-user performance monitoring</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## .NET 10 Runtime Observability Enhancements</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a><span class="fu">### Native Instrumentation</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Built-in Semantic Conventions</span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>.NET 10 introduces **native OpenTelemetry semantic conventions** without requiring additional packages:</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatic instrumentation for HTTP requests</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ApiController <span class="op">:</span> ControllerBase</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="fu">HttpGet</span><span class="op">(</span><span class="st">"/api/products"</span><span class="op">)]</span></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>IActionResult<span class="op">&gt;</span> <span class="fu">GetProducts</span><span class="op">()</span></span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Automatically generates:</span></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>        <span class="co">// - http.method = "GET"</span></span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>        <span class="co">// - http.url = "/api/products"</span></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a>        <span class="co">// - http.status_code = 200</span></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a>        <span class="co">// - http.response_time_ms = execution_duration</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="fu">Ok</span><span class="op">(</span>await productService<span class="op">.</span><span class="fu">GetProductsAsync</span><span class="op">());</span></span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Activity and Span Enhancement</span></span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a>**Improved Activity API** with richer context and better performance:</span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> System<span class="op">.</span><span class="fu">Diagnostics</span><span class="op">;</span></span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> OrderProcessingService</span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"OrderProcessing"</span><span class="op">,</span> <span class="st">"1.0.0"</span><span class="op">);</span></span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>Order<span class="op">&gt;</span> <span class="fu">ProcessOrderAsync</span><span class="op">(</span>CreateOrderRequest request<span class="op">)</span></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessOrder"</span><span class="op">);</span></span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Automatic context propagation</span></span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.customer_id"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">CustomerId</span><span class="op">);</span></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.item_count"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">Items</span><span class="op">.</span><span class="fu">Count</span><span class="op">);</span></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> order <span class="op">=</span> await <span class="fu">CreateOrderAsync</span><span class="op">(</span>request<span class="op">);</span></span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.id"</span><span class="op">,</span> order<span class="op">.</span><span class="fu">Id</span><span class="op">);</span></span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Ok</span><span class="op">);</span></span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> order<span class="op">;</span></span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a><span class="fu">### Enhanced Metrics Collection</span></span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Kestrel Memory Pool Metrics</span></span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a>**Real-time memory tracking** for web server optimization:</span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatic metrics collection</span></span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MemoryPoolMetrics</span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Collected automatically by .NET 10 runtime</span></span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> MemoryPoolAllocations <span class="op">=</span> </span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"kestrel.memory_pool.allocations"</span><span class="op">);</span></span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;</span> MemoryPoolUsage <span class="op">=</span> </span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="st">"kestrel.memory_pool.bytes_used"</span><span class="op">);</span></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> MemoryPoolReleaseLatency <span class="op">=</span> </span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"kestrel.memory_pool.release_latency_ms"</span><span class="op">);</span></span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Authentication and Authorization Metrics</span></span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a>**Security operation monitoring** with detailed insights:</span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> AuthMetrics</span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Login attempt tracking</span></span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> LoginAttempts <span class="op">=</span> </span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"auth.login.attempts"</span><span class="op">);</span></span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Authentication success/failure rates</span></span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> AuthenticationResults <span class="op">=</span> </span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"auth.authentication.results"</span><span class="op">);</span></span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Token validation performance</span></span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> TokenValidationDuration <span class="op">=</span> </span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"auth.token.validation_duration_ms"</span><span class="op">);</span></span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Passkey authentication metrics</span></span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> PasskeyOperations <span class="op">=</span> </span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"auth.passkey.operations"</span><span class="op">);</span></span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a><span class="fu">### Blazor-Specific Observability</span></span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Circuit Monitoring</span></span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a>**Real-time Blazor Server circuit tracking**:</span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> BlazorMetrics</span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Active circuit count</span></span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ActiveCircuits <span class="op">=</span> </span>
<span id="cb36-179"><a href="#cb36-179" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"blazor.circuits.active"</span><span class="op">);</span></span>
<span id="cb36-180"><a href="#cb36-180" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Circuit connection state</span></span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> CircuitStateChanges <span class="op">=</span> </span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"blazor.circuits.state_changes"</span><span class="op">);</span></span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Interactive rendering performance</span></span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> RenderingDuration <span class="op">=</span> </span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"blazor.rendering.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-189"><a href="#cb36-189" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SignalR connection metrics</span></span>
<span id="cb36-190"><a href="#cb36-190" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> SignalRConnections <span class="op">=</span> </span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"blazor.signalr.connections"</span><span class="op">);</span></span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-193"><a href="#cb36-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-194"><a href="#cb36-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a><span class="fu">#### WebAssembly Diagnostics</span></span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a>**Browser-based performance profiling**:</span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a><span class="co">// Browser DevTools integration</span></span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> BlazorWasmDiagnostics</span>
<span id="cb36-201"><a href="#cb36-201" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-202"><a href="#cb36-202" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">EnableBrowserProfiling</span><span class="op">()</span></span>
<span id="cb36-203"><a href="#cb36-203" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-204"><a href="#cb36-204" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Automatic CPU sampling</span></span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a>        DiagnosticSource<span class="op">.</span><span class="fu">StartCpuSampling</span><span class="op">();</span></span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Memory allocation tracking</span></span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a>        GC<span class="op">.</span><span class="fu">StartConcurrentGCTracking</span><span class="op">();</span></span>
<span id="cb36-209"><a href="#cb36-209" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-210"><a href="#cb36-210" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Performance counter collection</span></span>
<span id="cb36-211"><a href="#cb36-211" aria-hidden="true" tabindex="-1"></a>        PerformanceCounters<span class="op">.</span><span class="fu">EnableCollection</span><span class="op">();</span></span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> async Task<span class="op">&lt;</span>DiagnosticData<span class="op">&gt;</span> <span class="fu">ExtractDiagnosticsAsync</span><span class="op">()</span></span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> DiagnosticData</span>
<span id="cb36-217"><a href="#cb36-217" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-218"><a href="#cb36-218" aria-hidden="true" tabindex="-1"></a>            CpuProfile <span class="op">=</span> await DiagnosticSource<span class="op">.</span><span class="fu">GetCpuProfileAsync</span><span class="op">(),</span></span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a>            MemoryDump <span class="op">=</span> await GC<span class="op">.</span><span class="fu">GetMemoryDumpAsync</span><span class="op">(),</span></span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a>            PerformanceCounters <span class="op">=</span> PerformanceCounters<span class="op">.</span><span class="fu">GetSnapshot</span><span class="op">()</span></span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-225"><a href="#cb36-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-226"><a href="#cb36-226" aria-hidden="true" tabindex="-1"></a><span class="fu">## Built-in Metrics and Telemetry</span></span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-228"><a href="#cb36-228" aria-hidden="true" tabindex="-1"></a><span class="fu">### HTTP Request Metrics</span></span>
<span id="cb36-229"><a href="#cb36-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Automatic Collection</span></span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a>.NET 10 automatically collects comprehensive HTTP metrics:</span>
<span id="cb36-232"><a href="#cb36-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-233"><a href="#cb36-233" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatically generated metrics for each HTTP request</span></span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> HttpMetrics</span>
<span id="cb36-236"><a href="#cb36-236" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-237"><a href="#cb36-237" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Request count by method and status code</span></span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.requests{method="GET", status_code="200"}</span></span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-240"><a href="#cb36-240" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Request duration histogram</span></span>
<span id="cb36-241"><a href="#cb36-241" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.request.duration{method="GET", route="/api/products"}</span></span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Request body size</span></span>
<span id="cb36-244"><a href="#cb36-244" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.request.body.size{method="POST", route="/api/orders"}</span></span>
<span id="cb36-245"><a href="#cb36-245" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Response body size</span></span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.response.body.size{method="GET", route="/api/products"}</span></span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Active requests gauge</span></span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a>    <span class="co">// http.server.active_requests{method="GET"}</span></span>
<span id="cb36-251"><a href="#cb36-251" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-252"><a href="#cb36-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-253"><a href="#cb36-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Custom HTTP Metrics</span></span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a>**Extending built-in metrics** with application-specific data:</span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-257"><a href="#cb36-257" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-258"><a href="#cb36-258" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> CustomHttpMetrics</span>
<span id="cb36-259"><a href="#cb36-259" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-260"><a href="#cb36-260" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ApiCallsByClient <span class="op">=</span> </span>
<span id="cb36-261"><a href="#cb36-261" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"api.calls.by_client"</span><span class="op">);</span></span>
<span id="cb36-262"><a href="#cb36-262" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-263"><a href="#cb36-263" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> BusinessOperationDuration <span class="op">=</span> </span>
<span id="cb36-264"><a href="#cb36-264" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"business.operation.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-265"><a href="#cb36-265" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-266"><a href="#cb36-266" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">RecordApiCall</span><span class="op">(</span><span class="dt">string</span> clientId<span class="op">,</span> <span class="dt">string</span> operation<span class="op">,</span> <span class="dt">double</span> duration<span class="op">)</span></span>
<span id="cb36-267"><a href="#cb36-267" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-268"><a href="#cb36-268" aria-hidden="true" tabindex="-1"></a>        ApiCallsByClient<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"client_id"</span><span class="op">,</span> clientId<span class="op">));</span></span>
<span id="cb36-269"><a href="#cb36-269" aria-hidden="true" tabindex="-1"></a>        BusinessOperationDuration<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>duration<span class="op">,</span> </span>
<span id="cb36-270"><a href="#cb36-270" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"operation"</span><span class="op">,</span> operation<span class="op">));</span></span>
<span id="cb36-271"><a href="#cb36-271" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-272"><a href="#cb36-272" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-273"><a href="#cb36-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-274"><a href="#cb36-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-275"><a href="#cb36-275" aria-hidden="true" tabindex="-1"></a><span class="fu">### Database Operation Metrics</span></span>
<span id="cb36-276"><a href="#cb36-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-277"><a href="#cb36-277" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Entity Framework Core Integration</span></span>
<span id="cb36-278"><a href="#cb36-278" aria-hidden="true" tabindex="-1"></a>**Automatic database performance monitoring**:</span>
<span id="cb36-279"><a href="#cb36-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-280"><a href="#cb36-280" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-281"><a href="#cb36-281" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> DatabaseMetrics</span>
<span id="cb36-282"><a href="#cb36-282" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-283"><a href="#cb36-283" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Query execution time</span></span>
<span id="cb36-284"><a href="#cb36-284" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> QueryDuration <span class="op">=</span> </span>
<span id="cb36-285"><a href="#cb36-285" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"ef.query.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-286"><a href="#cb36-286" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-287"><a href="#cb36-287" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Connection pool metrics</span></span>
<span id="cb36-288"><a href="#cb36-288" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ConnectionPoolSize <span class="op">=</span> </span>
<span id="cb36-289"><a href="#cb36-289" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"ef.connection_pool.size"</span><span class="op">);</span></span>
<span id="cb36-290"><a href="#cb36-290" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-291"><a href="#cb36-291" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Failed query attempts</span></span>
<span id="cb36-292"><a href="#cb36-292" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> QueryErrors <span class="op">=</span> </span>
<span id="cb36-293"><a href="#cb36-293" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"ef.query.errors"</span><span class="op">);</span></span>
<span id="cb36-294"><a href="#cb36-294" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-295"><a href="#cb36-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-296"><a href="#cb36-296" aria-hidden="true" tabindex="-1"></a><span class="co">// Usage in DbContext</span></span>
<span id="cb36-297"><a href="#cb36-297" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ApplicationDbContext <span class="op">:</span> DbContext</span>
<span id="cb36-298"><a href="#cb36-298" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-299"><a href="#cb36-299" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="kw">override</span> <span class="dt">void</span> <span class="fu">OnConfiguring</span><span class="op">(</span>DbContextOptionsBuilder optionsBuilder<span class="op">)</span></span>
<span id="cb36-300"><a href="#cb36-300" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-301"><a href="#cb36-301" aria-hidden="true" tabindex="-1"></a>        optionsBuilder<span class="op">.</span><span class="fu">EnableDetailedErrors</span><span class="op">()</span></span>
<span id="cb36-302"><a href="#cb36-302" aria-hidden="true" tabindex="-1"></a>                     <span class="op">.</span><span class="fu">EnableSensitiveDataLogging</span><span class="op">(</span>isDevelopment<span class="op">)</span></span>
<span id="cb36-303"><a href="#cb36-303" aria-hidden="true" tabindex="-1"></a>                     <span class="op">.</span><span class="fu">AddInterceptors</span><span class="op">(</span><span class="kw">new</span> <span class="fu">MetricsInterceptor</span><span class="op">());</span></span>
<span id="cb36-304"><a href="#cb36-304" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-305"><a href="#cb36-305" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-306"><a href="#cb36-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-307"><a href="#cb36-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-308"><a href="#cb36-308" aria-hidden="true" tabindex="-1"></a><span class="fu">### Memory and GC Metrics</span></span>
<span id="cb36-309"><a href="#cb36-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-310"><a href="#cb36-310" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Garbage Collection Monitoring</span></span>
<span id="cb36-311"><a href="#cb36-311" aria-hidden="true" tabindex="-1"></a>**Real-time memory management insights**:</span>
<span id="cb36-312"><a href="#cb36-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-313"><a href="#cb36-313" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-314"><a href="#cb36-314" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MemoryMetrics</span>
<span id="cb36-315"><a href="#cb36-315" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-316"><a href="#cb36-316" aria-hidden="true" tabindex="-1"></a>    <span class="co">// GC collection count by generation</span></span>
<span id="cb36-317"><a href="#cb36-317" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> GCCollections <span class="op">=</span> </span>
<span id="cb36-318"><a href="#cb36-318" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"gc.collections"</span><span class="op">);</span></span>
<span id="cb36-319"><a href="#cb36-319" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-320"><a href="#cb36-320" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Memory allocated per generation</span></span>
<span id="cb36-321"><a href="#cb36-321" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;</span> GenerationSize <span class="op">=</span> </span>
<span id="cb36-322"><a href="#cb36-322" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="st">"gc.generation.size_bytes"</span><span class="op">);</span></span>
<span id="cb36-323"><a href="#cb36-323" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-324"><a href="#cb36-324" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Time spent in GC</span></span>
<span id="cb36-325"><a href="#cb36-325" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> GCTime <span class="op">=</span> </span>
<span id="cb36-326"><a href="#cb36-326" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"gc.time_ms"</span><span class="op">);</span></span>
<span id="cb36-327"><a href="#cb36-327" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-328"><a href="#cb36-328" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Large object heap size</span></span>
<span id="cb36-329"><a href="#cb36-329" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;</span> LohSize <span class="op">=</span> </span>
<span id="cb36-330"><a href="#cb36-330" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="st">"gc.loh.size_bytes"</span><span class="op">);</span></span>
<span id="cb36-331"><a href="#cb36-331" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-332"><a href="#cb36-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-333"><a href="#cb36-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-334"><a href="#cb36-334" aria-hidden="true" tabindex="-1"></a><span class="fu">## OpenTelemetry Integration</span></span>
<span id="cb36-335"><a href="#cb36-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-336"><a href="#cb36-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### Native Integration Benefits</span></span>
<span id="cb36-337"><a href="#cb36-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-338"><a href="#cb36-338" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zero-Configuration Setup</span></span>
<span id="cb36-339"><a href="#cb36-339" aria-hidden="true" tabindex="-1"></a>.NET 10 provides **built-in OpenTelemetry integration** without external packages:</span>
<span id="cb36-340"><a href="#cb36-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-341"><a href="#cb36-341" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-342"><a href="#cb36-342" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Program</span>
<span id="cb36-343"><a href="#cb36-343" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-344"><a href="#cb36-344" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">Main</span><span class="op">(</span><span class="dt">string</span><span class="op">[]</span> args<span class="op">)</span></span>
<span id="cb36-345"><a href="#cb36-345" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-346"><a href="#cb36-346" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> builder <span class="op">=</span> WebApplication<span class="op">.</span><span class="fu">CreateBuilder</span><span class="op">(</span>args<span class="op">);</span></span>
<span id="cb36-347"><a href="#cb36-347" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-348"><a href="#cb36-348" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Native OpenTelemetry - no additional packages needed</span></span>
<span id="cb36-349"><a href="#cb36-349" aria-hidden="true" tabindex="-1"></a>        builder<span class="op">.</span><span class="fu">Services</span><span class="op">.</span><span class="fu">AddOpenTelemetry</span><span class="op">()</span></span>
<span id="cb36-350"><a href="#cb36-350" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">WithMetrics</span><span class="op">(</span>metrics <span class="op">=&gt;</span></span>
<span id="cb36-351"><a href="#cb36-351" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-352"><a href="#cb36-352" aria-hidden="true" tabindex="-1"></a>                metrics<span class="op">.</span><span class="fu">AddAspNetCoreInstrumentation</span><span class="op">()</span></span>
<span id="cb36-353"><a href="#cb36-353" aria-hidden="true" tabindex="-1"></a>                       <span class="op">.</span><span class="fu">AddHttpClientInstrumentation</span><span class="op">()</span></span>
<span id="cb36-354"><a href="#cb36-354" aria-hidden="true" tabindex="-1"></a>                       <span class="op">.</span><span class="fu">AddEntityFrameworkCoreInstrumentation</span><span class="op">();</span></span>
<span id="cb36-355"><a href="#cb36-355" aria-hidden="true" tabindex="-1"></a>            <span class="op">})</span></span>
<span id="cb36-356"><a href="#cb36-356" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">WithTracing</span><span class="op">(</span>tracing <span class="op">=&gt;</span></span>
<span id="cb36-357"><a href="#cb36-357" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-358"><a href="#cb36-358" aria-hidden="true" tabindex="-1"></a>                tracing<span class="op">.</span><span class="fu">AddAspNetCoreInstrumentation</span><span class="op">()</span></span>
<span id="cb36-359"><a href="#cb36-359" aria-hidden="true" tabindex="-1"></a>                       <span class="op">.</span><span class="fu">AddHttpClientInstrumentation</span><span class="op">()</span></span>
<span id="cb36-360"><a href="#cb36-360" aria-hidden="true" tabindex="-1"></a>                       <span class="op">.</span><span class="fu">AddEntityFrameworkCoreInstrumentation</span><span class="op">();</span></span>
<span id="cb36-361"><a href="#cb36-361" aria-hidden="true" tabindex="-1"></a>            <span class="op">});</span></span>
<span id="cb36-362"><a href="#cb36-362" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-363"><a href="#cb36-363" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> app <span class="op">=</span> builder<span class="op">.</span><span class="fu">Build</span><span class="op">();</span></span>
<span id="cb36-364"><a href="#cb36-364" aria-hidden="true" tabindex="-1"></a>        app<span class="op">.</span><span class="fu">Run</span><span class="op">();</span></span>
<span id="cb36-365"><a href="#cb36-365" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-366"><a href="#cb36-366" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-367"><a href="#cb36-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-368"><a href="#cb36-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-369"><a href="#cb36-369" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Semantic Conventions</span></span>
<span id="cb36-370"><a href="#cb36-370" aria-hidden="true" tabindex="-1"></a>**Standardized telemetry attributes** following OpenTelemetry specifications:</span>
<span id="cb36-371"><a href="#cb36-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-372"><a href="#cb36-372" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-373"><a href="#cb36-373" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatic semantic conventions for HTTP operations</span></span>
<span id="cb36-374"><a href="#cb36-374" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> SemanticConventions</span>
<span id="cb36-375"><a href="#cb36-375" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-376"><a href="#cb36-376" aria-hidden="true" tabindex="-1"></a>    <span class="co">// HTTP attributes</span></span>
<span id="cb36-377"><a href="#cb36-377" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> HttpMethod <span class="op">=</span> <span class="st">"http.method"</span><span class="op">;</span></span>
<span id="cb36-378"><a href="#cb36-378" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> HttpStatusCode <span class="op">=</span> <span class="st">"http.status_code"</span><span class="op">;</span></span>
<span id="cb36-379"><a href="#cb36-379" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> HttpUrl <span class="op">=</span> <span class="st">"http.url"</span><span class="op">;</span></span>
<span id="cb36-380"><a href="#cb36-380" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> HttpUserAgent <span class="op">=</span> <span class="st">"http.user_agent"</span><span class="op">;</span></span>
<span id="cb36-381"><a href="#cb36-381" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-382"><a href="#cb36-382" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Database attributes</span></span>
<span id="cb36-383"><a href="#cb36-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> DbSystem <span class="op">=</span> <span class="st">"db.system"</span><span class="op">;</span></span>
<span id="cb36-384"><a href="#cb36-384" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> DbStatement <span class="op">=</span> <span class="st">"db.statement"</span><span class="op">;</span></span>
<span id="cb36-385"><a href="#cb36-385" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> DbOperation <span class="op">=</span> <span class="st">"db.operation.name"</span><span class="op">;</span></span>
<span id="cb36-386"><a href="#cb36-386" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-387"><a href="#cb36-387" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Service attributes</span></span>
<span id="cb36-388"><a href="#cb36-388" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> ServiceName <span class="op">=</span> <span class="st">"service.name"</span><span class="op">;</span></span>
<span id="cb36-389"><a href="#cb36-389" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> ServiceVersion <span class="op">=</span> <span class="st">"service.version"</span><span class="op">;</span></span>
<span id="cb36-390"><a href="#cb36-390" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">const</span> <span class="dt">string</span> ServiceNamespace <span class="op">=</span> <span class="st">"service.namespace"</span><span class="op">;</span></span>
<span id="cb36-391"><a href="#cb36-391" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-392"><a href="#cb36-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-393"><a href="#cb36-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-394"><a href="#cb36-394" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identity Model Logging</span></span>
<span id="cb36-395"><a href="#cb36-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-396"><a href="#cb36-396" aria-hidden="true" tabindex="-1"></a><span class="fu">#### JWT Token Validation Visibility</span></span>
<span id="cb36-397"><a href="#cb36-397" aria-hidden="true" tabindex="-1"></a>**Enhanced authentication flow monitoring**:</span>
<span id="cb36-398"><a href="#cb36-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-399"><a href="#cb36-399" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-400"><a href="#cb36-400" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> IdentityObservability</span>
<span id="cb36-401"><a href="#cb36-401" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-402"><a href="#cb36-402" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb36-403"><a href="#cb36-403" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"Microsoft.AspNetCore.Authentication"</span><span class="op">);</span></span>
<span id="cb36-404"><a href="#cb36-404" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-405"><a href="#cb36-405" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>AuthenticateResult<span class="op">&gt;</span> <span class="fu">ValidateTokenAsync</span><span class="op">(</span><span class="dt">string</span> token<span class="op">)</span></span>
<span id="cb36-406"><a href="#cb36-406" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-407"><a href="#cb36-407" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ValidateJwtToken"</span><span class="op">);</span></span>
<span id="cb36-408"><a href="#cb36-408" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-409"><a href="#cb36-409" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.token.type"</span><span class="op">,</span> <span class="st">"JWT"</span><span class="op">);</span></span>
<span id="cb36-410"><a href="#cb36-410" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.scheme"</span><span class="op">,</span> <span class="st">"Bearer"</span><span class="op">);</span></span>
<span id="cb36-411"><a href="#cb36-411" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-412"><a href="#cb36-412" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb36-413"><a href="#cb36-413" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-414"><a href="#cb36-414" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> result <span class="op">=</span> await <span class="fu">ValidateTokenInternalAsync</span><span class="op">(</span>token<span class="op">);</span></span>
<span id="cb36-415"><a href="#cb36-415" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-416"><a href="#cb36-416" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.result"</span><span class="op">,</span> result<span class="op">.</span><span class="fu">Succeeded</span> <span class="op">?</span> <span class="st">"success"</span> <span class="op">:</span> <span class="st">"failure"</span><span class="op">);</span></span>
<span id="cb36-417"><a href="#cb36-417" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.principal.name"</span><span class="op">,</span> result<span class="op">.</span><span class="fu">Principal</span><span class="op">?.</span><span class="fu">Identity</span><span class="op">?.</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb36-418"><a href="#cb36-418" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-419"><a href="#cb36-419" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="op">(!</span>result<span class="op">.</span><span class="fu">Succeeded</span><span class="op">)</span></span>
<span id="cb36-420"><a href="#cb36-420" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-421"><a href="#cb36-421" aria-hidden="true" tabindex="-1"></a>                activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"auth.failure.reason"</span><span class="op">,</span> result<span class="op">.</span><span class="fu">Failure</span><span class="op">?.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb36-422"><a href="#cb36-422" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-423"><a href="#cb36-423" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-424"><a href="#cb36-424" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> result<span class="op">;</span></span>
<span id="cb36-425"><a href="#cb36-425" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-426"><a href="#cb36-426" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb36-427"><a href="#cb36-427" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-428"><a href="#cb36-428" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb36-429"><a href="#cb36-429" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb36-430"><a href="#cb36-430" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-431"><a href="#cb36-431" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-432"><a href="#cb36-432" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-433"><a href="#cb36-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-434"><a href="#cb36-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-435"><a href="#cb36-435" aria-hidden="true" tabindex="-1"></a><span class="fu">### Custom Instrumentation</span></span>
<span id="cb36-436"><a href="#cb36-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-437"><a href="#cb36-437" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Business Logic Tracing</span></span>
<span id="cb36-438"><a href="#cb36-438" aria-hidden="true" tabindex="-1"></a>**Application-specific observability**:</span>
<span id="cb36-439"><a href="#cb36-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-440"><a href="#cb36-440" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-441"><a href="#cb36-441" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> OrderService</span>
<span id="cb36-442"><a href="#cb36-442" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-443"><a href="#cb36-443" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb36-444"><a href="#cb36-444" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"ECommerce.OrderService"</span><span class="op">,</span> <span class="st">"1.0.0"</span><span class="op">);</span></span>
<span id="cb36-445"><a href="#cb36-445" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-446"><a href="#cb36-446" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> OrdersProcessed <span class="op">=</span> </span>
<span id="cb36-447"><a href="#cb36-447" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"orders.processed"</span><span class="op">);</span></span>
<span id="cb36-448"><a href="#cb36-448" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-449"><a href="#cb36-449" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> OrderProcessingTime <span class="op">=</span> </span>
<span id="cb36-450"><a href="#cb36-450" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"orders.processing.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-451"><a href="#cb36-451" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-452"><a href="#cb36-452" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>ProcessOrderResult<span class="op">&gt;</span> <span class="fu">ProcessOrderAsync</span><span class="op">(</span>Order order<span class="op">)</span></span>
<span id="cb36-453"><a href="#cb36-453" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-454"><a href="#cb36-454" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessOrder"</span><span class="op">);</span></span>
<span id="cb36-455"><a href="#cb36-455" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> stopwatch <span class="op">=</span> Stopwatch<span class="op">.</span><span class="fu">StartNew</span><span class="op">();</span></span>
<span id="cb36-456"><a href="#cb36-456" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-457"><a href="#cb36-457" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.id"</span><span class="op">,</span> order<span class="op">.</span><span class="fu">Id</span><span class="op">);</span></span>
<span id="cb36-458"><a href="#cb36-458" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.customer_id"</span><span class="op">,</span> order<span class="op">.</span><span class="fu">CustomerId</span><span class="op">);</span></span>
<span id="cb36-459"><a href="#cb36-459" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.total_amount"</span><span class="op">,</span> order<span class="op">.</span><span class="fu">TotalAmount</span><span class="op">);</span></span>
<span id="cb36-460"><a href="#cb36-460" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-461"><a href="#cb36-461" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb36-462"><a href="#cb36-462" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-463"><a href="#cb36-463" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Validate inventory</span></span>
<span id="cb36-464"><a href="#cb36-464" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> inventoryActivity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ValidateInventory"</span><span class="op">);</span></span>
<span id="cb36-465"><a href="#cb36-465" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">ValidateInventoryAsync</span><span class="op">(</span>order<span class="op">.</span><span class="fu">Items</span><span class="op">);</span></span>
<span id="cb36-466"><a href="#cb36-466" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-467"><a href="#cb36-467" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Process payment</span></span>
<span id="cb36-468"><a href="#cb36-468" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> paymentActivity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessPayment"</span><span class="op">);</span></span>
<span id="cb36-469"><a href="#cb36-469" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> paymentResult <span class="op">=</span> await <span class="fu">ProcessPaymentAsync</span><span class="op">(</span>order<span class="op">);</span></span>
<span id="cb36-470"><a href="#cb36-470" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-471"><a href="#cb36-471" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Update inventory</span></span>
<span id="cb36-472"><a href="#cb36-472" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> updateActivity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"UpdateInventory"</span><span class="op">);</span></span>
<span id="cb36-473"><a href="#cb36-473" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">UpdateInventoryAsync</span><span class="op">(</span>order<span class="op">.</span><span class="fu">Items</span><span class="op">);</span></span>
<span id="cb36-474"><a href="#cb36-474" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-475"><a href="#cb36-475" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-476"><a href="#cb36-476" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-477"><a href="#cb36-477" aria-hidden="true" tabindex="-1"></a>            OrdersProcessed<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"success"</span><span class="op">));</span></span>
<span id="cb36-478"><a href="#cb36-478" aria-hidden="true" tabindex="-1"></a>            OrderProcessingTime<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb36-479"><a href="#cb36-479" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-480"><a href="#cb36-480" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Ok</span><span class="op">);</span></span>
<span id="cb36-481"><a href="#cb36-481" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> ProcessOrderResult<span class="op">.</span><span class="fu">Success</span><span class="op">(</span>order<span class="op">.</span><span class="fu">Id</span><span class="op">);</span></span>
<span id="cb36-482"><a href="#cb36-482" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-483"><a href="#cb36-483" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb36-484"><a href="#cb36-484" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-485"><a href="#cb36-485" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-486"><a href="#cb36-486" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-487"><a href="#cb36-487" aria-hidden="true" tabindex="-1"></a>            OrdersProcessed<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"error"</span><span class="op">));</span></span>
<span id="cb36-488"><a href="#cb36-488" aria-hidden="true" tabindex="-1"></a>            OrderProcessingTime<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb36-489"><a href="#cb36-489" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-490"><a href="#cb36-490" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb36-491"><a href="#cb36-491" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"error.type"</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">GetType</span><span class="op">().</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb36-492"><a href="#cb36-492" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-493"><a href="#cb36-493" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb36-494"><a href="#cb36-494" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-495"><a href="#cb36-495" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-496"><a href="#cb36-496" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-497"><a href="#cb36-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-498"><a href="#cb36-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-499"><a href="#cb36-499" aria-hidden="true" tabindex="-1"></a><span class="fu">## .NET Aspire Observability Stack</span></span>
<span id="cb36-500"><a href="#cb36-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-501"><a href="#cb36-501" aria-hidden="true" tabindex="-1"></a><span class="fu">### Integrated Dashboard</span></span>
<span id="cb36-502"><a href="#cb36-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-503"><a href="#cb36-503" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comprehensive Application View</span></span>
<span id="cb36-504"><a href="#cb36-504" aria-hidden="true" tabindex="-1"></a>**.NET Aspire provides a unified observability dashboard** that combines:</span>
<span id="cb36-505"><a href="#cb36-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-506"><a href="#cb36-506" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Service topology**: Visual representation of service dependencies</span>
<span id="cb36-507"><a href="#cb36-507" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Real-time metrics**: Live performance indicators and health status</span>
<span id="cb36-508"><a href="#cb36-508" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Distributed traces**: End-to-end request flow visualization</span>
<span id="cb36-509"><a href="#cb36-509" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Log aggregation**: Centralized log viewing with correlation</span>
<span id="cb36-510"><a href="#cb36-510" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Resource monitoring**: Container, database, and external service health</span>
<span id="cb36-511"><a href="#cb36-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-512"><a href="#cb36-512" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dashboard Configuration</span></span>
<span id="cb36-513"><a href="#cb36-513" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-514"><a href="#cb36-514" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Program</span>
<span id="cb36-515"><a href="#cb36-515" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-516"><a href="#cb36-516" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">Main</span><span class="op">(</span><span class="dt">string</span><span class="op">[]</span> args<span class="op">)</span></span>
<span id="cb36-517"><a href="#cb36-517" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-518"><a href="#cb36-518" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> builder <span class="op">=</span> DistributedApplication<span class="op">.</span><span class="fu">CreateBuilder</span><span class="op">(</span>args<span class="op">);</span></span>
<span id="cb36-519"><a href="#cb36-519" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-520"><a href="#cb36-520" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Add services with automatic observability</span></span>
<span id="cb36-521"><a href="#cb36-521" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> apiService <span class="op">=</span> builder<span class="op">.</span><span class="fu">AddProject</span><span class="op">&lt;</span>Projects<span class="op">.</span><span class="fu">ApiService</span><span class="op">&gt;(</span><span class="st">"apiservice"</span><span class="op">)</span></span>
<span id="cb36-522"><a href="#cb36-522" aria-hidden="true" tabindex="-1"></a>                               <span class="op">.</span><span class="fu">WithHttpEndpoint</span><span class="op">(</span>port<span class="op">:</span> <span class="dv">5001</span><span class="op">);</span></span>
<span id="cb36-523"><a href="#cb36-523" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-524"><a href="#cb36-524" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> webApp <span class="op">=</span> builder<span class="op">.</span><span class="fu">AddProject</span><span class="op">&lt;</span>Projects<span class="op">.</span><span class="fu">WebApp</span><span class="op">&gt;(</span><span class="st">"webapp"</span><span class="op">)</span></span>
<span id="cb36-525"><a href="#cb36-525" aria-hidden="true" tabindex="-1"></a>                           <span class="op">.</span><span class="fu">WithHttpEndpoint</span><span class="op">(</span>port<span class="op">:</span> <span class="dv">5000</span><span class="op">)</span></span>
<span id="cb36-526"><a href="#cb36-526" aria-hidden="true" tabindex="-1"></a>                           <span class="op">.</span><span class="fu">WithReference</span><span class="op">(</span>apiService<span class="op">);</span></span>
<span id="cb36-527"><a href="#cb36-527" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-528"><a href="#cb36-528" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Add databases with monitoring</span></span>
<span id="cb36-529"><a href="#cb36-529" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> postgres <span class="op">=</span> builder<span class="op">.</span><span class="fu">AddPostgreSQL</span><span class="op">(</span><span class="st">"postgres"</span><span class="op">)</span></span>
<span id="cb36-530"><a href="#cb36-530" aria-hidden="true" tabindex="-1"></a>                             <span class="op">.</span><span class="fu">WithDataVolume</span><span class="op">()</span></span>
<span id="cb36-531"><a href="#cb36-531" aria-hidden="true" tabindex="-1"></a>                             <span class="op">.</span><span class="fu">AddDatabase</span><span class="op">(</span><span class="st">"ecommerce"</span><span class="op">);</span></span>
<span id="cb36-532"><a href="#cb36-532" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-533"><a href="#cb36-533" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> redis <span class="op">=</span> builder<span class="op">.</span><span class="fu">AddRedis</span><span class="op">(</span><span class="st">"redis"</span><span class="op">)</span></span>
<span id="cb36-534"><a href="#cb36-534" aria-hidden="true" tabindex="-1"></a>                          <span class="op">.</span><span class="fu">WithDataVolume</span><span class="op">();</span></span>
<span id="cb36-535"><a href="#cb36-535" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-536"><a href="#cb36-536" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Services automatically get observability</span></span>
<span id="cb36-537"><a href="#cb36-537" aria-hidden="true" tabindex="-1"></a>        apiService<span class="op">.</span><span class="fu">WithReference</span><span class="op">(</span>postgres<span class="op">)</span></span>
<span id="cb36-538"><a href="#cb36-538" aria-hidden="true" tabindex="-1"></a>                  <span class="op">.</span><span class="fu">WithReference</span><span class="op">(</span>redis<span class="op">);</span></span>
<span id="cb36-539"><a href="#cb36-539" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-540"><a href="#cb36-540" aria-hidden="true" tabindex="-1"></a>        builder<span class="op">.</span><span class="fu">Build</span><span class="op">().</span><span class="fu">Run</span><span class="op">();</span></span>
<span id="cb36-541"><a href="#cb36-541" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-542"><a href="#cb36-542" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-543"><a href="#cb36-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-544"><a href="#cb36-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-545"><a href="#cb36-545" aria-hidden="true" tabindex="-1"></a><span class="fu">### Service Discovery and Health Checks</span></span>
<span id="cb36-546"><a href="#cb36-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-547"><a href="#cb36-547" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Automatic Health Monitoring</span></span>
<span id="cb36-548"><a href="#cb36-548" aria-hidden="true" tabindex="-1"></a>**Built-in health checks** for all Aspire-managed services:</span>
<span id="cb36-549"><a href="#cb36-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-550"><a href="#cb36-550" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-551"><a href="#cb36-551" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> HealthCheckConfiguration</span>
<span id="cb36-552"><a href="#cb36-552" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-553"><a href="#cb36-553" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ConfigureHealthChecks</span><span class="op">(</span>IServiceCollection services<span class="op">,</span> </span>
<span id="cb36-554"><a href="#cb36-554" aria-hidden="true" tabindex="-1"></a>                                           IConfiguration configuration<span class="op">)</span></span>
<span id="cb36-555"><a href="#cb36-555" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-556"><a href="#cb36-556" aria-hidden="true" tabindex="-1"></a>        services<span class="op">.</span><span class="fu">AddHealthChecks</span><span class="op">()</span></span>
<span id="cb36-557"><a href="#cb36-557" aria-hidden="true" tabindex="-1"></a>                <span class="co">// Automatic database health checks</span></span>
<span id="cb36-558"><a href="#cb36-558" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddNpgSql</span><span class="op">(</span>configuration<span class="op">.</span><span class="fu">GetConnectionString</span><span class="op">(</span><span class="st">"postgres"</span><span class="op">))</span></span>
<span id="cb36-559"><a href="#cb36-559" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddRedis</span><span class="op">(</span>configuration<span class="op">.</span><span class="fu">GetConnectionString</span><span class="op">(</span><span class="st">"redis"</span><span class="op">))</span></span>
<span id="cb36-560"><a href="#cb36-560" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-561"><a href="#cb36-561" aria-hidden="true" tabindex="-1"></a>                <span class="co">// HTTP endpoint health checks</span></span>
<span id="cb36-562"><a href="#cb36-562" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddUrlGroup</span><span class="op">(</span><span class="kw">new</span> <span class="fu">Uri</span><span class="op">(</span><span class="st">"https://api.example.com/health"</span><span class="op">),</span> <span class="st">"external-api"</span><span class="op">)</span></span>
<span id="cb36-563"><a href="#cb36-563" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-564"><a href="#cb36-564" aria-hidden="true" tabindex="-1"></a>                <span class="co">// Custom business logic health checks</span></span>
<span id="cb36-565"><a href="#cb36-565" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddCheck</span><span class="op">&lt;</span>OrderProcessingHealthCheck<span class="op">&gt;(</span><span class="st">"order-processing"</span><span class="op">)</span></span>
<span id="cb36-566"><a href="#cb36-566" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">AddCheck</span><span class="op">&lt;</span>PaymentServiceHealthCheck<span class="op">&gt;(</span><span class="st">"payment-service"</span><span class="op">);</span></span>
<span id="cb36-567"><a href="#cb36-567" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-568"><a href="#cb36-568" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-569"><a href="#cb36-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-570"><a href="#cb36-570" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> OrderProcessingHealthCheck <span class="op">:</span> IHealthCheck</span>
<span id="cb36-571"><a href="#cb36-571" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-572"><a href="#cb36-572" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>HealthCheckResult<span class="op">&gt;</span> <span class="fu">CheckHealthAsync</span><span class="op">(</span></span>
<span id="cb36-573"><a href="#cb36-573" aria-hidden="true" tabindex="-1"></a>        HealthCheckContext context<span class="op">,</span> </span>
<span id="cb36-574"><a href="#cb36-574" aria-hidden="true" tabindex="-1"></a>        CancellationToken cancellationToken <span class="op">=</span> <span class="kw">default</span><span class="op">)</span></span>
<span id="cb36-575"><a href="#cb36-575" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-576"><a href="#cb36-576" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb36-577"><a href="#cb36-577" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-578"><a href="#cb36-578" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Check order processing queue</span></span>
<span id="cb36-579"><a href="#cb36-579" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> queueDepth <span class="op">=</span> await <span class="fu">GetOrderQueueDepthAsync</span><span class="op">();</span></span>
<span id="cb36-580"><a href="#cb36-580" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-581"><a href="#cb36-581" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="op">(</span>queueDepth <span class="op">&gt;</span> <span class="dv">1000</span><span class="op">)</span></span>
<span id="cb36-582"><a href="#cb36-582" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-583"><a href="#cb36-583" aria-hidden="true" tabindex="-1"></a>                <span class="kw">return</span> HealthCheckResult<span class="op">.</span><span class="fu">Degraded</span><span class="op">(</span></span>
<span id="cb36-584"><a href="#cb36-584" aria-hidden="true" tabindex="-1"></a>                    $<span class="st">"Order queue depth is high: {queueDepth}"</span><span class="op">);</span></span>
<span id="cb36-585"><a href="#cb36-585" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-586"><a href="#cb36-586" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-587"><a href="#cb36-587" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> HealthCheckResult<span class="op">.</span><span class="fu">Healthy</span><span class="op">(</span>$<span class="st">"Queue depth: {queueDepth}"</span><span class="op">);</span></span>
<span id="cb36-588"><a href="#cb36-588" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-589"><a href="#cb36-589" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb36-590"><a href="#cb36-590" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-591"><a href="#cb36-591" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> HealthCheckResult<span class="op">.</span><span class="fu">Unhealthy</span><span class="op">(</span></span>
<span id="cb36-592"><a href="#cb36-592" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Order processing health check failed"</span><span class="op">,</span> ex<span class="op">);</span></span>
<span id="cb36-593"><a href="#cb36-593" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-594"><a href="#cb36-594" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-595"><a href="#cb36-595" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-596"><a href="#cb36-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-597"><a href="#cb36-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-598"><a href="#cb36-598" aria-hidden="true" tabindex="-1"></a><span class="fu">### Resource Monitoring</span></span>
<span id="cb36-599"><a href="#cb36-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-600"><a href="#cb36-600" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Container and Infrastructure Metrics</span></span>
<span id="cb36-601"><a href="#cb36-601" aria-hidden="true" tabindex="-1"></a>**Automatic infrastructure monitoring** for Aspire-managed resources:</span>
<span id="cb36-602"><a href="#cb36-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-603"><a href="#cb36-603" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-604"><a href="#cb36-604" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> AspireResourceMetrics</span>
<span id="cb36-605"><a href="#cb36-605" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-606"><a href="#cb36-606" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Container metrics</span></span>
<span id="cb36-607"><a href="#cb36-607" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> ContainerCpuUsage <span class="op">=</span> </span>
<span id="cb36-608"><a href="#cb36-608" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"container.cpu.usage_percent"</span><span class="op">);</span></span>
<span id="cb36-609"><a href="#cb36-609" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-610"><a href="#cb36-610" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;</span> ContainerMemoryUsage <span class="op">=</span> </span>
<span id="cb36-611"><a href="#cb36-611" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">long</span><span class="op">&gt;(</span><span class="st">"container.memory.usage_bytes"</span><span class="op">);</span></span>
<span id="cb36-612"><a href="#cb36-612" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-613"><a href="#cb36-613" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Database connection metrics</span></span>
<span id="cb36-614"><a href="#cb36-614" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> DatabaseConnections <span class="op">=</span> </span>
<span id="cb36-615"><a href="#cb36-615" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"database.connections.active"</span><span class="op">);</span></span>
<span id="cb36-616"><a href="#cb36-616" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-617"><a href="#cb36-617" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Redis cache metrics</span></span>
<span id="cb36-618"><a href="#cb36-618" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> CacheOperations <span class="op">=</span> </span>
<span id="cb36-619"><a href="#cb36-619" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"cache.operations"</span><span class="op">);</span></span>
<span id="cb36-620"><a href="#cb36-620" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-621"><a href="#cb36-621" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> CacheLatency <span class="op">=</span> </span>
<span id="cb36-622"><a href="#cb36-622" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"cache.operation.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-623"><a href="#cb36-623" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-624"><a href="#cb36-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-625"><a href="#cb36-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-626"><a href="#cb36-626" aria-hidden="true" tabindex="-1"></a><span class="fu">### Service-to-Service Communication</span></span>
<span id="cb36-627"><a href="#cb36-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-628"><a href="#cb36-628" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Automatic Trace Propagation</span></span>
<span id="cb36-629"><a href="#cb36-629" aria-hidden="true" tabindex="-1"></a>**Seamless distributed tracing** across Aspire services:</span>
<span id="cb36-630"><a href="#cb36-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-631"><a href="#cb36-631" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-632"><a href="#cb36-632" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ApiService</span>
<span id="cb36-633"><a href="#cb36-633" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-634"><a href="#cb36-634" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">readonly</span> HttpClient httpClient<span class="op">;</span></span>
<span id="cb36-635"><a href="#cb36-635" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">readonly</span> ILogger<span class="op">&lt;</span>ApiService<span class="op">&gt;</span> logger<span class="op">;</span></span>
<span id="cb36-636"><a href="#cb36-636" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-637"><a href="#cb36-637" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="fu">ApiService</span><span class="op">(</span>HttpClient httpClient<span class="op">,</span> ILogger<span class="op">&lt;</span>ApiService<span class="op">&gt;</span> logger<span class="op">)</span></span>
<span id="cb36-638"><a href="#cb36-638" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-639"><a href="#cb36-639" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">httpClient</span> <span class="op">=</span> httpClient<span class="op">;</span></span>
<span id="cb36-640"><a href="#cb36-640" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">logger</span> <span class="op">=</span> logger<span class="op">;</span></span>
<span id="cb36-641"><a href="#cb36-641" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-642"><a href="#cb36-642" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-643"><a href="#cb36-643" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>ProductData<span class="op">&gt;</span> <span class="fu">GetProductAsync</span><span class="op">(</span><span class="dt">int</span> productId<span class="op">)</span></span>
<span id="cb36-644"><a href="#cb36-644" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-645"><a href="#cb36-645" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Trace context automatically propagated</span></span>
<span id="cb36-646"><a href="#cb36-646" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"GetProduct"</span><span class="op">);</span></span>
<span id="cb36-647"><a href="#cb36-647" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"product.id"</span><span class="op">,</span> productId<span class="op">);</span></span>
<span id="cb36-648"><a href="#cb36-648" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-649"><a href="#cb36-649" aria-hidden="true" tabindex="-1"></a>        <span class="co">// HTTP calls automatically traced</span></span>
<span id="cb36-650"><a href="#cb36-650" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> response <span class="op">=</span> await httpClient<span class="op">.</span><span class="fu">GetAsync</span><span class="op">(</span>$<span class="st">"/products/{productId}"</span><span class="op">);</span></span>
<span id="cb36-651"><a href="#cb36-651" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-652"><a href="#cb36-652" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>response<span class="op">.</span><span class="fu">IsSuccessStatusCode</span><span class="op">)</span></span>
<span id="cb36-653"><a href="#cb36-653" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-654"><a href="#cb36-654" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> product <span class="op">=</span> await response<span class="op">.</span><span class="fu">Content</span><span class="op">.</span><span class="fu">ReadFromJsonAsync</span><span class="op">&lt;</span>ProductData<span class="op">&gt;();</span></span>
<span id="cb36-655"><a href="#cb36-655" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-656"><a href="#cb36-656" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Log with automatic correlation</span></span>
<span id="cb36-657"><a href="#cb36-657" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogInformation</span><span class="op">(</span><span class="st">"Retrieved product {ProductId}: {ProductName}"</span><span class="op">,</span> </span>
<span id="cb36-658"><a href="#cb36-658" aria-hidden="true" tabindex="-1"></a>                                productId<span class="op">,</span> product<span class="op">.</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb36-659"><a href="#cb36-659" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-660"><a href="#cb36-660" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> product<span class="op">;</span></span>
<span id="cb36-661"><a href="#cb36-661" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-662"><a href="#cb36-662" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-663"><a href="#cb36-663" aria-hidden="true" tabindex="-1"></a>        <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">ProductNotFoundException</span><span class="op">(</span>productId<span class="op">);</span></span>
<span id="cb36-664"><a href="#cb36-664" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-665"><a href="#cb36-665" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-666"><a href="#cb36-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-667"><a href="#cb36-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-668"><a href="#cb36-668" aria-hidden="true" tabindex="-1"></a><span class="fu">## Monitoring and Diagnostic Tools</span></span>
<span id="cb36-669"><a href="#cb36-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-670"><a href="#cb36-670" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visual Studio Integration</span></span>
<span id="cb36-671"><a href="#cb36-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-672"><a href="#cb36-672" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Live Diagnostic Tools</span></span>
<span id="cb36-673"><a href="#cb36-673" aria-hidden="true" tabindex="-1"></a>**Real-time performance monitoring** during development:</span>
<span id="cb36-674"><a href="#cb36-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-675"><a href="#cb36-675" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-676"><a href="#cb36-676" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> DiagnosticToolsIntegration</span>
<span id="cb36-677"><a href="#cb36-677" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-678"><a href="#cb36-678" aria-hidden="true" tabindex="-1"></a>    <span class="co">// CPU usage profiling</span></span>
<span id="cb36-679"><a href="#cb36-679" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="fu">Conditional</span><span class="op">(</span><span class="st">"DEBUG"</span><span class="op">)]</span></span>
<span id="cb36-680"><a href="#cb36-680" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">StartCpuProfiling</span><span class="op">()</span></span>
<span id="cb36-681"><a href="#cb36-681" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-682"><a href="#cb36-682" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>Debugger<span class="op">.</span><span class="fu">IsAttached</span><span class="op">)</span></span>
<span id="cb36-683"><a href="#cb36-683" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-684"><a href="#cb36-684" aria-hidden="true" tabindex="-1"></a>            DiagnosticTools<span class="op">.</span><span class="fu">StartCpuSampling</span><span class="op">();</span></span>
<span id="cb36-685"><a href="#cb36-685" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-686"><a href="#cb36-686" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-687"><a href="#cb36-687" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-688"><a href="#cb36-688" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Memory allocation tracking</span></span>
<span id="cb36-689"><a href="#cb36-689" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="fu">Conditional</span><span class="op">(</span><span class="st">"DEBUG"</span><span class="op">)]</span></span>
<span id="cb36-690"><a href="#cb36-690" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">TrackMemoryAllocations</span><span class="op">()</span></span>
<span id="cb36-691"><a href="#cb36-691" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-692"><a href="#cb36-692" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>Debugger<span class="op">.</span><span class="fu">IsAttached</span><span class="op">)</span></span>
<span id="cb36-693"><a href="#cb36-693" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-694"><a href="#cb36-694" aria-hidden="true" tabindex="-1"></a>            DiagnosticTools<span class="op">.</span><span class="fu">EnableMemoryTracking</span><span class="op">();</span></span>
<span id="cb36-695"><a href="#cb36-695" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-696"><a href="#cb36-696" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-697"><a href="#cb36-697" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-698"><a href="#cb36-698" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Custom event logging</span></span>
<span id="cb36-699"><a href="#cb36-699" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">LogPerformanceEvent</span><span class="op">(</span><span class="dt">string</span> eventName<span class="op">,</span> </span>
<span id="cb36-700"><a href="#cb36-700" aria-hidden="true" tabindex="-1"></a>                                         Dictionary<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;</span> properties<span class="op">)</span></span>
<span id="cb36-701"><a href="#cb36-701" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-702"><a href="#cb36-702" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> DiagnosticSource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span>eventName<span class="op">,</span> properties<span class="op">);</span></span>
<span id="cb36-703"><a href="#cb36-703" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-704"><a href="#cb36-704" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Event automatically appears in diagnostic tools</span></span>
<span id="cb36-705"><a href="#cb36-705" aria-hidden="true" tabindex="-1"></a>        DiagnosticTools<span class="op">.</span><span class="fu">WriteEvent</span><span class="op">(</span>eventName<span class="op">,</span> properties<span class="op">);</span></span>
<span id="cb36-706"><a href="#cb36-706" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-707"><a href="#cb36-707" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-708"><a href="#cb36-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-709"><a href="#cb36-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-710"><a href="#cb36-710" aria-hidden="true" tabindex="-1"></a><span class="fu">### Browser DevTools Integration</span></span>
<span id="cb36-711"><a href="#cb36-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-712"><a href="#cb36-712" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Blazor WebAssembly Profiling</span></span>
<span id="cb36-713"><a href="#cb36-713" aria-hidden="true" tabindex="-1"></a>**Native browser debugging** capabilities:</span>
<span id="cb36-714"><a href="#cb36-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-715"><a href="#cb36-715" aria-hidden="true" tabindex="-1"></a><span class="in">```javascript</span></span>
<span id="cb36-716"><a href="#cb36-716" aria-hidden="true" tabindex="-1"></a><span class="co">// Automatic browser integration</span></span>
<span id="cb36-717"><a href="#cb36-717" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">blazorDiagnostics</span> <span class="op">=</span> {</span>
<span id="cb36-718"><a href="#cb36-718" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Start performance profiling</span></span>
<span id="cb36-719"><a href="#cb36-719" aria-hidden="true" tabindex="-1"></a>    <span class="dt">startProfiling</span><span class="op">:</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb36-720"><a href="#cb36-720" aria-hidden="true" tabindex="-1"></a>        <span class="bu">console</span><span class="op">.</span><span class="fu">profile</span>(<span class="st">'Blazor App Performance'</span>)<span class="op">;</span></span>
<span id="cb36-721"><a href="#cb36-721" aria-hidden="true" tabindex="-1"></a>        <span class="bu">performance</span><span class="op">.</span><span class="fu">mark</span>(<span class="st">'profiling-start'</span>)<span class="op">;</span></span>
<span id="cb36-722"><a href="#cb36-722" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb36-723"><a href="#cb36-723" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-724"><a href="#cb36-724" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Stop profiling and extract data</span></span>
<span id="cb36-725"><a href="#cb36-725" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stopProfiling</span><span class="op">:</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb36-726"><a href="#cb36-726" aria-hidden="true" tabindex="-1"></a>        <span class="bu">performance</span><span class="op">.</span><span class="fu">mark</span>(<span class="st">'profiling-end'</span>)<span class="op">;</span></span>
<span id="cb36-727"><a href="#cb36-727" aria-hidden="true" tabindex="-1"></a>        <span class="bu">performance</span><span class="op">.</span><span class="fu">measure</span>(<span class="st">'total-execution'</span><span class="op">,</span> <span class="st">'profiling-start'</span><span class="op">,</span> <span class="st">'profiling-end'</span>)<span class="op">;</span></span>
<span id="cb36-728"><a href="#cb36-728" aria-hidden="true" tabindex="-1"></a>        <span class="bu">console</span><span class="op">.</span><span class="fu">profileEnd</span>(<span class="st">'Blazor App Performance'</span>)<span class="op">;</span></span>
<span id="cb36-729"><a href="#cb36-729" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-730"><a href="#cb36-730" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb36-731"><a href="#cb36-731" aria-hidden="true" tabindex="-1"></a>            <span class="dt">performanceEntries</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="fu">getEntriesByType</span>(<span class="st">'measure'</span>)<span class="op">,</span></span>
<span id="cb36-732"><a href="#cb36-732" aria-hidden="true" tabindex="-1"></a>            <span class="dt">memoryUsage</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="at">memory</span><span class="op">,</span></span>
<span id="cb36-733"><a href="#cb36-733" aria-hidden="true" tabindex="-1"></a>            <span class="dt">navigationTiming</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="fu">getEntriesByType</span>(<span class="st">'navigation'</span>)[<span class="dv">0</span>]</span>
<span id="cb36-734"><a href="#cb36-734" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb36-735"><a href="#cb36-735" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb36-736"><a href="#cb36-736" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-737"><a href="#cb36-737" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extract memory dump</span></span>
<span id="cb36-738"><a href="#cb36-738" aria-hidden="true" tabindex="-1"></a>    <span class="dt">extractMemoryDump</span><span class="op">:</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb36-739"><a href="#cb36-739" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="st">'memory'</span> <span class="kw">in</span> <span class="bu">performance</span>) {</span>
<span id="cb36-740"><a href="#cb36-740" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb36-741"><a href="#cb36-741" aria-hidden="true" tabindex="-1"></a>                <span class="dt">usedJSMemory</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="at">memory</span><span class="op">.</span><span class="at">usedJSMemory</span><span class="op">,</span></span>
<span id="cb36-742"><a href="#cb36-742" aria-hidden="true" tabindex="-1"></a>                <span class="dt">totalJSMemory</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="at">memory</span><span class="op">.</span><span class="at">totalJSMemory</span><span class="op">,</span></span>
<span id="cb36-743"><a href="#cb36-743" aria-hidden="true" tabindex="-1"></a>                <span class="dt">jsMemoryLimit</span><span class="op">:</span> <span class="bu">performance</span><span class="op">.</span><span class="at">memory</span><span class="op">.</span><span class="at">jsMemoryLimit</span></span>
<span id="cb36-744"><a href="#cb36-744" aria-hidden="true" tabindex="-1"></a>            }<span class="op">;</span></span>
<span id="cb36-745"><a href="#cb36-745" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb36-746"><a href="#cb36-746" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb36-747"><a href="#cb36-747" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-748"><a href="#cb36-748" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb36-749"><a href="#cb36-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-750"><a href="#cb36-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-751"><a href="#cb36-751" aria-hidden="true" tabindex="-1"></a><span class="fu">### Production Monitoring</span></span>
<span id="cb36-752"><a href="#cb36-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-753"><a href="#cb36-753" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Application Performance Monitoring (APM)</span></span>
<span id="cb36-754"><a href="#cb36-754" aria-hidden="true" tabindex="-1"></a>**Integration with popular APM solutions**:</span>
<span id="cb36-755"><a href="#cb36-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-756"><a href="#cb36-756" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-757"><a href="#cb36-757" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ApmIntegration</span>
<span id="cb36-758"><a href="#cb36-758" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-759"><a href="#cb36-759" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ConfigureApm</span><span class="op">(</span>IServiceCollection services<span class="op">,</span> </span>
<span id="cb36-760"><a href="#cb36-760" aria-hidden="true" tabindex="-1"></a>                                   IConfiguration configuration<span class="op">)</span></span>
<span id="cb36-761"><a href="#cb36-761" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-762"><a href="#cb36-762" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Application Insights integration</span></span>
<span id="cb36-763"><a href="#cb36-763" aria-hidden="true" tabindex="-1"></a>        services<span class="op">.</span><span class="fu">AddApplicationInsightsTelemetry</span><span class="op">(</span>configuration<span class="op">);</span></span>
<span id="cb36-764"><a href="#cb36-764" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-765"><a href="#cb36-765" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Datadog integration</span></span>
<span id="cb36-766"><a href="#cb36-766" aria-hidden="true" tabindex="-1"></a>        services<span class="op">.</span><span class="fu">AddDatadogTracing</span><span class="op">(</span>configuration<span class="op">);</span></span>
<span id="cb36-767"><a href="#cb36-767" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-768"><a href="#cb36-768" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Custom APM provider</span></span>
<span id="cb36-769"><a href="#cb36-769" aria-hidden="true" tabindex="-1"></a>        services<span class="op">.</span><span class="fu">AddOpenTelemetry</span><span class="op">()</span></span>
<span id="cb36-770"><a href="#cb36-770" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">WithTracing</span><span class="op">(</span>tracing <span class="op">=&gt;</span></span>
<span id="cb36-771"><a href="#cb36-771" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb36-772"><a href="#cb36-772" aria-hidden="true" tabindex="-1"></a>                    tracing<span class="op">.</span><span class="fu">AddOtlpExporter</span><span class="op">(</span>options <span class="op">=&gt;</span></span>
<span id="cb36-773"><a href="#cb36-773" aria-hidden="true" tabindex="-1"></a>                    <span class="op">{</span></span>
<span id="cb36-774"><a href="#cb36-774" aria-hidden="true" tabindex="-1"></a>                        options<span class="op">.</span><span class="fu">Endpoint</span> <span class="op">=</span> configuration<span class="op">[</span><span class="st">"Apm:Endpoint"</span><span class="op">];</span></span>
<span id="cb36-775"><a href="#cb36-775" aria-hidden="true" tabindex="-1"></a>                        options<span class="op">.</span><span class="fu">Headers</span> <span class="op">=</span> $<span class="st">"api-key={configuration["</span>Apm<span class="op">:</span>ApiKey<span class="st">"]}"</span><span class="op">;</span></span>
<span id="cb36-776"><a href="#cb36-776" aria-hidden="true" tabindex="-1"></a>                    <span class="op">});</span></span>
<span id="cb36-777"><a href="#cb36-777" aria-hidden="true" tabindex="-1"></a>                <span class="op">});</span></span>
<span id="cb36-778"><a href="#cb36-778" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-779"><a href="#cb36-779" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-780"><a href="#cb36-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-781"><a href="#cb36-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-782"><a href="#cb36-782" aria-hidden="true" tabindex="-1"></a><span class="fu">## Performance Profiling and Analysis</span></span>
<span id="cb36-783"><a href="#cb36-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-784"><a href="#cb36-784" aria-hidden="true" tabindex="-1"></a><span class="fu">### CPU Profiling</span></span>
<span id="cb36-785"><a href="#cb36-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-786"><a href="#cb36-786" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Automatic Sampling</span></span>
<span id="cb36-787"><a href="#cb36-787" aria-hidden="true" tabindex="-1"></a>**.NET 10 provides built-in CPU profiling** capabilities:</span>
<span id="cb36-788"><a href="#cb36-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-789"><a href="#cb36-789" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-790"><a href="#cb36-790" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> CpuProfiler</span>
<span id="cb36-791"><a href="#cb36-791" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-792"><a href="#cb36-792" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb36-793"><a href="#cb36-793" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"Performance.Profiling"</span><span class="op">);</span></span>
<span id="cb36-794"><a href="#cb36-794" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-795"><a href="#cb36-795" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> async Task<span class="op">&lt;</span>T<span class="op">&gt;</span> ProfileAsync<span class="op">&lt;</span>T<span class="op">&gt;(</span><span class="dt">string</span> operationName<span class="op">,</span> </span>
<span id="cb36-796"><a href="#cb36-796" aria-hidden="true" tabindex="-1"></a>                                               Func<span class="op">&lt;</span>Task<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> operation<span class="op">)</span></span>
<span id="cb36-797"><a href="#cb36-797" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-798"><a href="#cb36-798" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span>$<span class="st">"Profile.{operationName}"</span><span class="op">);</span></span>
<span id="cb36-799"><a href="#cb36-799" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> stopwatch <span class="op">=</span> Stopwatch<span class="op">.</span><span class="fu">StartNew</span><span class="op">();</span></span>
<span id="cb36-800"><a href="#cb36-800" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-801"><a href="#cb36-801" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Start CPU sampling</span></span>
<span id="cb36-802"><a href="#cb36-802" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> cpuSampler <span class="op">=</span> CpuSampler<span class="op">.</span><span class="fu">Start</span><span class="op">();</span></span>
<span id="cb36-803"><a href="#cb36-803" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-804"><a href="#cb36-804" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb36-805"><a href="#cb36-805" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-806"><a href="#cb36-806" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> result <span class="op">=</span> await <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb36-807"><a href="#cb36-807" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-808"><a href="#cb36-808" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-809"><a href="#cb36-809" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> cpuData <span class="op">=</span> cpuSampler<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-810"><a href="#cb36-810" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-811"><a href="#cb36-811" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"duration_ms"</span><span class="op">,</span> stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb36-812"><a href="#cb36-812" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"cpu_time_ms"</span><span class="op">,</span> cpuData<span class="op">.</span><span class="fu">CpuTimeMilliseconds</span><span class="op">);</span></span>
<span id="cb36-813"><a href="#cb36-813" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"samples_collected"</span><span class="op">,</span> cpuData<span class="op">.</span><span class="fu">SampleCount</span><span class="op">);</span></span>
<span id="cb36-814"><a href="#cb36-814" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-815"><a href="#cb36-815" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> result<span class="op">;</span></span>
<span id="cb36-816"><a href="#cb36-816" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-817"><a href="#cb36-817" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb36-818"><a href="#cb36-818" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-819"><a href="#cb36-819" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb36-820"><a href="#cb36-820" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb36-821"><a href="#cb36-821" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-822"><a href="#cb36-822" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-823"><a href="#cb36-823" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-824"><a href="#cb36-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-825"><a href="#cb36-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-826"><a href="#cb36-826" aria-hidden="true" tabindex="-1"></a><span class="fu">### Memory Analysis</span></span>
<span id="cb36-827"><a href="#cb36-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-828"><a href="#cb36-828" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Allocation Tracking</span></span>
<span id="cb36-829"><a href="#cb36-829" aria-hidden="true" tabindex="-1"></a>**Detailed memory allocation monitoring**:</span>
<span id="cb36-830"><a href="#cb36-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-831"><a href="#cb36-831" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-832"><a href="#cb36-832" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MemoryProfiler</span>
<span id="cb36-833"><a href="#cb36-833" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-834"><a href="#cb36-834" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> MemoryAnalysisResult <span class="fu">AnalyzeMemoryUsage</span><span class="op">(</span>Action operation<span class="op">)</span></span>
<span id="cb36-835"><a href="#cb36-835" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-836"><a href="#cb36-836" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Record initial state</span></span>
<span id="cb36-837"><a href="#cb36-837" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> initialMemory <span class="op">=</span> GC<span class="op">.</span><span class="fu">GetTotalMemory</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb36-838"><a href="#cb36-838" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> initialGen0 <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb36-839"><a href="#cb36-839" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> initialGen1 <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb36-840"><a href="#cb36-840" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> initialGen2 <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb36-841"><a href="#cb36-841" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-842"><a href="#cb36-842" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Enable allocation tracking</span></span>
<span id="cb36-843"><a href="#cb36-843" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> tracker <span class="op">=</span> AllocationTracker<span class="op">.</span><span class="fu">Start</span><span class="op">();</span></span>
<span id="cb36-844"><a href="#cb36-844" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-845"><a href="#cb36-845" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Execute operation</span></span>
<span id="cb36-846"><a href="#cb36-846" aria-hidden="true" tabindex="-1"></a>        <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb36-847"><a href="#cb36-847" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-848"><a href="#cb36-848" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Force garbage collection</span></span>
<span id="cb36-849"><a href="#cb36-849" aria-hidden="true" tabindex="-1"></a>        GC<span class="op">.</span><span class="fu">Collect</span><span class="op">();</span></span>
<span id="cb36-850"><a href="#cb36-850" aria-hidden="true" tabindex="-1"></a>        GC<span class="op">.</span><span class="fu">WaitForPendingFinalizers</span><span class="op">();</span></span>
<span id="cb36-851"><a href="#cb36-851" aria-hidden="true" tabindex="-1"></a>        GC<span class="op">.</span><span class="fu">Collect</span><span class="op">();</span></span>
<span id="cb36-852"><a href="#cb36-852" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-853"><a href="#cb36-853" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Calculate metrics</span></span>
<span id="cb36-854"><a href="#cb36-854" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> finalMemory <span class="op">=</span> GC<span class="op">.</span><span class="fu">GetTotalMemory</span><span class="op">(</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb36-855"><a href="#cb36-855" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> allocations <span class="op">=</span> tracker<span class="op">.</span><span class="fu">GetAllocations</span><span class="op">();</span></span>
<span id="cb36-856"><a href="#cb36-856" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-857"><a href="#cb36-857" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> MemoryAnalysisResult</span>
<span id="cb36-858"><a href="#cb36-858" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-859"><a href="#cb36-859" aria-hidden="true" tabindex="-1"></a>            TotalAllocatedBytes <span class="op">=</span> allocations<span class="op">.</span><span class="fu">TotalBytes</span><span class="op">,</span></span>
<span id="cb36-860"><a href="#cb36-860" aria-hidden="true" tabindex="-1"></a>            AllocationCount <span class="op">=</span> allocations<span class="op">.</span><span class="fu">Count</span><span class="op">,</span></span>
<span id="cb36-861"><a href="#cb36-861" aria-hidden="true" tabindex="-1"></a>            MemoryDelta <span class="op">=</span> finalMemory <span class="op">-</span> initialMemory<span class="op">,</span></span>
<span id="cb36-862"><a href="#cb36-862" aria-hidden="true" tabindex="-1"></a>            Gen0Collections <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">-</span> initialGen0<span class="op">,</span></span>
<span id="cb36-863"><a href="#cb36-863" aria-hidden="true" tabindex="-1"></a>            Gen1Collections <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">-</span> initialGen1<span class="op">,</span></span>
<span id="cb36-864"><a href="#cb36-864" aria-hidden="true" tabindex="-1"></a>            Gen2Collections <span class="op">=</span> GC<span class="op">.</span><span class="fu">CollectionCount</span><span class="op">(</span><span class="dv">2</span><span class="op">)</span> <span class="op">-</span> initialGen2<span class="op">,</span></span>
<span id="cb36-865"><a href="#cb36-865" aria-hidden="true" tabindex="-1"></a>            AllocationsBy Type <span class="op">=</span> allocations<span class="op">.</span><span class="fu">GroupBy</span><span class="op">(</span>a <span class="op">=&gt;</span> a<span class="op">.</span><span class="fu">Type</span><span class="op">)</span></span>
<span id="cb36-866"><a href="#cb36-866" aria-hidden="true" tabindex="-1"></a>                                           <span class="op">.</span><span class="fu">ToDictionary</span><span class="op">(</span>g <span class="op">=&gt;</span> g<span class="op">.</span><span class="fu">Key</span><span class="op">,</span> g <span class="op">=&gt;</span> g<span class="op">.</span><span class="fu">Sum</span><span class="op">(</span>a <span class="op">=&gt;</span> a<span class="op">.</span><span class="fu">Size</span><span class="op">))</span></span>
<span id="cb36-867"><a href="#cb36-867" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb36-868"><a href="#cb36-868" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-869"><a href="#cb36-869" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-870"><a href="#cb36-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-871"><a href="#cb36-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-872"><a href="#cb36-872" aria-hidden="true" tabindex="-1"></a><span class="fu">### Performance Benchmarking</span></span>
<span id="cb36-873"><a href="#cb36-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-874"><a href="#cb36-874" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Built-in Benchmarking Tools</span></span>
<span id="cb36-875"><a href="#cb36-875" aria-hidden="true" tabindex="-1"></a>**Integrated performance measurement**:</span>
<span id="cb36-876"><a href="#cb36-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-877"><a href="#cb36-877" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-878"><a href="#cb36-878" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> PerformanceBenchmark</span>
<span id="cb36-879"><a href="#cb36-879" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-880"><a href="#cb36-880" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> OperationDuration <span class="op">=</span> </span>
<span id="cb36-881"><a href="#cb36-881" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"benchmark.operation.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-882"><a href="#cb36-882" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-883"><a href="#cb36-883" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> async Task<span class="op">&lt;</span>BenchmarkResult<span class="op">&gt;</span> BenchmarkAsync<span class="op">&lt;</span>T<span class="op">&gt;(</span></span>
<span id="cb36-884"><a href="#cb36-884" aria-hidden="true" tabindex="-1"></a>        <span class="dt">string</span> operationName<span class="op">,</span></span>
<span id="cb36-885"><a href="#cb36-885" aria-hidden="true" tabindex="-1"></a>        Func<span class="op">&lt;</span>Task<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> operation<span class="op">,</span></span>
<span id="cb36-886"><a href="#cb36-886" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> iterations <span class="op">=</span> <span class="dv">100</span><span class="op">)</span></span>
<span id="cb36-887"><a href="#cb36-887" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-888"><a href="#cb36-888" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> results <span class="op">=</span> <span class="kw">new</span> List<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;();</span></span>
<span id="cb36-889"><a href="#cb36-889" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> stopwatch <span class="op">=</span> <span class="kw">new</span> <span class="fu">Stopwatch</span><span class="op">();</span></span>
<span id="cb36-890"><a href="#cb36-890" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-891"><a href="#cb36-891" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Warmup</span></span>
<span id="cb36-892"><a href="#cb36-892" aria-hidden="true" tabindex="-1"></a>        <span class="kw">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb36-893"><a href="#cb36-893" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-894"><a href="#cb36-894" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb36-895"><a href="#cb36-895" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-896"><a href="#cb36-896" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-897"><a href="#cb36-897" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Actual benchmark</span></span>
<span id="cb36-898"><a href="#cb36-898" aria-hidden="true" tabindex="-1"></a>        <span class="kw">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> iterations<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb36-899"><a href="#cb36-899" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-900"><a href="#cb36-900" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Restart</span><span class="op">();</span></span>
<span id="cb36-901"><a href="#cb36-901" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb36-902"><a href="#cb36-902" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-903"><a href="#cb36-903" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-904"><a href="#cb36-904" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> duration <span class="op">=</span> stopwatch<span class="op">.</span><span class="fu">Elapsed</span><span class="op">.</span><span class="fu">TotalMilliseconds</span><span class="op">;</span></span>
<span id="cb36-905"><a href="#cb36-905" aria-hidden="true" tabindex="-1"></a>            results<span class="op">.</span><span class="fu">Add</span><span class="op">(</span>duration<span class="op">);</span></span>
<span id="cb36-906"><a href="#cb36-906" aria-hidden="true" tabindex="-1"></a>            OperationDuration<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>duration<span class="op">,</span> </span>
<span id="cb36-907"><a href="#cb36-907" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span> KeyValuePair<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">object</span><span class="op">&gt;(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">));</span></span>
<span id="cb36-908"><a href="#cb36-908" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-909"><a href="#cb36-909" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-910"><a href="#cb36-910" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> BenchmarkResult</span>
<span id="cb36-911"><a href="#cb36-911" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-912"><a href="#cb36-912" aria-hidden="true" tabindex="-1"></a>            OperationName <span class="op">=</span> operationName<span class="op">,</span></span>
<span id="cb36-913"><a href="#cb36-913" aria-hidden="true" tabindex="-1"></a>            Iterations <span class="op">=</span> iterations<span class="op">,</span></span>
<span id="cb36-914"><a href="#cb36-914" aria-hidden="true" tabindex="-1"></a>            MinDuration <span class="op">=</span> results<span class="op">.</span><span class="fu">Min</span><span class="op">(),</span></span>
<span id="cb36-915"><a href="#cb36-915" aria-hidden="true" tabindex="-1"></a>            MaxDuration <span class="op">=</span> results<span class="op">.</span><span class="fu">Max</span><span class="op">(),</span></span>
<span id="cb36-916"><a href="#cb36-916" aria-hidden="true" tabindex="-1"></a>            AverageDuration <span class="op">=</span> results<span class="op">.</span><span class="fu">Average</span><span class="op">(),</span></span>
<span id="cb36-917"><a href="#cb36-917" aria-hidden="true" tabindex="-1"></a>            MedianDuration <span class="op">=</span> results<span class="op">.</span><span class="fu">OrderBy</span><span class="op">(</span>x <span class="op">=&gt;</span> x<span class="op">).</span><span class="fu">Skip</span><span class="op">(</span>results<span class="op">.</span><span class="fu">Count</span> <span class="op">/</span> <span class="dv">2</span><span class="op">).</span><span class="fu">First</span><span class="op">(),</span></span>
<span id="cb36-918"><a href="#cb36-918" aria-hidden="true" tabindex="-1"></a>            P95Duration <span class="op">=</span> results<span class="op">.</span><span class="fu">OrderBy</span><span class="op">(</span>x <span class="op">=&gt;</span> x<span class="op">).</span><span class="fu">Skip</span><span class="op">((</span><span class="dt">int</span><span class="op">)(</span>results<span class="op">.</span><span class="fu">Count</span> <span class="op">*</span> <span class="fl">0.95</span><span class="op">)).</span><span class="fu">First</span><span class="op">(),</span></span>
<span id="cb36-919"><a href="#cb36-919" aria-hidden="true" tabindex="-1"></a>            P99Duration <span class="op">=</span> results<span class="op">.</span><span class="fu">OrderBy</span><span class="op">(</span>x <span class="op">=&gt;</span> x<span class="op">).</span><span class="fu">Skip</span><span class="op">((</span><span class="dt">int</span><span class="op">)(</span>results<span class="op">.</span><span class="fu">Count</span> <span class="op">*</span> <span class="fl">0.99</span><span class="op">)).</span><span class="fu">First</span><span class="op">()</span></span>
<span id="cb36-920"><a href="#cb36-920" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb36-921"><a href="#cb36-921" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-922"><a href="#cb36-922" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-923"><a href="#cb36-923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-924"><a href="#cb36-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-925"><a href="#cb36-925" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distributed Tracing</span></span>
<span id="cb36-926"><a href="#cb36-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-927"><a href="#cb36-927" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cross-Service Tracing</span></span>
<span id="cb36-928"><a href="#cb36-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-929"><a href="#cb36-929" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Automatic Context Propagation</span></span>
<span id="cb36-930"><a href="#cb36-930" aria-hidden="true" tabindex="-1"></a>**Seamless trace context flow** across service boundaries:</span>
<span id="cb36-931"><a href="#cb36-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-932"><a href="#cb36-932" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-933"><a href="#cb36-933" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> DistributedTracingExample</span>
<span id="cb36-934"><a href="#cb36-934" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-935"><a href="#cb36-935" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Service A - Initiates the request</span></span>
<span id="cb36-936"><a href="#cb36-936" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">class</span> OrderController <span class="op">:</span> ControllerBase</span>
<span id="cb36-937"><a href="#cb36-937" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-938"><a href="#cb36-938" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span> <span class="kw">readonly</span> IOrderService orderService<span class="op">;</span></span>
<span id="cb36-939"><a href="#cb36-939" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-940"><a href="#cb36-940" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="fu">HttpPost</span><span class="op">(</span><span class="st">"/orders"</span><span class="op">)]</span></span>
<span id="cb36-941"><a href="#cb36-941" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> async Task<span class="op">&lt;</span>IActionResult<span class="op">&gt;</span> <span class="fu">CreateOrder</span><span class="op">([</span>FromBody<span class="op">]</span> CreateOrderRequest request<span class="op">)</span></span>
<span id="cb36-942"><a href="#cb36-942" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-943"><a href="#cb36-943" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"CreateOrder"</span><span class="op">);</span></span>
<span id="cb36-944"><a href="#cb36-944" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.customer_id"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">CustomerId</span><span class="op">);</span></span>
<span id="cb36-945"><a href="#cb36-945" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-946"><a href="#cb36-946" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> order <span class="op">=</span> await orderService<span class="op">.</span><span class="fu">ProcessOrderAsync</span><span class="op">(</span>request<span class="op">);</span></span>
<span id="cb36-947"><a href="#cb36-947" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="fu">Ok</span><span class="op">(</span>order<span class="op">);</span></span>
<span id="cb36-948"><a href="#cb36-948" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-949"><a href="#cb36-949" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-950"><a href="#cb36-950" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-951"><a href="#cb36-951" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Service B - Processes inventory</span></span>
<span id="cb36-952"><a href="#cb36-952" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">class</span> InventoryService</span>
<span id="cb36-953"><a href="#cb36-953" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-954"><a href="#cb36-954" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span> <span class="kw">readonly</span> HttpClient httpClient<span class="op">;</span></span>
<span id="cb36-955"><a href="#cb36-955" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-956"><a href="#cb36-956" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> async Task<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;</span> <span class="fu">CheckInventoryAsync</span><span class="op">(</span>List<span class="op">&lt;</span>OrderItem<span class="op">&gt;</span> items<span class="op">)</span></span>
<span id="cb36-957"><a href="#cb36-957" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-958"><a href="#cb36-958" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"CheckInventory"</span><span class="op">);</span></span>
<span id="cb36-959"><a href="#cb36-959" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"inventory.item_count"</span><span class="op">,</span> items<span class="op">.</span><span class="fu">Count</span><span class="op">);</span></span>
<span id="cb36-960"><a href="#cb36-960" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-961"><a href="#cb36-961" aria-hidden="true" tabindex="-1"></a>            <span class="kw">foreach</span> <span class="op">(</span><span class="dt">var</span> item <span class="kw">in</span> items<span class="op">)</span></span>
<span id="cb36-962"><a href="#cb36-962" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-963"><a href="#cb36-963" aria-hidden="true" tabindex="-1"></a>                <span class="kw">using</span> <span class="dt">var</span> itemActivity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"CheckItem"</span><span class="op">);</span></span>
<span id="cb36-964"><a href="#cb36-964" aria-hidden="true" tabindex="-1"></a>                itemActivity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.sku"</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Sku</span><span class="op">);</span></span>
<span id="cb36-965"><a href="#cb36-965" aria-hidden="true" tabindex="-1"></a>                itemActivity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.quantity"</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">);</span></span>
<span id="cb36-966"><a href="#cb36-966" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-967"><a href="#cb36-967" aria-hidden="true" tabindex="-1"></a>                <span class="co">// HTTP call automatically propagates trace context</span></span>
<span id="cb36-968"><a href="#cb36-968" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> response <span class="op">=</span> await httpClient<span class="op">.</span><span class="fu">GetAsync</span><span class="op">(</span>$<span class="st">"/inventory/{item.Sku}"</span><span class="op">);</span></span>
<span id="cb36-969"><a href="#cb36-969" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> availability <span class="op">=</span> await response<span class="op">.</span><span class="fu">Content</span><span class="op">.</span><span class="fu">ReadFromJsonAsync</span><span class="op">&lt;</span>ItemAvailability<span class="op">&gt;();</span></span>
<span id="cb36-970"><a href="#cb36-970" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-971"><a href="#cb36-971" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> <span class="op">(</span>availability<span class="op">.</span><span class="fu">Available</span> <span class="op">&lt;</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">)</span></span>
<span id="cb36-972"><a href="#cb36-972" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb36-973"><a href="#cb36-973" aria-hidden="true" tabindex="-1"></a>                    itemActivity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"inventory.sufficient"</span><span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb36-974"><a href="#cb36-974" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb36-975"><a href="#cb36-975" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb36-976"><a href="#cb36-976" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-977"><a href="#cb36-977" aria-hidden="true" tabindex="-1"></a>                itemActivity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"inventory.sufficient"</span><span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb36-978"><a href="#cb36-978" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-979"><a href="#cb36-979" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-980"><a href="#cb36-980" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb36-981"><a href="#cb36-981" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-982"><a href="#cb36-982" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-983"><a href="#cb36-983" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-984"><a href="#cb36-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-985"><a href="#cb36-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-986"><a href="#cb36-986" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trace Sampling</span></span>
<span id="cb36-987"><a href="#cb36-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-988"><a href="#cb36-988" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Intelligent Sampling Strategies</span></span>
<span id="cb36-989"><a href="#cb36-989" aria-hidden="true" tabindex="-1"></a>**Optimized trace collection** for production environments:</span>
<span id="cb36-990"><a href="#cb36-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-991"><a href="#cb36-991" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-992"><a href="#cb36-992" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> TraceSamplingConfiguration</span>
<span id="cb36-993"><a href="#cb36-993" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-994"><a href="#cb36-994" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ConfigureSampling</span><span class="op">(</span>TracerProviderBuilder builder<span class="op">)</span></span>
<span id="cb36-995"><a href="#cb36-995" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-996"><a href="#cb36-996" aria-hidden="true" tabindex="-1"></a>        builder<span class="op">.</span><span class="fu">SetSampler</span><span class="op">(</span><span class="kw">new</span> <span class="fu">CompositeSampler</span><span class="op">(</span></span>
<span id="cb36-997"><a href="#cb36-997" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Always sample errors</span></span>
<span id="cb36-998"><a href="#cb36-998" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> <span class="fu">ErrorSampler</span><span class="op">(),</span></span>
<span id="cb36-999"><a href="#cb36-999" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1000"><a href="#cb36-1000" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Sample high-value operations</span></span>
<span id="cb36-1001"><a href="#cb36-1001" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> <span class="fu">OperationBasedSampler</span><span class="op">(</span><span class="kw">new</span> Dictionary<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">double</span><span class="op">&gt;</span></span>
<span id="cb36-1002"><a href="#cb36-1002" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-1003"><a href="#cb36-1003" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span> <span class="st">"ProcessPayment"</span><span class="op">,</span> <span class="fl">1.0</span> <span class="op">},</span>      <span class="co">// 100% sampling</span></span>
<span id="cb36-1004"><a href="#cb36-1004" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span> <span class="st">"ProcessOrder"</span><span class="op">,</span> <span class="fl">0.1</span> <span class="op">},</span>        <span class="co">// 10% sampling</span></span>
<span id="cb36-1005"><a href="#cb36-1005" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span> <span class="st">"GetProduct"</span><span class="op">,</span> <span class="fl">0.01</span> <span class="op">}</span>          <span class="co">// 1% sampling</span></span>
<span id="cb36-1006"><a href="#cb36-1006" aria-hidden="true" tabindex="-1"></a>            <span class="op">}),</span></span>
<span id="cb36-1007"><a href="#cb36-1007" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1008"><a href="#cb36-1008" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Rate-based sampling for remaining operations</span></span>
<span id="cb36-1009"><a href="#cb36-1009" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> <span class="fu">RateLimitingSampler</span><span class="op">(</span>maxTracesPerSecond<span class="op">:</span> <span class="dv">100</span><span class="op">)</span></span>
<span id="cb36-1010"><a href="#cb36-1010" aria-hidden="true" tabindex="-1"></a>        <span class="op">));</span></span>
<span id="cb36-1011"><a href="#cb36-1011" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1012"><a href="#cb36-1012" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1013"><a href="#cb36-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1014"><a href="#cb36-1014" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ErrorSampler <span class="op">:</span> Sampler</span>
<span id="cb36-1015"><a href="#cb36-1015" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1016"><a href="#cb36-1016" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">override</span> SamplingResult <span class="fu">ShouldSample</span><span class="op">(</span><span class="kw">in</span> SamplingParameters samplingParameters<span class="op">)</span></span>
<span id="cb36-1017"><a href="#cb36-1017" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1018"><a href="#cb36-1018" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Always sample traces that contain errors</span></span>
<span id="cb36-1019"><a href="#cb36-1019" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>samplingParameters<span class="op">.</span><span class="fu">Tags</span><span class="op">.</span><span class="fu">Any</span><span class="op">(</span>tag <span class="op">=&gt;</span> </span>
<span id="cb36-1020"><a href="#cb36-1020" aria-hidden="true" tabindex="-1"></a>            tag<span class="op">.</span><span class="fu">Key</span> <span class="op">==</span> <span class="st">"error"</span> <span class="op">||</span> tag<span class="op">.</span><span class="fu">Key</span> <span class="op">==</span> <span class="st">"exception"</span><span class="op">))</span></span>
<span id="cb36-1021"><a href="#cb36-1021" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1022"><a href="#cb36-1022" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> SamplingResult<span class="op">.</span><span class="fu">Create</span><span class="op">(</span>SamplingDecision<span class="op">.</span><span class="fu">RecordAndSample</span><span class="op">);</span></span>
<span id="cb36-1023"><a href="#cb36-1023" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1024"><a href="#cb36-1024" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1025"><a href="#cb36-1025" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> SamplingResult<span class="op">.</span><span class="fu">Create</span><span class="op">(</span>SamplingDecision<span class="op">.</span><span class="fu">Drop</span><span class="op">);</span></span>
<span id="cb36-1026"><a href="#cb36-1026" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1027"><a href="#cb36-1027" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1028"><a href="#cb36-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1029"><a href="#cb36-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1030"><a href="#cb36-1030" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trace Analysis</span></span>
<span id="cb36-1031"><a href="#cb36-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1032"><a href="#cb36-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Correlation and Root Cause Analysis</span></span>
<span id="cb36-1033"><a href="#cb36-1033" aria-hidden="true" tabindex="-1"></a>**Advanced trace analysis** capabilities:</span>
<span id="cb36-1034"><a href="#cb36-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1035"><a href="#cb36-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1036"><a href="#cb36-1036" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> TraceAnalyzer</span>
<span id="cb36-1037"><a href="#cb36-1037" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1038"><a href="#cb36-1038" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> TraceAnalysisResult <span class="fu">AnalyzeTrace</span><span class="op">(</span>TraceData trace<span class="op">)</span></span>
<span id="cb36-1039"><a href="#cb36-1039" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1040"><a href="#cb36-1040" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> spans <span class="op">=</span> trace<span class="op">.</span><span class="fu">Spans</span><span class="op">.</span><span class="fu">OrderBy</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">StartTime</span><span class="op">).</span><span class="fu">ToList</span><span class="op">();</span></span>
<span id="cb36-1041"><a href="#cb36-1041" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> rootSpan <span class="op">=</span> spans<span class="op">.</span><span class="fu">First</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">ParentSpanId</span> <span class="op">==</span> <span class="kw">null</span><span class="op">);</span></span>
<span id="cb36-1042"><a href="#cb36-1042" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1043"><a href="#cb36-1043" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> TraceAnalysisResult</span>
<span id="cb36-1044"><a href="#cb36-1044" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1045"><a href="#cb36-1045" aria-hidden="true" tabindex="-1"></a>            TraceId <span class="op">=</span> trace<span class="op">.</span><span class="fu">TraceId</span><span class="op">,</span></span>
<span id="cb36-1046"><a href="#cb36-1046" aria-hidden="true" tabindex="-1"></a>            TotalDuration <span class="op">=</span> rootSpan<span class="op">.</span><span class="fu">Duration</span><span class="op">,</span></span>
<span id="cb36-1047"><a href="#cb36-1047" aria-hidden="true" tabindex="-1"></a>            SpanCount <span class="op">=</span> spans<span class="op">.</span><span class="fu">Count</span><span class="op">,</span></span>
<span id="cb36-1048"><a href="#cb36-1048" aria-hidden="true" tabindex="-1"></a>            ServiceCount <span class="op">=</span> spans<span class="op">.</span><span class="fu">Select</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">ServiceName</span><span class="op">).</span><span class="fu">Distinct</span><span class="op">().</span><span class="fu">Count</span><span class="op">(),</span></span>
<span id="cb36-1049"><a href="#cb36-1049" aria-hidden="true" tabindex="-1"></a>            ErrorCount <span class="op">=</span> spans<span class="op">.</span><span class="fu">Count</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">Status</span> <span class="op">==</span> SpanStatus<span class="op">.</span><span class="fu">Error</span><span class="op">),</span></span>
<span id="cb36-1050"><a href="#cb36-1050" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1051"><a href="#cb36-1051" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Critical path analysis</span></span>
<span id="cb36-1052"><a href="#cb36-1052" aria-hidden="true" tabindex="-1"></a>            CriticalPath <span class="op">=</span> <span class="fu">CalculateCriticalPath</span><span class="op">(</span>spans<span class="op">),</span></span>
<span id="cb36-1053"><a href="#cb36-1053" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1054"><a href="#cb36-1054" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Service dependencies</span></span>
<span id="cb36-1055"><a href="#cb36-1055" aria-hidden="true" tabindex="-1"></a>            ServiceDependencies <span class="op">=</span> <span class="fu">BuildDependencyGraph</span><span class="op">(</span>spans<span class="op">),</span></span>
<span id="cb36-1056"><a href="#cb36-1056" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1057"><a href="#cb36-1057" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Performance bottlenecks</span></span>
<span id="cb36-1058"><a href="#cb36-1058" aria-hidden="true" tabindex="-1"></a>            Bottlenecks <span class="op">=</span> <span class="fu">IdentifyBottlenecks</span><span class="op">(</span>spans<span class="op">),</span></span>
<span id="cb36-1059"><a href="#cb36-1059" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1060"><a href="#cb36-1060" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Error propagation</span></span>
<span id="cb36-1061"><a href="#cb36-1061" aria-hidden="true" tabindex="-1"></a>            ErrorPropagation <span class="op">=</span> <span class="fu">TraceErrorPropagation</span><span class="op">(</span>spans<span class="op">)</span></span>
<span id="cb36-1062"><a href="#cb36-1062" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb36-1063"><a href="#cb36-1063" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1064"><a href="#cb36-1064" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1065"><a href="#cb36-1065" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> List<span class="op">&lt;</span>SpanSummary<span class="op">&gt;</span> <span class="fu">CalculateCriticalPath</span><span class="op">(</span>List<span class="op">&lt;</span>Span<span class="op">&gt;</span> spans<span class="op">)</span></span>
<span id="cb36-1066"><a href="#cb36-1066" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1067"><a href="#cb36-1067" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Identify the longest path through the trace</span></span>
<span id="cb36-1068"><a href="#cb36-1068" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> pathAnalysis <span class="op">=</span> <span class="kw">new</span> Dictionary<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> TimeSpan<span class="op">&gt;();</span></span>
<span id="cb36-1069"><a href="#cb36-1069" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1070"><a href="#cb36-1070" aria-hidden="true" tabindex="-1"></a>        <span class="kw">foreach</span> <span class="op">(</span><span class="dt">var</span> span <span class="kw">in</span> spans<span class="op">)</span></span>
<span id="cb36-1071"><a href="#cb36-1071" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1072"><a href="#cb36-1072" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> pathDuration <span class="op">=</span> span<span class="op">.</span><span class="fu">Duration</span><span class="op">;</span></span>
<span id="cb36-1073"><a href="#cb36-1073" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="op">(</span>span<span class="op">.</span><span class="fu">ParentSpanId</span> <span class="op">!=</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb36-1074"><a href="#cb36-1074" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-1075"><a href="#cb36-1075" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> parent <span class="op">=</span> spans<span class="op">.</span><span class="fu">First</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">SpanId</span> <span class="op">==</span> span<span class="op">.</span><span class="fu">ParentSpanId</span><span class="op">);</span></span>
<span id="cb36-1076"><a href="#cb36-1076" aria-hidden="true" tabindex="-1"></a>                pathDuration <span class="op">+=</span> pathAnalysis<span class="op">.</span><span class="fu">GetValueOrDefault</span><span class="op">(</span>parent<span class="op">.</span><span class="fu">SpanId</span><span class="op">,</span> TimeSpan<span class="op">.</span><span class="fu">Zero</span><span class="op">);</span></span>
<span id="cb36-1077"><a href="#cb36-1077" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-1078"><a href="#cb36-1078" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1079"><a href="#cb36-1079" aria-hidden="true" tabindex="-1"></a>            pathAnalysis<span class="op">[</span>span<span class="op">.</span><span class="fu">SpanId</span><span class="op">]</span> <span class="op">=</span> pathDuration<span class="op">;</span></span>
<span id="cb36-1080"><a href="#cb36-1080" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1081"><a href="#cb36-1081" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1082"><a href="#cb36-1082" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> spans<span class="op">.</span><span class="fu">Where</span><span class="op">(</span>s <span class="op">=&gt;</span> pathAnalysis<span class="op">[</span>s<span class="op">.</span><span class="fu">SpanId</span><span class="op">]</span> <span class="op">==</span> pathAnalysis<span class="op">.</span><span class="fu">Values</span><span class="op">.</span><span class="fu">Max</span><span class="op">())</span></span>
<span id="cb36-1083"><a href="#cb36-1083" aria-hidden="true" tabindex="-1"></a>                   <span class="op">.</span><span class="fu">Select</span><span class="op">(</span>s <span class="op">=&gt;</span> <span class="kw">new</span> <span class="fu">SpanSummary</span><span class="op">(</span>s<span class="op">))</span></span>
<span id="cb36-1084"><a href="#cb36-1084" aria-hidden="true" tabindex="-1"></a>                   <span class="op">.</span><span class="fu">ToList</span><span class="op">();</span></span>
<span id="cb36-1085"><a href="#cb36-1085" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1086"><a href="#cb36-1086" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1087"><a href="#cb36-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1088"><a href="#cb36-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1089"><a href="#cb36-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Practices and Implementation Patterns</span></span>
<span id="cb36-1090"><a href="#cb36-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1091"><a href="#cb36-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observability-First Development</span></span>
<span id="cb36-1092"><a href="#cb36-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1093"><a href="#cb36-1093" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Design Principles</span></span>
<span id="cb36-1094"><a href="#cb36-1094" aria-hidden="true" tabindex="-1"></a>**Building observability into the development process**:</span>
<span id="cb36-1095"><a href="#cb36-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1096"><a href="#cb36-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Instrument Early**: Add observability from the beginning of development</span>
<span id="cb36-1097"><a href="#cb36-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Semantic Consistency**: Use standardized naming conventions for metrics and traces</span>
<span id="cb36-1098"><a href="#cb36-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Context Propagation**: Ensure trace context flows through all operations</span>
<span id="cb36-1099"><a href="#cb36-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Error Visibility**: Make failures immediately observable and actionable</span>
<span id="cb36-1100"><a href="#cb36-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Performance Awareness**: Monitor performance characteristics continuously</span>
<span id="cb36-1101"><a href="#cb36-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1102"><a href="#cb36-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Implementation Pattern</span></span>
<span id="cb36-1103"><a href="#cb36-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1104"><a href="#cb36-1104" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ObservableService</span>
<span id="cb36-1105"><a href="#cb36-1105" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1106"><a href="#cb36-1106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb36-1107"><a href="#cb36-1107" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"MyApp.Services"</span><span class="op">,</span> <span class="st">"1.0.0"</span><span class="op">);</span></span>
<span id="cb36-1108"><a href="#cb36-1108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1109"><a href="#cb36-1109" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> OperationCounter <span class="op">=</span> </span>
<span id="cb36-1110"><a href="#cb36-1110" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"service.operations"</span><span class="op">);</span></span>
<span id="cb36-1111"><a href="#cb36-1111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1112"><a href="#cb36-1112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> OperationDuration <span class="op">=</span> </span>
<span id="cb36-1113"><a href="#cb36-1113" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"service.operation.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-1114"><a href="#cb36-1114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1115"><a href="#cb36-1115" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">readonly</span> ILogger<span class="op">&lt;</span>ObservableService<span class="op">&gt;</span> logger<span class="op">;</span></span>
<span id="cb36-1116"><a href="#cb36-1116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1117"><a href="#cb36-1117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>Result<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> ExecuteAsync<span class="op">&lt;</span>T<span class="op">&gt;(</span><span class="dt">string</span> operationName<span class="op">,</span> </span>
<span id="cb36-1118"><a href="#cb36-1118" aria-hidden="true" tabindex="-1"></a>                                                Func<span class="op">&lt;</span>Task<span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> operation<span class="op">)</span></span>
<span id="cb36-1119"><a href="#cb36-1119" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1120"><a href="#cb36-1120" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span>operationName<span class="op">);</span></span>
<span id="cb36-1121"><a href="#cb36-1121" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> stopwatch <span class="op">=</span> Stopwatch<span class="op">.</span><span class="fu">StartNew</span><span class="op">();</span></span>
<span id="cb36-1122"><a href="#cb36-1122" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1123"><a href="#cb36-1123" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb36-1124"><a href="#cb36-1124" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1125"><a href="#cb36-1125" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogInformation</span><span class="op">(</span><span class="st">"Starting operation {OperationName}"</span><span class="op">,</span> operationName<span class="op">);</span></span>
<span id="cb36-1126"><a href="#cb36-1126" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1127"><a href="#cb36-1127" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> result <span class="op">=</span> await <span class="fu">operation</span><span class="op">();</span></span>
<span id="cb36-1128"><a href="#cb36-1128" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1129"><a href="#cb36-1129" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-1130"><a href="#cb36-1130" aria-hidden="true" tabindex="-1"></a>            OperationCounter<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span><span class="op">(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">),</span> <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"success"</span><span class="op">));</span></span>
<span id="cb36-1131"><a href="#cb36-1131" aria-hidden="true" tabindex="-1"></a>            OperationDuration<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">,</span> <span class="kw">new</span><span class="op">(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">));</span></span>
<span id="cb36-1132"><a href="#cb36-1132" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1133"><a href="#cb36-1133" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Ok</span><span class="op">);</span></span>
<span id="cb36-1134"><a href="#cb36-1134" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogInformation</span><span class="op">(</span><span class="st">"Completed operation {OperationName} in {Duration}ms"</span><span class="op">,</span> </span>
<span id="cb36-1135"><a href="#cb36-1135" aria-hidden="true" tabindex="-1"></a>                                operationName<span class="op">,</span> stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb36-1136"><a href="#cb36-1136" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1137"><a href="#cb36-1137" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Result<span class="op">&lt;</span>T<span class="op">&gt;.</span><span class="fu">Success</span><span class="op">(</span>result<span class="op">);</span></span>
<span id="cb36-1138"><a href="#cb36-1138" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1139"><a href="#cb36-1139" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb36-1140"><a href="#cb36-1140" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1141"><a href="#cb36-1141" aria-hidden="true" tabindex="-1"></a>            stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-1142"><a href="#cb36-1142" aria-hidden="true" tabindex="-1"></a>            OperationCounter<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">new</span><span class="op">(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">),</span> <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"error"</span><span class="op">));</span></span>
<span id="cb36-1143"><a href="#cb36-1143" aria-hidden="true" tabindex="-1"></a>            OperationDuration<span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">,</span> <span class="kw">new</span><span class="op">(</span><span class="st">"operation"</span><span class="op">,</span> operationName<span class="op">));</span></span>
<span id="cb36-1144"><a href="#cb36-1144" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1145"><a href="#cb36-1145" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb36-1146"><a href="#cb36-1146" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"error.type"</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">GetType</span><span class="op">().</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb36-1147"><a href="#cb36-1147" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1148"><a href="#cb36-1148" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogError</span><span class="op">(</span>ex<span class="op">,</span> <span class="st">"Operation {OperationName} failed after {Duration}ms"</span><span class="op">,</span> </span>
<span id="cb36-1149"><a href="#cb36-1149" aria-hidden="true" tabindex="-1"></a>                          operationName<span class="op">,</span> stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">);</span></span>
<span id="cb36-1150"><a href="#cb36-1150" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1151"><a href="#cb36-1151" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Result<span class="op">&lt;</span>T<span class="op">&gt;.</span><span class="fu">Failure</span><span class="op">(</span>ex<span class="op">);</span></span>
<span id="cb36-1152"><a href="#cb36-1152" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1153"><a href="#cb36-1153" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1154"><a href="#cb36-1154" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1155"><a href="#cb36-1155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1156"><a href="#cb36-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1157"><a href="#cb36-1157" aria-hidden="true" tabindex="-1"></a><span class="fu">### Metric Design Patterns</span></span>
<span id="cb36-1158"><a href="#cb36-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1159"><a href="#cb36-1159" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Choosing the Right Metric Type</span></span>
<span id="cb36-1160"><a href="#cb36-1160" aria-hidden="true" tabindex="-1"></a>**Guidelines for metric selection**:</span>
<span id="cb36-1161"><a href="#cb36-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1162"><a href="#cb36-1162" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1163"><a href="#cb36-1163" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MetricDesignPatterns</span>
<span id="cb36-1164"><a href="#cb36-1164" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1165"><a href="#cb36-1165" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use COUNTERS for events that only increase</span></span>
<span id="cb36-1166"><a href="#cb36-1166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> RequestsReceived <span class="op">=</span> </span>
<span id="cb36-1167"><a href="#cb36-1167" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"http.requests.received"</span><span class="op">);</span></span>
<span id="cb36-1168"><a href="#cb36-1168" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1169"><a href="#cb36-1169" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use GAUGES for values that go up and down</span></span>
<span id="cb36-1170"><a href="#cb36-1170" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> ObservableGauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ActiveConnections <span class="op">=</span> </span>
<span id="cb36-1171"><a href="#cb36-1171" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateObservableGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"http.connections.active"</span><span class="op">,</span> GetActiveConnections<span class="op">);</span></span>
<span id="cb36-1172"><a href="#cb36-1172" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1173"><a href="#cb36-1173" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use HISTOGRAMS for distributions (latency, size, etc.)</span></span>
<span id="cb36-1174"><a href="#cb36-1174" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> RequestDuration <span class="op">=</span> </span>
<span id="cb36-1175"><a href="#cb36-1175" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"http.request.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-1176"><a href="#cb36-1176" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1177"><a href="#cb36-1177" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use UP/DOWN COUNTERS for values that can increase or decrease</span></span>
<span id="cb36-1178"><a href="#cb36-1178" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> UpDownCounter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> QueueDepth <span class="op">=</span> </span>
<span id="cb36-1179"><a href="#cb36-1179" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateUpDownCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"processing.queue.depth"</span><span class="op">);</span></span>
<span id="cb36-1180"><a href="#cb36-1180" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1181"><a href="#cb36-1181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="dt">int</span> <span class="fu">GetActiveConnections</span><span class="op">()</span></span>
<span id="cb36-1182"><a href="#cb36-1182" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1183"><a href="#cb36-1183" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Return current active connection count</span></span>
<span id="cb36-1184"><a href="#cb36-1184" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> ConnectionManager<span class="op">.</span><span class="fu">GetActiveConnectionCount</span><span class="op">();</span></span>
<span id="cb36-1185"><a href="#cb36-1185" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1186"><a href="#cb36-1186" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1187"><a href="#cb36-1187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1188"><a href="#cb36-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1189"><a href="#cb36-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">### Alerting and SLO/SLI Definition</span></span>
<span id="cb36-1190"><a href="#cb36-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1191"><a href="#cb36-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Service Level Objectives</span></span>
<span id="cb36-1192"><a href="#cb36-1192" aria-hidden="true" tabindex="-1"></a>**Defining measurable reliability targets**:</span>
<span id="cb36-1193"><a href="#cb36-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1194"><a href="#cb36-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1195"><a href="#cb36-1195" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ServiceLevelObjectives</span>
<span id="cb36-1196"><a href="#cb36-1196" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1197"><a href="#cb36-1197" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SLI: Request success rate</span></span>
<span id="cb36-1198"><a href="#cb36-1198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> SuccessfulRequests <span class="op">=</span> </span>
<span id="cb36-1199"><a href="#cb36-1199" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"sli.requests.successful"</span><span class="op">);</span></span>
<span id="cb36-1200"><a href="#cb36-1200" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1201"><a href="#cb36-1201" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> FailedRequests <span class="op">=</span> </span>
<span id="cb36-1202"><a href="#cb36-1202" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"sli.requests.failed"</span><span class="op">);</span></span>
<span id="cb36-1203"><a href="#cb36-1203" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1204"><a href="#cb36-1204" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SLI: Request latency</span></span>
<span id="cb36-1205"><a href="#cb36-1205" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> RequestLatency <span class="op">=</span> </span>
<span id="cb36-1206"><a href="#cb36-1206" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"sli.request.latency_ms"</span><span class="op">);</span></span>
<span id="cb36-1207"><a href="#cb36-1207" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1208"><a href="#cb36-1208" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SLO: 99.9% of requests succeed</span></span>
<span id="cb36-1209"><a href="#cb36-1209" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">double</span> SuccessRate <span class="op">=&gt;</span> </span>
<span id="cb36-1210"><a href="#cb36-1210" aria-hidden="true" tabindex="-1"></a>        SuccessfulRequests<span class="op">.</span><span class="fu">Value</span> <span class="op">/</span> <span class="op">(</span><span class="dt">double</span><span class="op">)(</span>SuccessfulRequests<span class="op">.</span><span class="fu">Value</span> <span class="op">+</span> FailedRequests<span class="op">.</span><span class="fu">Value</span><span class="op">);</span></span>
<span id="cb36-1211"><a href="#cb36-1211" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1212"><a href="#cb36-1212" aria-hidden="true" tabindex="-1"></a>    <span class="co">// SLO: 95% of requests complete within 200ms</span></span>
<span id="cb36-1213"><a href="#cb36-1213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">bool</span> LatencySloMet <span class="op">=&gt;</span> </span>
<span id="cb36-1214"><a href="#cb36-1214" aria-hidden="true" tabindex="-1"></a>        RequestLatency<span class="op">.</span><span class="fu">GetPercentile</span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span> <span class="op">&lt;</span> <span class="dv">200</span><span class="op">;</span></span>
<span id="cb36-1215"><a href="#cb36-1215" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1216"><a href="#cb36-1216" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Error budget calculation</span></span>
<span id="cb36-1217"><a href="#cb36-1217" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">double</span> ErrorBudget <span class="op">=&gt;</span> <span class="fl">1.0</span> <span class="op">-</span> SuccessRate<span class="op">;</span></span>
<span id="cb36-1218"><a href="#cb36-1218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">bool</span> ErrorBudgetExhausted <span class="op">=&gt;</span> ErrorBudget <span class="op">&gt;</span> <span class="fl">0.001</span><span class="op">;</span> <span class="co">// 0.1% error budget</span></span>
<span id="cb36-1219"><a href="#cb36-1219" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1220"><a href="#cb36-1220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1221"><a href="#cb36-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1222"><a href="#cb36-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">## Real-World Scenarios</span></span>
<span id="cb36-1223"><a href="#cb36-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1224"><a href="#cb36-1224" aria-hidden="true" tabindex="-1"></a><span class="fu">### E-Commerce Application Observability</span></span>
<span id="cb36-1225"><a href="#cb36-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1226"><a href="#cb36-1226" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Complete Observability Implementation</span></span>
<span id="cb36-1227"><a href="#cb36-1227" aria-hidden="true" tabindex="-1"></a>**End-to-end monitoring** for a production e-commerce system:</span>
<span id="cb36-1228"><a href="#cb36-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1229"><a href="#cb36-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1230"><a href="#cb36-1230" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ECommerceObservability</span>
<span id="cb36-1231"><a href="#cb36-1231" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1232"><a href="#cb36-1232" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Business metrics</span></span>
<span id="cb36-1233"><a href="#cb36-1233" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> OrdersPlaced <span class="op">=</span> </span>
<span id="cb36-1234"><a href="#cb36-1234" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"business.orders.placed"</span><span class="op">);</span></span>
<span id="cb36-1235"><a href="#cb36-1235" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1236"><a href="#cb36-1236" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">decimal</span><span class="op">&gt;</span> OrderValue <span class="op">=</span> </span>
<span id="cb36-1237"><a href="#cb36-1237" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">decimal</span><span class="op">&gt;(</span><span class="st">"business.order.value"</span><span class="op">);</span></span>
<span id="cb36-1238"><a href="#cb36-1238" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1239"><a href="#cb36-1239" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> PaymentAttempts <span class="op">=</span> </span>
<span id="cb36-1240"><a href="#cb36-1240" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"business.payment.attempts"</span><span class="op">);</span></span>
<span id="cb36-1241"><a href="#cb36-1241" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1242"><a href="#cb36-1242" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Infrastructure metrics</span></span>
<span id="cb36-1243"><a href="#cb36-1243" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> InventoryLevels <span class="op">=</span> </span>
<span id="cb36-1244"><a href="#cb36-1244" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"inventory.levels"</span><span class="op">);</span></span>
<span id="cb36-1245"><a href="#cb36-1245" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1246"><a href="#cb36-1246" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> DatabaseQueryTime <span class="op">=</span> </span>
<span id="cb36-1247"><a href="#cb36-1247" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"database.query.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-1248"><a href="#cb36-1248" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1249"><a href="#cb36-1249" aria-hidden="true" tabindex="-1"></a>    <span class="co">// User experience metrics</span></span>
<span id="cb36-1250"><a href="#cb36-1250" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> PageLoadTime <span class="op">=</span> </span>
<span id="cb36-1251"><a href="#cb36-1251" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"frontend.page.load_time_ms"</span><span class="op">);</span></span>
<span id="cb36-1252"><a href="#cb36-1252" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1253"><a href="#cb36-1253" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> UserSessions <span class="op">=</span> </span>
<span id="cb36-1254"><a href="#cb36-1254" aria-hidden="true" tabindex="-1"></a>        Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"user.sessions.started"</span><span class="op">);</span></span>
<span id="cb36-1255"><a href="#cb36-1255" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1256"><a href="#cb36-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1257"><a href="#cb36-1257" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> OrderProcessingObservability</span>
<span id="cb36-1258"><a href="#cb36-1258" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1259"><a href="#cb36-1259" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">readonly</span> ActivitySource ActivitySource <span class="op">=</span> </span>
<span id="cb36-1260"><a href="#cb36-1260" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span><span class="op">(</span><span class="st">"ECommerce.OrderProcessing"</span><span class="op">);</span></span>
<span id="cb36-1261"><a href="#cb36-1261" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1262"><a href="#cb36-1262" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> async Task<span class="op">&lt;</span>OrderResult<span class="op">&gt;</span> <span class="fu">ProcessOrderAsync</span><span class="op">(</span>CreateOrderRequest request<span class="op">)</span></span>
<span id="cb36-1263"><a href="#cb36-1263" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1264"><a href="#cb36-1264" aria-hidden="true" tabindex="-1"></a>        <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessOrder"</span><span class="op">);</span></span>
<span id="cb36-1265"><a href="#cb36-1265" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.customer_id"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">CustomerId</span><span class="op">);</span></span>
<span id="cb36-1266"><a href="#cb36-1266" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.item_count"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">Items</span><span class="op">.</span><span class="fu">Count</span><span class="op">);</span></span>
<span id="cb36-1267"><a href="#cb36-1267" aria-hidden="true" tabindex="-1"></a>        activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"order.total_value"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">TotalAmount</span><span class="op">);</span></span>
<span id="cb36-1268"><a href="#cb36-1268" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1269"><a href="#cb36-1269" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb36-1270"><a href="#cb36-1270" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1271"><a href="#cb36-1271" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Validate inventory with detailed tracing</span></span>
<span id="cb36-1272"><a href="#cb36-1272" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> inventorySpan <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ValidateInventory"</span><span class="op">);</span></span>
<span id="cb36-1273"><a href="#cb36-1273" aria-hidden="true" tabindex="-1"></a>            <span class="kw">foreach</span> <span class="op">(</span><span class="dt">var</span> item <span class="kw">in</span> request<span class="op">.</span><span class="fu">Items</span><span class="op">)</span></span>
<span id="cb36-1274"><a href="#cb36-1274" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-1275"><a href="#cb36-1275" aria-hidden="true" tabindex="-1"></a>                <span class="kw">using</span> <span class="dt">var</span> itemSpan <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ValidateItem"</span><span class="op">);</span></span>
<span id="cb36-1276"><a href="#cb36-1276" aria-hidden="true" tabindex="-1"></a>                itemSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.sku"</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Sku</span><span class="op">);</span></span>
<span id="cb36-1277"><a href="#cb36-1277" aria-hidden="true" tabindex="-1"></a>                itemSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.requested_quantity"</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">);</span></span>
<span id="cb36-1278"><a href="#cb36-1278" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1279"><a href="#cb36-1279" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> availability <span class="op">=</span> await <span class="fu">CheckItemAvailabilityAsync</span><span class="op">(</span>item<span class="op">.</span><span class="fu">Sku</span><span class="op">);</span></span>
<span id="cb36-1280"><a href="#cb36-1280" aria-hidden="true" tabindex="-1"></a>                itemSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"item.available_quantity"</span><span class="op">,</span> availability<span class="op">.</span><span class="fu">Quantity</span><span class="op">);</span></span>
<span id="cb36-1281"><a href="#cb36-1281" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1282"><a href="#cb36-1282" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> <span class="op">(</span>availability<span class="op">.</span><span class="fu">Quantity</span> <span class="op">&lt;</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">)</span></span>
<span id="cb36-1283"><a href="#cb36-1283" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb36-1284"><a href="#cb36-1284" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">InsufficientInventoryException</span><span class="op">(</span>item<span class="op">.</span><span class="fu">Sku</span><span class="op">,</span> item<span class="op">.</span><span class="fu">Quantity</span><span class="op">,</span> availability<span class="op">.</span><span class="fu">Quantity</span><span class="op">);</span></span>
<span id="cb36-1285"><a href="#cb36-1285" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb36-1286"><a href="#cb36-1286" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-1287"><a href="#cb36-1287" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1288"><a href="#cb36-1288" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Process payment with error handling</span></span>
<span id="cb36-1289"><a href="#cb36-1289" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> paymentSpan <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ProcessPayment"</span><span class="op">);</span></span>
<span id="cb36-1290"><a href="#cb36-1290" aria-hidden="true" tabindex="-1"></a>            paymentSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"payment.amount"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">TotalAmount</span><span class="op">);</span></span>
<span id="cb36-1291"><a href="#cb36-1291" aria-hidden="true" tabindex="-1"></a>            paymentSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"payment.method"</span><span class="op">,</span> request<span class="op">.</span><span class="fu">PaymentMethod</span><span class="op">);</span></span>
<span id="cb36-1292"><a href="#cb36-1292" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1293"><a href="#cb36-1293" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> paymentResult <span class="op">=</span> await <span class="fu">ProcessPaymentAsync</span><span class="op">(</span>request<span class="op">.</span><span class="fu">Payment</span><span class="op">);</span></span>
<span id="cb36-1294"><a href="#cb36-1294" aria-hidden="true" tabindex="-1"></a>            paymentSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"payment.transaction_id"</span><span class="op">,</span> paymentResult<span class="op">.</span><span class="fu">TransactionId</span><span class="op">);</span></span>
<span id="cb36-1295"><a href="#cb36-1295" aria-hidden="true" tabindex="-1"></a>            paymentSpan<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"payment.status"</span><span class="op">,</span> paymentResult<span class="op">.</span><span class="fu">Status</span><span class="op">);</span></span>
<span id="cb36-1296"><a href="#cb36-1296" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1297"><a href="#cb36-1297" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Update inventory</span></span>
<span id="cb36-1298"><a href="#cb36-1298" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> updateSpan <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"UpdateInventory"</span><span class="op">);</span></span>
<span id="cb36-1299"><a href="#cb36-1299" aria-hidden="true" tabindex="-1"></a>            await <span class="fu">UpdateInventoryAsync</span><span class="op">(</span>request<span class="op">.</span><span class="fu">Items</span><span class="op">);</span></span>
<span id="cb36-1300"><a href="#cb36-1300" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1301"><a href="#cb36-1301" aria-hidden="true" tabindex="-1"></a>            ECommerceObservability<span class="op">.</span><span class="fu">OrdersPlaced</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> </span>
<span id="cb36-1302"><a href="#cb36-1302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span><span class="op">(</span><span class="st">"customer_segment"</span><span class="op">,</span> <span class="fu">GetCustomerSegment</span><span class="op">(</span>request<span class="op">.</span><span class="fu">CustomerId</span><span class="op">)));</span></span>
<span id="cb36-1303"><a href="#cb36-1303" aria-hidden="true" tabindex="-1"></a>            ECommerceObservability<span class="op">.</span><span class="fu">OrderValue</span><span class="op">.</span><span class="fu">Record</span><span class="op">((</span><span class="dt">double</span><span class="op">)</span>request<span class="op">.</span><span class="fu">TotalAmount</span><span class="op">);</span></span>
<span id="cb36-1304"><a href="#cb36-1304" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1305"><a href="#cb36-1305" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Ok</span><span class="op">);</span></span>
<span id="cb36-1306"><a href="#cb36-1306" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> OrderResult<span class="op">.</span><span class="fu">Success</span><span class="op">(</span>paymentResult<span class="op">.</span><span class="fu">TransactionId</span><span class="op">);</span></span>
<span id="cb36-1307"><a href="#cb36-1307" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1308"><a href="#cb36-1308" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb36-1309"><a href="#cb36-1309" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1310"><a href="#cb36-1310" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb36-1311"><a href="#cb36-1311" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"error.type"</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">GetType</span><span class="op">().</span><span class="fu">Name</span><span class="op">);</span></span>
<span id="cb36-1312"><a href="#cb36-1312" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1313"><a href="#cb36-1313" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Increment error metrics</span></span>
<span id="cb36-1314"><a href="#cb36-1314" aria-hidden="true" tabindex="-1"></a>            ECommerceObservability<span class="op">.</span><span class="fu">OrdersPlaced</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> </span>
<span id="cb36-1315"><a href="#cb36-1315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"failed"</span><span class="op">),</span> </span>
<span id="cb36-1316"><a href="#cb36-1316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span><span class="op">(</span><span class="st">"error_type"</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">GetType</span><span class="op">().</span><span class="fu">Name</span><span class="op">));</span></span>
<span id="cb36-1317"><a href="#cb36-1317" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1318"><a href="#cb36-1318" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb36-1319"><a href="#cb36-1319" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1320"><a href="#cb36-1320" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1321"><a href="#cb36-1321" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1322"><a href="#cb36-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1323"><a href="#cb36-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1324"><a href="#cb36-1324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Microservices Communication Monitoring</span></span>
<span id="cb36-1325"><a href="#cb36-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1326"><a href="#cb36-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Service Mesh Observability</span></span>
<span id="cb36-1327"><a href="#cb36-1327" aria-hidden="true" tabindex="-1"></a>**Complete inter-service monitoring**:</span>
<span id="cb36-1328"><a href="#cb36-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1329"><a href="#cb36-1329" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1330"><a href="#cb36-1330" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MicroservicesCommunication</span>
<span id="cb36-1331"><a href="#cb36-1331" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1332"><a href="#cb36-1332" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">class</span> ServiceMeshMetrics</span>
<span id="cb36-1333"><a href="#cb36-1333" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1334"><a href="#cb36-1334" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Service-to-service communication</span></span>
<span id="cb36-1335"><a href="#cb36-1335" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ServiceRequests <span class="op">=</span> </span>
<span id="cb36-1336"><a href="#cb36-1336" aria-hidden="true" tabindex="-1"></a>            Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"service.requests"</span><span class="op">);</span></span>
<span id="cb36-1337"><a href="#cb36-1337" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1338"><a href="#cb36-1338" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Histogram<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> ServiceLatency <span class="op">=</span> </span>
<span id="cb36-1339"><a href="#cb36-1339" aria-hidden="true" tabindex="-1"></a>            Meter<span class="op">.</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"service.request.duration_ms"</span><span class="op">);</span></span>
<span id="cb36-1340"><a href="#cb36-1340" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1341"><a href="#cb36-1341" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Circuit breaker metrics</span></span>
<span id="cb36-1342"><a href="#cb36-1342" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Gauge<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> CircuitBreakerState <span class="op">=</span> </span>
<span id="cb36-1343"><a href="#cb36-1343" aria-hidden="true" tabindex="-1"></a>            Meter<span class="op">.</span><span class="fu">CreateGauge</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"circuit_breaker.state"</span><span class="op">);</span></span>
<span id="cb36-1344"><a href="#cb36-1344" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1345"><a href="#cb36-1345" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Retry metrics</span></span>
<span id="cb36-1346"><a href="#cb36-1346" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> Counter<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> RetryAttempts <span class="op">=</span> </span>
<span id="cb36-1347"><a href="#cb36-1347" aria-hidden="true" tabindex="-1"></a>            Meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"service.retry.attempts"</span><span class="op">);</span></span>
<span id="cb36-1348"><a href="#cb36-1348" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1349"><a href="#cb36-1349" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1350"><a href="#cb36-1350" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">class</span> ResilientHttpClient</span>
<span id="cb36-1351"><a href="#cb36-1351" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1352"><a href="#cb36-1352" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span> <span class="kw">readonly</span> HttpClient httpClient<span class="op">;</span></span>
<span id="cb36-1353"><a href="#cb36-1353" aria-hidden="true" tabindex="-1"></a>        <span class="kw">private</span> <span class="kw">readonly</span> CircuitBreakerService circuitBreaker<span class="op">;</span></span>
<span id="cb36-1354"><a href="#cb36-1354" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1355"><a href="#cb36-1355" aria-hidden="true" tabindex="-1"></a>        <span class="kw">public</span> async Task<span class="op">&lt;</span>T<span class="op">&gt;</span> CallServiceAsync<span class="op">&lt;</span>T<span class="op">&gt;(</span><span class="dt">string</span> serviceName<span class="op">,</span> <span class="dt">string</span> endpoint<span class="op">)</span></span>
<span id="cb36-1356"><a href="#cb36-1356" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1357"><a href="#cb36-1357" aria-hidden="true" tabindex="-1"></a>            <span class="kw">using</span> <span class="dt">var</span> activity <span class="op">=</span> ActivitySource<span class="op">.</span><span class="fu">StartActivity</span><span class="op">(</span><span class="st">"ServiceCall"</span><span class="op">);</span></span>
<span id="cb36-1358"><a href="#cb36-1358" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"service.name"</span><span class="op">,</span> serviceName<span class="op">);</span></span>
<span id="cb36-1359"><a href="#cb36-1359" aria-hidden="true" tabindex="-1"></a>            activity<span class="op">?.</span><span class="fu">SetTag</span><span class="op">(</span><span class="st">"service.endpoint"</span><span class="op">,</span> endpoint<span class="op">);</span></span>
<span id="cb36-1360"><a href="#cb36-1360" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1361"><a href="#cb36-1361" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var</span> stopwatch <span class="op">=</span> Stopwatch<span class="op">.</span><span class="fu">StartNew</span><span class="op">();</span></span>
<span id="cb36-1362"><a href="#cb36-1362" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb36-1363"><a href="#cb36-1363" aria-hidden="true" tabindex="-1"></a>            <span class="kw">try</span></span>
<span id="cb36-1364"><a href="#cb36-1364" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-1365"><a href="#cb36-1365" aria-hidden="true" tabindex="-1"></a>                <span class="dt">var</span> response <span class="op">=</span> await circuitBreaker<span class="op">.</span><span class="fu">ExecuteAsync</span><span class="op">(</span><span class="fu">async</span> <span class="op">()</span> <span class="op">=&gt;</span></span>
<span id="cb36-1366"><a href="#cb36-1366" aria-hidden="true" tabindex="-1"></a>                <span class="op">{</span></span>
<span id="cb36-1367"><a href="#cb36-1367" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">return</span> await httpClient<span class="op">.</span><span class="fu">GetAsync</span><span class="op">(</span>$<span class="st">"{serviceName}{endpoint}"</span><span class="op">);</span></span>
<span id="cb36-1368"><a href="#cb36-1368" aria-hidden="true" tabindex="-1"></a>                <span class="op">});</span></span>
<span id="cb36-1369"><a href="#cb36-1369" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1370"><a href="#cb36-1370" aria-hidden="true" tabindex="-1"></a>                stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-1371"><a href="#cb36-1371" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1372"><a href="#cb36-1372" aria-hidden="true" tabindex="-1"></a>                ServiceMeshMetrics<span class="op">.</span><span class="fu">ServiceRequests</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> </span>
<span id="cb36-1373"><a href="#cb36-1373" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"source_service"</span><span class="op">,</span> <span class="st">"current"</span><span class="op">),</span></span>
<span id="cb36-1374"><a href="#cb36-1374" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"target_service"</span><span class="op">,</span> serviceName<span class="op">),</span></span>
<span id="cb36-1375"><a href="#cb36-1375" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"success"</span><span class="op">));</span></span>
<span id="cb36-1376"><a href="#cb36-1376" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1377"><a href="#cb36-1377" aria-hidden="true" tabindex="-1"></a>                ServiceMeshMetrics<span class="op">.</span><span class="fu">ServiceLatency</span><span class="op">.</span><span class="fu">Record</span><span class="op">(</span>stopwatch<span class="op">.</span><span class="fu">ElapsedMilliseconds</span><span class="op">,</span></span>
<span id="cb36-1378"><a href="#cb36-1378" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"source_service"</span><span class="op">,</span> <span class="st">"current"</span><span class="op">),</span></span>
<span id="cb36-1379"><a href="#cb36-1379" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"target_service"</span><span class="op">,</span> serviceName<span class="op">));</span></span>
<span id="cb36-1380"><a href="#cb36-1380" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1381"><a href="#cb36-1381" aria-hidden="true" tabindex="-1"></a>                <span class="kw">return</span> await response<span class="op">.</span><span class="fu">Content</span><span class="op">.</span><span class="fu">ReadFromJsonAsync</span><span class="op">&lt;</span>T<span class="op">&gt;();</span></span>
<span id="cb36-1382"><a href="#cb36-1382" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-1383"><a href="#cb36-1383" aria-hidden="true" tabindex="-1"></a>            <span class="kw">catch</span> <span class="op">(</span>CircuitBreakerOpenException<span class="op">)</span></span>
<span id="cb36-1384"><a href="#cb36-1384" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-1385"><a href="#cb36-1385" aria-hidden="true" tabindex="-1"></a>                ServiceMeshMetrics<span class="op">.</span><span class="fu">ServiceRequests</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb36-1386"><a href="#cb36-1386" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"source_service"</span><span class="op">,</span> <span class="st">"current"</span><span class="op">),</span></span>
<span id="cb36-1387"><a href="#cb36-1387" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"target_service"</span><span class="op">,</span> serviceName<span class="op">),</span></span>
<span id="cb36-1388"><a href="#cb36-1388" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"circuit_breaker_open"</span><span class="op">));</span></span>
<span id="cb36-1389"><a href="#cb36-1389" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1390"><a href="#cb36-1390" aria-hidden="true" tabindex="-1"></a>                <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb36-1391"><a href="#cb36-1391" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-1392"><a href="#cb36-1392" aria-hidden="true" tabindex="-1"></a>            <span class="kw">catch</span> <span class="op">(</span>Exception ex<span class="op">)</span></span>
<span id="cb36-1393"><a href="#cb36-1393" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb36-1394"><a href="#cb36-1394" aria-hidden="true" tabindex="-1"></a>                stopwatch<span class="op">.</span><span class="fu">Stop</span><span class="op">();</span></span>
<span id="cb36-1395"><a href="#cb36-1395" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1396"><a href="#cb36-1396" aria-hidden="true" tabindex="-1"></a>                ServiceMeshMetrics<span class="op">.</span><span class="fu">ServiceRequests</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span></span>
<span id="cb36-1397"><a href="#cb36-1397" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"source_service"</span><span class="op">,</span> <span class="st">"current"</span><span class="op">),</span></span>
<span id="cb36-1398"><a href="#cb36-1398" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"target_service"</span><span class="op">,</span> serviceName<span class="op">),</span></span>
<span id="cb36-1399"><a href="#cb36-1399" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span><span class="op">(</span><span class="st">"status"</span><span class="op">,</span> <span class="st">"error"</span><span class="op">));</span></span>
<span id="cb36-1400"><a href="#cb36-1400" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb36-1401"><a href="#cb36-1401" aria-hidden="true" tabindex="-1"></a>                activity<span class="op">?.</span><span class="fu">SetStatus</span><span class="op">(</span>ActivityStatusCode<span class="op">.</span><span class="fu">Error</span><span class="op">,</span> ex<span class="op">.</span><span class="fu">Message</span><span class="op">);</span></span>
<span id="cb36-1402"><a href="#cb36-1402" aria-hidden="true" tabindex="-1"></a>                <span class="kw">throw</span><span class="op">;</span></span>
<span id="cb36-1403"><a href="#cb36-1403" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb36-1404"><a href="#cb36-1404" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1405"><a href="#cb36-1405" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1406"><a href="#cb36-1406" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1407"><a href="#cb36-1407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1408"><a href="#cb36-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1409"><a href="#cb36-1409" aria-hidden="true" tabindex="-1"></a><span class="fu">## Troubleshooting and Debugging</span></span>
<span id="cb36-1410"><a href="#cb36-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1411"><a href="#cb36-1411" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common Observability Issues</span></span>
<span id="cb36-1412"><a href="#cb36-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1413"><a href="#cb36-1413" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Missing Traces</span></span>
<span id="cb36-1414"><a href="#cb36-1414" aria-hidden="true" tabindex="-1"></a>**Debugging trace propagation problems**:</span>
<span id="cb36-1415"><a href="#cb36-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1416"><a href="#cb36-1416" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1417"><a href="#cb36-1417" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> TracePropagationDebugging</span>
<span id="cb36-1418"><a href="#cb36-1418" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1419"><a href="#cb36-1419" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ValidateTraceContext</span><span class="op">(</span>HttpContext context<span class="op">)</span></span>
<span id="cb36-1420"><a href="#cb36-1420" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1421"><a href="#cb36-1421" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> traceParent <span class="op">=</span> context<span class="op">.</span><span class="fu">Request</span><span class="op">.</span><span class="fu">Headers</span><span class="op">[</span><span class="st">"traceparent"</span><span class="op">].</span><span class="fu">FirstOrDefault</span><span class="op">();</span></span>
<span id="cb36-1422"><a href="#cb36-1422" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> traceState <span class="op">=</span> context<span class="op">.</span><span class="fu">Request</span><span class="op">.</span><span class="fu">Headers</span><span class="op">[</span><span class="st">"tracestate"</span><span class="op">].</span><span class="fu">FirstOrDefault</span><span class="op">();</span></span>
<span id="cb36-1423"><a href="#cb36-1423" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1424"><a href="#cb36-1424" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span><span class="dt">string</span><span class="op">.</span><span class="fu">IsNullOrEmpty</span><span class="op">(</span>traceParent<span class="op">))</span></span>
<span id="cb36-1425"><a href="#cb36-1425" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1426"><a href="#cb36-1426" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogWarning</span><span class="op">(</span><span class="st">"No trace context found in request headers"</span><span class="op">);</span></span>
<span id="cb36-1427"><a href="#cb36-1427" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1428"><a href="#cb36-1428" aria-hidden="true" tabindex="-1"></a>        <span class="kw">else</span></span>
<span id="cb36-1429"><a href="#cb36-1429" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1430"><a href="#cb36-1430" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogDebug</span><span class="op">(</span><span class="st">"Trace context: {TraceParent}, State: {TraceState}"</span><span class="op">,</span> </span>
<span id="cb36-1431"><a href="#cb36-1431" aria-hidden="true" tabindex="-1"></a>                          traceParent<span class="op">,</span> traceState<span class="op">);</span></span>
<span id="cb36-1432"><a href="#cb36-1432" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1433"><a href="#cb36-1433" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1434"><a href="#cb36-1434" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate current activity</span></span>
<span id="cb36-1435"><a href="#cb36-1435" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> currentActivity <span class="op">=</span> Activity<span class="op">.</span><span class="fu">Current</span><span class="op">;</span></span>
<span id="cb36-1436"><a href="#cb36-1436" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>currentActivity <span class="op">==</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb36-1437"><a href="#cb36-1437" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1438"><a href="#cb36-1438" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogError</span><span class="op">(</span><span class="st">"No current activity found - trace propagation may be broken"</span><span class="op">);</span></span>
<span id="cb36-1439"><a href="#cb36-1439" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1440"><a href="#cb36-1440" aria-hidden="true" tabindex="-1"></a>        <span class="kw">else</span></span>
<span id="cb36-1441"><a href="#cb36-1441" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1442"><a href="#cb36-1442" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogDebug</span><span class="op">(</span><span class="st">"Current activity: {ActivityId}, Parent: {ParentId}"</span><span class="op">,</span> </span>
<span id="cb36-1443"><a href="#cb36-1443" aria-hidden="true" tabindex="-1"></a>                          currentActivity<span class="op">.</span><span class="fu">Id</span><span class="op">,</span> currentActivity<span class="op">.</span><span class="fu">ParentId</span><span class="op">);</span></span>
<span id="cb36-1444"><a href="#cb36-1444" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1445"><a href="#cb36-1445" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1446"><a href="#cb36-1446" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1447"><a href="#cb36-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1448"><a href="#cb36-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1449"><a href="#cb36-1449" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Metric Collection Issues</span></span>
<span id="cb36-1450"><a href="#cb36-1450" aria-hidden="true" tabindex="-1"></a>**Diagnosing missing or incorrect metrics**:</span>
<span id="cb36-1451"><a href="#cb36-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1452"><a href="#cb36-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1453"><a href="#cb36-1453" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> MetricsDiagnostics</span>
<span id="cb36-1454"><a href="#cb36-1454" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1455"><a href="#cb36-1455" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">ValidateMetricsCollection</span><span class="op">()</span></span>
<span id="cb36-1456"><a href="#cb36-1456" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1457"><a href="#cb36-1457" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> meterProvider <span class="op">=</span> services<span class="op">.</span><span class="fu">GetService</span><span class="op">&lt;</span>MeterProvider<span class="op">&gt;();</span></span>
<span id="cb36-1458"><a href="#cb36-1458" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>meterProvider <span class="op">==</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb36-1459"><a href="#cb36-1459" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1460"><a href="#cb36-1460" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogError</span><span class="op">(</span><span class="st">"MeterProvider not registered - metrics will not be collected"</span><span class="op">);</span></span>
<span id="cb36-1461"><a href="#cb36-1461" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span><span class="op">;</span></span>
<span id="cb36-1462"><a href="#cb36-1462" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1463"><a href="#cb36-1463" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1464"><a href="#cb36-1464" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate meter registration</span></span>
<span id="cb36-1465"><a href="#cb36-1465" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> meter <span class="op">=</span> meterProvider<span class="op">.</span><span class="fu">GetMeter</span><span class="op">(</span><span class="st">"MyApp"</span><span class="op">);</span></span>
<span id="cb36-1466"><a href="#cb36-1466" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>meter <span class="op">==</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb36-1467"><a href="#cb36-1467" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1468"><a href="#cb36-1468" aria-hidden="true" tabindex="-1"></a>            logger<span class="op">.</span><span class="fu">LogWarning</span><span class="op">(</span><span class="st">"Application meter not found - verify meter name"</span><span class="op">);</span></span>
<span id="cb36-1469"><a href="#cb36-1469" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1470"><a href="#cb36-1470" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1471"><a href="#cb36-1471" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Test metric recording</span></span>
<span id="cb36-1472"><a href="#cb36-1472" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> testCounter <span class="op">=</span> meter<span class="op">.</span><span class="fu">CreateCounter</span><span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;(</span><span class="st">"test.counter"</span><span class="op">);</span></span>
<span id="cb36-1473"><a href="#cb36-1473" aria-hidden="true" tabindex="-1"></a>        testCounter<span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb36-1474"><a href="#cb36-1474" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-1475"><a href="#cb36-1475" aria-hidden="true" tabindex="-1"></a>        logger<span class="op">.</span><span class="fu">LogInformation</span><span class="op">(</span><span class="st">"Metrics validation completed"</span><span class="op">);</span></span>
<span id="cb36-1476"><a href="#cb36-1476" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1477"><a href="#cb36-1477" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1478"><a href="#cb36-1478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1479"><a href="#cb36-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1480"><a href="#cb36-1480" aria-hidden="true" tabindex="-1"></a><span class="fu">### Performance Optimization</span></span>
<span id="cb36-1481"><a href="#cb36-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1482"><a href="#cb36-1482" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Reducing Observability Overhead</span></span>
<span id="cb36-1483"><a href="#cb36-1483" aria-hidden="true" tabindex="-1"></a>**Optimizing observability impact** on application performance:</span>
<span id="cb36-1484"><a href="#cb36-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1485"><a href="#cb36-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```csharp</span></span>
<span id="cb36-1486"><a href="#cb36-1486" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ObservabilityOptimization</span>
<span id="cb36-1487"><a href="#cb36-1487" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-1488"><a href="#cb36-1488" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use sampling for high-frequency operations</span></span>
<span id="cb36-1489"><a href="#cb36-1489" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> SampledMetric<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> HighFrequencyMetric <span class="op">=</span> </span>
<span id="cb36-1490"><a href="#cb36-1490" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> SampledMetric<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span><span class="st">"high_frequency.operation"</span><span class="op">,</span> sampleRate<span class="op">:</span> <span class="fl">0.1</span><span class="op">);</span></span>
<span id="cb36-1491"><a href="#cb36-1491" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1492"><a href="#cb36-1492" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Batch metric updates</span></span>
<span id="cb36-1493"><a href="#cb36-1493" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="kw">readonly</span> BatchedCounter BatchedCounter <span class="op">=</span> </span>
<span id="cb36-1494"><a href="#cb36-1494" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> <span class="fu">BatchedCounter</span><span class="op">(</span><span class="st">"batched.operations"</span><span class="op">,</span> flushInterval<span class="op">:</span> TimeSpan<span class="op">.</span><span class="fu">FromSeconds</span><span class="op">(</span><span class="dv">5</span><span class="op">));</span></span>
<span id="cb36-1495"><a href="#cb36-1495" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1496"><a href="#cb36-1496" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Conditional instrumentation</span></span>
<span id="cb36-1497"><a href="#cb36-1497" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="fu">MethodImpl</span><span class="op">(</span>MethodImplOptions<span class="op">.</span><span class="fu">AggressiveInlining</span><span class="op">)]</span></span>
<span id="cb36-1498"><a href="#cb36-1498" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> <span class="dt">void</span> <span class="fu">RecordMetricIfEnabled</span><span class="op">(</span><span class="dt">string</span> metricName<span class="op">,</span> <span class="dt">double</span> value<span class="op">)</span></span>
<span id="cb36-1499"><a href="#cb36-1499" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1500"><a href="#cb36-1500" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>observabilityConfig<span class="op">.</span><span class="fu">IsMetricEnabled</span><span class="op">(</span>metricName<span class="op">))</span></span>
<span id="cb36-1501"><a href="#cb36-1501" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1502"><a href="#cb36-1502" aria-hidden="true" tabindex="-1"></a>            <span class="fu">GetMeter</span><span class="op">().</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>metricName<span class="op">).</span><span class="fu">Record</span><span class="op">(</span>value<span class="op">);</span></span>
<span id="cb36-1503"><a href="#cb36-1503" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-1504"><a href="#cb36-1504" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1505"><a href="#cb36-1505" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-1506"><a href="#cb36-1506" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Async metric recording</span></span>
<span id="cb36-1507"><a href="#cb36-1507" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">static</span> Task <span class="fu">RecordMetricAsync</span><span class="op">(</span><span class="dt">string</span> metricName<span class="op">,</span> <span class="dt">double</span> value<span class="op">)</span></span>
<span id="cb36-1508"><a href="#cb36-1508" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb36-1509"><a href="#cb36-1509" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> Task<span class="op">.</span><span class="fu">Run</span><span class="op">(()</span> <span class="op">=&gt;</span> </span>
<span id="cb36-1510"><a href="#cb36-1510" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb36-1511"><a href="#cb36-1511" aria-hidden="true" tabindex="-1"></a>            <span class="fu">GetMeter</span><span class="op">().</span><span class="fu">CreateHistogram</span><span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>metricName<span class="op">).</span><span class="fu">Record</span><span class="op">(</span>value<span class="op">);</span></span>
<span id="cb36-1512"><a href="#cb36-1512" aria-hidden="true" tabindex="-1"></a>        <span class="op">});</span></span>
<span id="cb36-1513"><a href="#cb36-1513" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-1514"><a href="#cb36-1514" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-1515"><a href="#cb36-1515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1516"><a href="#cb36-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1517"><a href="#cb36-1517" aria-hidden="true" tabindex="-1"></a>This comprehensive document covers the extensive observability capabilities in .NET 10, from runtime-level enhancements to the powerful .NET Aspire observability stack. The integration of native OpenTelemetry support, enhanced metrics collection, and sophisticated diagnostic tools positions .NET 10 as a leader in application observability and monitoring.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Built with <a href="https://quarto.org/">Quarto</a> by Dario Airoldi</p>
</div>   
    <div class="nav-footer-center">
<p>Learning Journey - Technical Notes &amp; Insights</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/darioairoldi/Learn/edit/main/202506 Build 2025/BRK122 Supercharge Your Git workflow with VS Code/02. Inside Observability with .net 10.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/darioairoldi/Learn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Last updated: <strong>?meta:date</strong></p>
</div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>